<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" class="alectryon-standalone" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<title>Operational Game Semantics</title>
<link rel="stylesheet" href="alectryon.css" type="text/css" />
<link rel="stylesheet" href="docutils_basic.css" type="text/css" />
<link rel="stylesheet" href="tango_subtle.css" type="text/css" />
<link rel="stylesheet" href="tango_subtle.min.css" type="text/css" />
<script type="text/javascript" src="alectryon.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" />
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
<div class="alectryon-root alectryon-centered"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.12.0+0.12.1. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.</div><div class="document" id="operational-game-semantics">
<h1 class="title">Operational Game Semantics</h1>

<p>An uniform event is one where the set of answers for a given query is
of the form <tt class="docutils literal">list kon</tt> for some type <tt class="docutils literal">kon</tt>. We argue that the gist
of an OGS is the ability for the opponent to remember all the
continuations that have been offered, and continue not only on the continuations
that have been offered at the last event, but also on all the previous ones.</p>
<p>Hence the OGS of an uniform event will be indexed by an additional
<tt class="docutils literal">ks : list kon</tt> representing the list of currently available continuations
and the set of responses will be the choice of a continuation in the concatenation
of the new continuations available and the ones present in the context.</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">ogs</span> {<span class="nv">I</span> <span class="nv">J</span>} (<span class="nv">U</span> : uniform_event I J)
           : event (I * list (kon U)) (J * list (kon U)) :=
  Event (<span class="kr">fun</span> &#39;(j , ks) =&gt; u_qry U j)
        (<span class="kr">fun</span> &#39;(j , ks) <span class="nv">q</span> =&gt; { i : _ &amp; k_rsp U ((u_rsp U q ++ ks) .[i]) })
        (<span class="kr">fun</span> &#39;(j , ks) <span class="nv">q</span> <span class="nv">r</span> =&gt; (k_nxt U (projT2 r) , u_rsp U q ++ ks)).</span></span></span></pre><p>An OGS configuration <tt class="docutils literal">c : ogs_conf X ks</tt> is a heterogeneous list
of <tt class="docutils literal">X</tt>'s for each continuation of the list.</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">ogs_conf</span> {<span class="nv">I</span>} {<span class="nv">U</span> : uniform_event I I}
             (<span class="nv">X</span> : I -&gt; <span class="kt">Type</span>) (<span class="nv">ks</span> : list (kon U)) : <span class="kt">Type</span> :=
  dvec (<span class="kr">fun</span> <span class="nv">k</span> =&gt; <span class="kr">forall</span> <span class="nv">r</span> : k_rsp U k, X (k_nxt U r)) ks.</span></span></span></pre><p>Given an OGS configuration containing itrees (eg a forest of itrees
explaining how to continue for every continuation in scope), and an
itree over <tt class="docutils literal">U</tt>, we can generate an itree over <tt class="docutils literal">ogs U</tt>.</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">ogs_emb</span> {<span class="nv">I</span>} {<span class="nv">U</span> : uniform_event I I} {<span class="nv">X</span> : I -&gt; <span class="kt">Type</span>}
           : <span class="kr">forall</span> {<span class="nv">i</span> <span class="nv">ks</span>},
             ogs_conf (itree U X) ks
           -&gt; itree U X i
           -&gt; itree (ogs U) (X ‚àò fst) (i , ks) :=
  <span class="kr">cofix</span> _ogs_emb i ks c x := <span class="kr">match</span> (observe x) <span class="kr">with</span>
    | RetF x =&gt; Ret (x : X (fst (i , ks)))
    | TauF t =&gt; Tau (_ogs_emb i ks c t)
    | VisF e k =&gt; Vis (e : qry (ogs U) (i , ks)) (<span class="kr">fun</span> <span class="nv">r</span> =&gt;
                   <span class="kr">let</span> <span class="nv">c&#39;</span> := d_concat _ _ c (curry2&#39; k) <span class="kr">in</span>
                   _ogs_emb _ _ c&#39; (uncurry2&#39; (d_get _ c&#39;) r))
    <span class="kr">end</span>.</span></span></span></pre><p>Here is a short lemma injecting a query for <tt class="docutils literal">U</tt> into a query for <tt class="docutils literal">ogs U</tt>.</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">ogs_inj_rsp</span> {<span class="nv">I</span>} {<span class="nv">U</span> : uniform_event I I} {<span class="nv">i</span> <span class="nv">ks</span>} {<span class="nv">q</span> : qry U i}
          (<span class="nv">r</span> : rsp U q) : rsp (ogs U) (q : qry (ogs U) (i , ks)) :=
  fin_inj&#39; _ ,&amp; eq_rect _ (k_rsp U) (projT2 r) _ (fin_inj_get (projT1 r)).</span></span></span></pre><p>Next is a definition of eutt lifted to our type of forests: two forests are eutt
if they are pointwise eutt.</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">eutt_conf</span> {<span class="nv">I</span>} {<span class="nv">U</span> : uniform_event I I} {<span class="nv">X</span> <span class="nv">ks</span>}
           : ogs_conf (itree U X) ks -&gt; ogs_conf (itree U X) ks -&gt; <span class="kt">Prop</span> :=
  <span class="kr">fun</span> <span class="nv">c0</span> <span class="nv">c1</span> =&gt; <span class="kr">forall</span> <span class="nv">i</span> (<span class="nv">r</span> : k_rsp U (ks .[i])), d_get ks c0 i r ‚âà d_get ks c1 i r.</span></span></span></pre><p>The soundness theorem: if the OGS embedding of two itrees are eutt, then the
trees are themselves eutt. The proof is very direct: by coinduction we pattern
match on the proof, destructing and discriminating everything to expose the forced
constructors (like the kind of clause-based dependent induction that coq-equation
does). The case for Vis is currently not finished, there are still some dependent
equality rewriting shenanigans.</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk0"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">ogs_sound</span> {<span class="nv">I</span>} {<span class="nv">U</span> : uniform_event I I} {<span class="nv">X</span> <span class="nv">i</span> <span class="nv">ks</span>}
        {<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks} {<span class="nv">a</span> <span class="nv">b</span> : itree U X i}
        (<span class="nv">H</span> : ogs_emb c0 a ‚âà ogs_emb c1 b) : a ‚âà b.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_emb c0 a ‚âà ogs_emb c1 b</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">a ‚âà b</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk1"><span class="highlight"><span class="nb">revert</span> i ks c0 c1 a b H.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; a ‚âà b</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk2"><span class="highlight">pcofix CIH.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U)) (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
(<span class="nv">a</span> <span class="nv">b</span> : itree U X i), ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ogs_emb c0 a ‚âà ogs_emb c1 b -&gt;
paco3 (eqit_ eq·µ¢ true true id) r i a b</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk3"><span class="highlight"><span class="nb">intros</span> i ks c0 c1 a b H.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U)) (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
(<span class="nv">a</span> <span class="nv">b</span> : itree U X i), ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_emb c0 a ‚âà ogs_emb c1 b</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">paco3 (eqit_ eq·µ¢ true true id) r i a b</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk4" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk4"><span class="highlight">pstep.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U)) (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
(<span class="nv">a</span> <span class="nv">b</span> : itree U X i), ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_emb c0 a ‚âà ogs_emb c1 b</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eqit_ eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) i a b</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk5"><span class="highlight">punfold H.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U)) (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
(<span class="nv">a</span> <span class="nv">b</span> : itree U X i), ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqit_ eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) bot3) (i, ks)
  (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eqit_ eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) i a b</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk6"><span class="highlight"><span class="nb">red</span> <span class="kr">in</span> H |- *.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U)) (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
(<span class="nv">a</span> <span class="nv">b</span> : itree U X i), ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) bot3) (i, ks)
  (observe (ogs_emb c0 a))
  (observe (ogs_emb c1 b))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) i (observe a)
  (observe b)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk7"><span class="highlight"><span class="nb">remember</span> (observe (ogs_emb c0 a)) <span class="kr">as</span> x.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U)) (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
(<span class="nv">a</span> <span class="nv">b</span> : itree U X i), ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree&#39; (ogs U) (X ‚àò fst) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = observe (ogs_emb c0 a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) bot3) 
  (i, ks) x (observe (ogs_emb c1 b))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) i (observe a)
  (observe b)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk8"><span class="highlight"><span class="nb">remember</span> (observe (ogs_emb c1 b)) <span class="kr">as</span> y.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree&#39; (ogs U) (X ‚àò fst) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = observe (ogs_emb c0 a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree&#39; (ogs U) (X ‚àò fst) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">y = observe (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) bot3) 
  (i, ks) x y</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) i 
  (observe a) (observe b)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk9"><span class="highlight">hinduction H <span class="nb">before</span> r;
    pclearbot;
    <span class="nb">intros</span> CIH c0 c1 a b Ha Hb;
    <span class="nb">cbv</span> [ observe ogs_emb ] <span class="kr">in</span> Ha, Hb |- *; <span class="nb">cbn</span> [ rsp ogs ] <span class="kr">in</span> Ha, Hb;
    <span class="nb">change</span> (Tau (_ i ks <span class="nl">?c</span> <span class="nl">?t</span>)) <span class="kr">with</span> (Tau (ogs_emb c t)) <span class="kr">in</span> Ha, Hb;
    <span class="nb">change</span> (_ (k_nxt U (projT2 _)) (ks +‚ñ∂ u_rsp U _)%ctx <span class="nl">?c</span> <span class="nl">?r</span>)
      <span class="kr">with</span> (ogs_emb c r) <span class="kr">in</span> Ha, Hb.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1, r2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(X ‚àò fst) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eq·µ¢ (i, ks) r1 r2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">RetF r1 =
_observe
  <span class="kr">match</span> _observe a <span class="kr">with</span>
  | RetF x =&gt; Ret x
  | TauF t =&gt; Tau (ogs_emb c0 t)
  | VisF e k =&gt;
      Vis e
        (<span class="kr">fun</span>
           <span class="nv">r</span> : {i0
               : fin
                   (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
               k_rsp U
                 ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
         =&gt;
         ogs_emb
           (d_concat ks (u_rsp U e) c0
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
               =&gt; k (a,&amp; b)))
           (uncurry2&#39;
              (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                 (d_concat ks 
                    (u_rsp U e) c0
                    (<span class="kr">fun</span>
                       (<span class="nv">a</span> : 
                        fin 
                        (length (u_rsp U e)))
                       (<span class="nv">b</span> : 
                        k_rsp U
                        ((u_rsp U e) .[ a])) =&gt;
                     k (a,&amp; b)))) r))
  <span class="kr">end</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">RetF r2 =
_observe
  <span class="kr">match</span> _observe b <span class="kr">with</span>
  | RetF x =&gt; Ret x
  | TauF t =&gt; Tau (ogs_emb c1 t)
  | VisF e k =&gt;
      Vis e
        (<span class="kr">fun</span>
           <span class="nv">r</span> : {i0
               : fin
                   (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
               k_rsp U
                 ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
         =&gt;
         ogs_emb
           (d_concat ks (u_rsp U e) c1
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
               =&gt; k (a,&amp; b)))
           (uncurry2&#39;
              (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                 (d_concat ks 
                    (u_rsp U e) c1
                    (<span class="kr">fun</span>
                       (<span class="nv">a</span> : 
                        fin 
                        (length (u_rsp U e)))
                       (<span class="nv">b</span> : 
                        k_rsp U
                        ((u_rsp U e) .[ a])) =&gt;
                     k (a,&amp; b)))) r))
  <span class="kr">end</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) i 
  (_observe a) (_observe b)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ogsd-v-chka" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1, m2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree (ogs U) (X ‚àò fst) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">paco3 (eqit_ eq·µ¢ true true id) bot3 
  (i, ks) m1 m2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF m1 =
_observe
  <span class="kr">match</span> _observe a <span class="kr">with</span>
  | RetF x =&gt; Ret x
  | TauF t =&gt; Tau (ogs_emb c0 t)
  | VisF e k =&gt;
      Vis e
        (<span class="kr">fun</span>
           <span class="nv">r</span> : {i0
               : fin
                   (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
               k_rsp U
                 ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
         =&gt;
         ogs_emb
           (d_concat ks (u_rsp U e) c0
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
               =&gt; k (a,&amp; b)))
           (uncurry2&#39;
              (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                 (d_concat ks 
                    (u_rsp U e) c0
                    (<span class="kr">fun</span>
                       (<span class="nv">a</span> : 
                        fin 
                        (length (u_rsp U e)))
                       (<span class="nv">b</span> : 
                        k_rsp U
                        ((u_rsp U e) .[ a])) =&gt;
                     k (a,&amp; b)))) r))
  <span class="kr">end</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF m2 =
_observe
  <span class="kr">match</span> _observe b <span class="kr">with</span>
  | RetF x =&gt; Ret x
  | TauF t =&gt; Tau (ogs_emb c1 t)
  | VisF e k =&gt;
      Vis e
        (<span class="kr">fun</span>
           <span class="nv">r</span> : {i0
               : fin
                   (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
               k_rsp U
                 ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
         =&gt;
         ogs_emb
           (d_concat ks (u_rsp U e) c1
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
               =&gt; k (a,&amp; b)))
           (uncurry2&#39;
              (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                 (d_concat ks 
                    (u_rsp U e) c1
                    (<span class="kr">fun</span>
                       (<span class="nv">a</span> : 
                        fin 
                        (length (u_rsp U e)))
                       (<span class="nv">b</span> : 
                        k_rsp U
                        ((u_rsp U e) .[ a])) =&gt;
                     k (a,&amp; b)))) r))
  <span class="kr">end</span></span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="ogsd-v-chka"><hr></label><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) i 
  (_observe a) (_observe b)</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="ogsd-v-chkb" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry (ogs U) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k1, k2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : rsp (ogs U) e,
itree (ogs U) (X ‚àò fst) (nxt (ogs U) e x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">v</span> : rsp (ogs U) e,
paco3 (eqit_ eq·µ¢ true true id) bot3
  (nxt (ogs U) e v) (k1 v) 
  (k2 v)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VisF e k1 =
_observe
  <span class="kr">match</span> _observe a <span class="kr">with</span>
  | RetF x =&gt; Ret x
  | TauF t =&gt; Tau (ogs_emb c0 t)
  | VisF e k =&gt;
      Vis e
        (<span class="kr">fun</span>
           <span class="nv">r</span> : {i0
               : fin
                   (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
               k_rsp U
                 ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
         =&gt;
         ogs_emb
           (d_concat ks (u_rsp U e) c0
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
               =&gt; k (a,&amp; b)))
           (uncurry2&#39;
              (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                 (d_concat ks 
                    (u_rsp U e) c0
                    (<span class="kr">fun</span>
                       (<span class="nv">a</span> : 
                        fin 
                        (length (u_rsp U e)))
                       (<span class="nv">b</span> : 
                        k_rsp U
                        ((u_rsp U e) .[ a])) =&gt;
                     k (a,&amp; b)))) r))
  <span class="kr">end</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VisF e k2 =
_observe
  <span class="kr">match</span> _observe b <span class="kr">with</span>
  | RetF x =&gt; Ret x
  | TauF t =&gt; Tau (ogs_emb c1 t)
  | VisF e k =&gt;
      Vis e
        (<span class="kr">fun</span>
           <span class="nv">r</span> : {i0
               : fin
                   (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
               k_rsp U
                 ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
         =&gt;
         ogs_emb
           (d_concat ks (u_rsp U e) c1
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
               =&gt; k (a,&amp; b)))
           (uncurry2&#39;
              (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                 (d_concat ks 
                    (u_rsp U e) c1
                    (<span class="kr">fun</span>
                       (<span class="nv">a</span> : 
                        fin 
                        (length (u_rsp U e)))
                       (<span class="nv">b</span> : 
                        k_rsp U
                        ((u_rsp U e) .[ a])) =&gt;
                     k (a,&amp; b)))) r))
  <span class="kr">end</span></span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="ogsd-v-chkb"><hr></label><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) i 
  (_observe a) (_observe b)</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="ogsd-v-chkc" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree (ogs U) (X ‚àò fst) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ot2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree&#39; (ogs U) (X ‚àò fst) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CHECK</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">is_true true</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) bot3) 
  (i, ks) (observe t1) ot2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHeqitF</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(<span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
   (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
   (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
 ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b) -&gt;
<span class="kr">forall</span> (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
observe t1 = observe (ogs_emb c0 a) -&gt;
ot2 = observe (ogs_emb c1 b) -&gt;
eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) i
  (observe a) (observe b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF t1 =
_observe
  <span class="kr">match</span> _observe a <span class="kr">with</span>
  | RetF x =&gt; Ret x
  | TauF t =&gt; Tau (ogs_emb c0 t)
  | VisF e k =&gt;
      Vis e
        (<span class="kr">fun</span>
           <span class="nv">r</span> : {i0
               : fin
                   (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
               k_rsp U
                 ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
         =&gt;
         ogs_emb
           (d_concat ks (u_rsp U e) c0
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
               =&gt; k (a,&amp; b)))
           (uncurry2&#39;
              (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                 (d_concat ks 
                    (u_rsp U e) c0
                    (<span class="kr">fun</span>
                       (<span class="nv">a</span> : 
                        fin 
                        (length (u_rsp U e)))
                       (<span class="nv">b</span> : 
                        k_rsp U
                        ((u_rsp U e) .[ a])) =&gt;
                     k (a,&amp; b)))) r))
  <span class="kr">end</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ot2 =
_observe
  <span class="kr">match</span> _observe b <span class="kr">with</span>
  | RetF x =&gt; Ret x
  | TauF t =&gt; Tau (ogs_emb c1 t)
  | VisF e k =&gt;
      Vis e
        (<span class="kr">fun</span>
           <span class="nv">r</span> : {i0
               : fin
                   (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
               k_rsp U
                 ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
         =&gt;
         ogs_emb
           (d_concat ks (u_rsp U e) c1
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
               =&gt; k (a,&amp; b)))
           (uncurry2&#39;
              (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                 (d_concat ks 
                    (u_rsp U e) c1
                    (<span class="kr">fun</span>
                       (<span class="nv">a</span> : 
                        fin 
                        (length (u_rsp U e)))
                       (<span class="nv">b</span> : 
                        k_rsp U
                        ((u_rsp U e) .[ a])) =&gt;
                     k (a,&amp; b)))) r))
  <span class="kr">end</span></span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="ogsd-v-chkc"><hr></label><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) i 
  (_observe a) (_observe b)</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="ogsd-v-chkd" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ot1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree&#39; (ogs U) (X ‚àò fst) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree (ogs U) (X ‚àò fst) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CHECK</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">is_true true</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) bot3) 
  (i, ks) ot1 (observe t2)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHeqitF</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(<span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
   (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
   (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
 ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b) -&gt;
<span class="kr">forall</span> (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ot1 = observe (ogs_emb c0 a) -&gt;
observe t2 = observe (ogs_emb c1 b) -&gt;
eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) i
  (observe a) (observe b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ot1 =
_observe
  <span class="kr">match</span> _observe a <span class="kr">with</span>
  | RetF x =&gt; Ret x
  | TauF t =&gt; Tau (ogs_emb c0 t)
  | VisF e k =&gt;
      Vis e
        (<span class="kr">fun</span>
           <span class="nv">r</span> : {i0
               : fin
                   (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
               k_rsp U
                 ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
         =&gt;
         ogs_emb
           (d_concat ks (u_rsp U e) c0
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
               =&gt; k (a,&amp; b)))
           (uncurry2&#39;
              (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                 (d_concat ks 
                    (u_rsp U e) c0
                    (<span class="kr">fun</span>
                       (<span class="nv">a</span> : 
                        fin 
                        (length (u_rsp U e)))
                       (<span class="nv">b</span> : 
                        k_rsp U
                        ((u_rsp U e) .[ a])) =&gt;
                     k (a,&amp; b)))) r))
  <span class="kr">end</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF t2 =
_observe
  <span class="kr">match</span> _observe b <span class="kr">with</span>
  | RetF x =&gt; Ret x
  | TauF t =&gt; Tau (ogs_emb c1 t)
  | VisF e k =&gt;
      Vis e
        (<span class="kr">fun</span>
           <span class="nv">r</span> : {i0
               : fin
                   (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
               k_rsp U
                 ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
         =&gt;
         ogs_emb
           (d_concat ks (u_rsp U e) c1
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
               =&gt; k (a,&amp; b)))
           (uncurry2&#39;
              (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                 (d_concat ks 
                    (u_rsp U e) c1
                    (<span class="kr">fun</span>
                       (<span class="nv">a</span> : 
                        fin 
                        (length (u_rsp U e)))
                       (<span class="nv">b</span> : 
                        k_rsp U
                        ((u_rsp U e) .[ a])) =&gt;
                     k (a,&amp; b)))) r))
  <span class="kr">end</span></span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="ogsd-v-chkd"><hr></label><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) i 
  (_observe a) (_observe b)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chke"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1, r2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(X ‚àò fst) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eq·µ¢ (i, ks) r1 r2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">RetF r1 =
_observe
  <span class="kr">match</span> _observe a <span class="kr">with</span>
  | RetF x =&gt; Ret x
  | TauF t =&gt; Tau (ogs_emb c0 t)
  | VisF e k =&gt;
      Vis e
        (<span class="kr">fun</span>
           <span class="nv">r</span> : {i0
               : fin
                   (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
               k_rsp U
                 ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
         =&gt;
         ogs_emb
           (d_concat ks (u_rsp U e) c0
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
               =&gt; k (a,&amp; b)))
           (uncurry2&#39;
              (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                 (d_concat ks 
                    (u_rsp U e) c0
                    (<span class="kr">fun</span>
                       (<span class="nv">a</span> : 
                        fin 
                        (length (u_rsp U e)))
                       (<span class="nv">b</span> : 
                        k_rsp U
                        ((u_rsp U e) .[ a])) =&gt;
                     k (a,&amp; b)))) r))
  <span class="kr">end</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">RetF r2 =
_observe
  <span class="kr">match</span> _observe b <span class="kr">with</span>
  | RetF x =&gt; Ret x
  | TauF t =&gt; Tau (ogs_emb c1 t)
  | VisF e k =&gt;
      Vis e
        (<span class="kr">fun</span>
           <span class="nv">r</span> : {i0
               : fin
                   (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
               k_rsp U
                 ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
         =&gt;
         ogs_emb
           (d_concat ks (u_rsp U e) c1
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
               =&gt; k (a,&amp; b)))
           (uncurry2&#39;
              (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                 (d_concat ks 
                    (u_rsp U e) c1
                    (<span class="kr">fun</span>
                       (<span class="nv">a</span> : 
                        fin 
                        (length (u_rsp U e)))
                       (<span class="nv">b</span> : 
                        k_rsp U
                        ((u_rsp U e) .[ a])) =&gt;
                     k (a,&amp; b)))) r))
  <span class="kr">end</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) i 
  (_observe a) (_observe b)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chkf"><span class="highlight"><span class="nb">destruct</span> (_observe a); <span class="kp">try</span> <span class="bp">discriminate</span> Ha.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1, r2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(X ‚àò fst) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eq·µ¢ (i, ks) r1 r2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">RetF r1 = _observe (Ret r0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">RetF r2 =
_observe
  <span class="kr">match</span> _observe b <span class="kr">with</span>
  | RetF x =&gt; Ret x
  | TauF t =&gt; Tau (ogs_emb c1 t)
  | VisF e k =&gt;
      Vis e
        (<span class="kr">fun</span>
           <span class="nv">r</span> : {i0
               : fin
                   (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
               k_rsp U
                 ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
         =&gt;
         ogs_emb
           (d_concat ks (u_rsp U e) c1
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
               =&gt; k (a,&amp; b)))
           (uncurry2&#39;
              (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                 (d_concat ks 
                    (u_rsp U e) c1
                    (<span class="kr">fun</span>
                       (<span class="nv">a</span> : 
                        fin 
                        (length (u_rsp U e)))
                       (<span class="nv">b</span> : 
                        k_rsp U
                        ((u_rsp U e) .[ a])) =&gt;
                     k (a,&amp; b)))) r))
  <span class="kr">end</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) i 
  (RetF r0) (_observe b)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk10"><span class="highlight"><span class="nb">destruct</span> (_observe b); <span class="kp">try</span> <span class="bp">discriminate</span> Hb.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1, r2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(X ‚àò fst) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eq·µ¢ (i, ks) r1 r2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">RetF r1 = _observe (Ret r0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">RetF r2 = _observe (Ret r3)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) i 
  (RetF r0) (RetF r3)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk11" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk11"><span class="highlight"><span class="nb">econstructor</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1, r2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(X ‚àò fst) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eq·µ¢ (i, ks) r1 r2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">RetF r1 = _observe (Ret r0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">RetF r2 = _observe (Ret r3)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eq·µ¢ i r0 r3</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">injection</span> Ha <span class="kr">as</span> &lt;-; <span class="nb">injection</span> Hb <span class="kr">as</span> &lt;-; <span class="nb">auto</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk12"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1, m2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree (ogs U) (X ‚àò fst) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">paco3 (eqit_ eq·µ¢ true true id) bot3 
  (i, ks) m1 m2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF m1 =
_observe
  <span class="kr">match</span> _observe a <span class="kr">with</span>
  | RetF x =&gt; Ret x
  | TauF t =&gt; Tau (ogs_emb c0 t)
  | VisF e k =&gt;
      Vis e
        (<span class="kr">fun</span>
           <span class="nv">r</span> : {i0
               : fin
                   (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
               k_rsp U
                 ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
         =&gt;
         ogs_emb
           (d_concat ks (u_rsp U e) c0
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
               =&gt; k (a,&amp; b)))
           (uncurry2&#39;
              (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                 (d_concat ks 
                    (u_rsp U e) c0
                    (<span class="kr">fun</span>
                       (<span class="nv">a</span> : 
                        fin 
                        (length (u_rsp U e)))
                       (<span class="nv">b</span> : 
                        k_rsp U
                        ((u_rsp U e) .[ a])) =&gt;
                     k (a,&amp; b)))) r))
  <span class="kr">end</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF m2 =
_observe
  <span class="kr">match</span> _observe b <span class="kr">with</span>
  | RetF x =&gt; Ret x
  | TauF t =&gt; Tau (ogs_emb c1 t)
  | VisF e k =&gt;
      Vis e
        (<span class="kr">fun</span>
           <span class="nv">r</span> : {i0
               : fin
                   (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
               k_rsp U
                 ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
         =&gt;
         ogs_emb
           (d_concat ks (u_rsp U e) c1
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
               =&gt; k (a,&amp; b)))
           (uncurry2&#39;
              (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                 (d_concat ks 
                    (u_rsp U e) c1
                    (<span class="kr">fun</span>
                       (<span class="nv">a</span> : 
                        fin 
                        (length (u_rsp U e)))
                       (<span class="nv">b</span> : 
                        k_rsp U
                        ((u_rsp U e) .[ a])) =&gt;
                     k (a,&amp; b)))) r))
  <span class="kr">end</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) i 
  (_observe a) (_observe b)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk13" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk13"><span class="highlight"><span class="nb">destruct</span> (_observe a); <span class="kp">try</span> <span class="bp">discriminate</span> Ha.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1, m2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree (ogs U) (X ‚àò fst) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">paco3 (eqit_ eq·µ¢ true true id) bot3 
  (i, ks) m1 m2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b, t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF m1 = _observe (Tau (ogs_emb c0 t))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF m2 =
_observe
  <span class="kr">match</span> _observe b <span class="kr">with</span>
  | RetF x =&gt; Ret x
  | TauF t =&gt; Tau (ogs_emb c1 t)
  | VisF e k =&gt;
      Vis e
        (<span class="kr">fun</span>
           <span class="nv">r</span> : {i0
               : fin
                   (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
               k_rsp U
                 ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
         =&gt;
         ogs_emb
           (d_concat ks (u_rsp U e) c1
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
               =&gt; k (a,&amp; b)))
           (uncurry2&#39;
              (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                 (d_concat ks 
                    (u_rsp U e) c1
                    (<span class="kr">fun</span>
                       (<span class="nv">a</span> : 
                        fin 
                        (length (u_rsp U e)))
                       (<span class="nv">b</span> : 
                        k_rsp U
                        ((u_rsp U e) .[ a])) =&gt;
                     k (a,&amp; b)))) r))
  <span class="kr">end</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) i 
  (TauF t) (_observe b)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk14"><span class="highlight"><span class="nb">destruct</span> (_observe b); <span class="kp">try</span> <span class="bp">discriminate</span> Hb.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1, m2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree (ogs U) (X ‚àò fst) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">paco3 (eqit_ eq·µ¢ true true id) bot3 
  (i, ks) m1 m2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b, t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF m1 = _observe (Tau (ogs_emb c0 t))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF m2 = _observe (Tau (ogs_emb c1 t0))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) i 
  (TauF t) (TauF t0)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk15" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk15"><span class="highlight"><span class="nb">econstructor</span>; <span class="nb">right</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1, m2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree (ogs U) (X ‚àò fst) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">paco3 (eqit_ eq·µ¢ true true id) bot3 
  (i, ks) m1 m2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b, t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF m1 = _observe (Tau (ogs_emb c0 t))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF m2 = _observe (Tau (ogs_emb c1 t0))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">r i t t0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk16"><span class="highlight"><span class="nb">apply</span> (CIH i ks c0 c1).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1, m2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree (ogs U) (X ‚àò fst) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">paco3 (eqit_ eq·µ¢ true true id) bot3 
  (i, ks) m1 m2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b, t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF m1 = _observe (Tau (ogs_emb c0 t))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF m2 = _observe (Tau (ogs_emb c1 t0))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ogs_emb c0 t ‚âà ogs_emb c1 t0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk17"><span class="highlight"><span class="nb">cbn</span> [_observe] <span class="kr">in</span> Ha, Hb.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1, m2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree (ogs U) (X ‚àò fst) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">paco3 (eqit_ eq·µ¢ true true id) bot3 
  (i, ks) m1 m2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b, t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF m1 = TauF (ogs_emb c0 t)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF m2 = TauF (ogs_emb c1 t0)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ogs_emb c0 t ‚âà ogs_emb c1 t0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">injection</span> Ha <span class="kr">as</span> &lt;-; <span class="nb">injection</span> Hb <span class="kr">as</span> &lt;-; <span class="nb">auto</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk18"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry (ogs U) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k1, k2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : rsp (ogs U) e,
itree (ogs U) (X ‚àò fst) (nxt (ogs U) e x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">v</span> : rsp (ogs U) e,
paco3 (eqit_ eq·µ¢ true true id) bot3
  (nxt (ogs U) e v) (k1 v) 
  (k2 v)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VisF e k1 =
_observe
  <span class="kr">match</span> _observe a <span class="kr">with</span>
  | RetF x =&gt; Ret x
  | TauF t =&gt; Tau (ogs_emb c0 t)
  | VisF e k =&gt;
      Vis e
        (<span class="kr">fun</span>
           <span class="nv">r</span> : {i0
               : fin
                   (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
               k_rsp U
                 ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
         =&gt;
         ogs_emb
           (d_concat ks (u_rsp U e) c0
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
               =&gt; k (a,&amp; b)))
           (uncurry2&#39;
              (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                 (d_concat ks 
                    (u_rsp U e) c0
                    (<span class="kr">fun</span>
                       (<span class="nv">a</span> : 
                        fin 
                        (length (u_rsp U e)))
                       (<span class="nv">b</span> : 
                        k_rsp U
                        ((u_rsp U e) .[ a])) =&gt;
                     k (a,&amp; b)))) r))
  <span class="kr">end</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VisF e k2 =
_observe
  <span class="kr">match</span> _observe b <span class="kr">with</span>
  | RetF x =&gt; Ret x
  | TauF t =&gt; Tau (ogs_emb c1 t)
  | VisF e k =&gt;
      Vis e
        (<span class="kr">fun</span>
           <span class="nv">r</span> : {i0
               : fin
                   (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
               k_rsp U
                 ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
         =&gt;
         ogs_emb
           (d_concat ks (u_rsp U e) c1
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
               =&gt; k (a,&amp; b)))
           (uncurry2&#39;
              (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                 (d_concat ks 
                    (u_rsp U e) c1
                    (<span class="kr">fun</span>
                       (<span class="nv">a</span> : 
                        fin 
                        (length (u_rsp U e)))
                       (<span class="nv">b</span> : 
                        k_rsp U
                        ((u_rsp U e) .[ a])) =&gt;
                     k (a,&amp; b)))) r))
  <span class="kr">end</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) i 
  (_observe a) (_observe b)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk19" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk19"><span class="highlight"><span class="nb">destruct</span> (_observe a); <span class="kp">try</span> <span class="bp">discriminate</span> Ha.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry (ogs U) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k1, k2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : rsp (ogs U) e,
itree (ogs U) (X ‚àò fst) (nxt (ogs U) e x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">v</span> : rsp (ogs U) e,
paco3 (eqit_ eq·µ¢ true true id) bot3
  (nxt (ogs U) e v) (k1 v) 
  (k2 v)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry U i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : rsp U e0, itree U X (nxt U e0 r)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VisF e k1 =
_observe
  (Vis e0
     (<span class="kr">fun</span>
        <span class="nv">r</span> : {i0
            : fin (length (ks +‚ñ∂ u_rsp U e0)%ctx) &amp;
            k_rsp U
              ((ks +‚ñ∂ u_rsp U e0)%ctx .[ i0])} =&gt;
      ogs_emb
        (d_concat ks (u_rsp U e0) c0
           (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e0)))
              (<span class="nv">b</span> : k_rsp U ((u_rsp U e0) .[ a]))
            =&gt; k (a,&amp; b)))
        (uncurry2&#39;
           (d_get (ks +‚ñ∂ u_rsp U e0)%ctx
              (d_concat ks 
                 (u_rsp U e0) c0
                 (<span class="kr">fun</span>
                    (<span class="nv">a</span> : 
                     fin 
                       (length (u_rsp U e0)))
                    (<span class="nv">b</span> : 
                     k_rsp U 
                       ((u_rsp U e0) .[ a])) =&gt;
                  k (a,&amp; b)))) r)))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VisF e k2 =
_observe
  <span class="kr">match</span> _observe b <span class="kr">with</span>
  | RetF x =&gt; Ret x
  | TauF t =&gt; Tau (ogs_emb c1 t)
  | VisF e k =&gt;
      Vis e
        (<span class="kr">fun</span>
           <span class="nv">r</span> : {i0
               : fin
                   (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
               k_rsp U
                 ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
         =&gt;
         ogs_emb
           (d_concat ks (u_rsp U e) c1
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
               =&gt; k (a,&amp; b)))
           (uncurry2&#39;
              (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                 (d_concat ks 
                    (u_rsp U e) c1
                    (<span class="kr">fun</span>
                       (<span class="nv">a</span> : 
                        fin 
                        (length (u_rsp U e)))
                       (<span class="nv">b</span> : 
                        k_rsp U
                        ((u_rsp U e) .[ a])) =&gt;
                     k (a,&amp; b)))) r))
  <span class="kr">end</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) i 
  (VisF e0 k) (_observe b)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk1a"><span class="highlight"><span class="nb">destruct</span> (_observe b); <span class="kp">try</span> <span class="bp">discriminate</span> Hb.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry (ogs U) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k1, k2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : rsp (ogs U) e,
itree (ogs U) (X ‚àò fst) (nxt (ogs U) e x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">v</span> : rsp (ogs U) e,
paco3 (eqit_ eq·µ¢ true true id) bot3
  (nxt (ogs U) e v) (k1 v) 
  (k2 v)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry U i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : rsp U e0, itree U X (nxt U e0 r)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VisF e k1 =
_observe
  (Vis e0
     (<span class="kr">fun</span>
        <span class="nv">r</span> : {i0
            : fin (length (ks +‚ñ∂ u_rsp U e0)%ctx) &amp;
            k_rsp U
              ((ks +‚ñ∂ u_rsp U e0)%ctx .[ i0])} =&gt;
      ogs_emb
        (d_concat ks (u_rsp U e0) c0
           (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e0)))
              (<span class="nv">b</span> : k_rsp U ((u_rsp U e0) .[ a]))
            =&gt; k (a,&amp; b)))
        (uncurry2&#39;
           (d_get (ks +‚ñ∂ u_rsp U e0)%ctx
              (d_concat ks 
                 (u_rsp U e0) c0
                 (<span class="kr">fun</span>
                    (<span class="nv">a</span> : 
                     fin 
                       (length (u_rsp U e0)))
                    (<span class="nv">b</span> : 
                     k_rsp U 
                       ((u_rsp U e0) .[ a])) =&gt;
                  k (a,&amp; b)))) r)))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry U i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : rsp U e1, itree U X (nxt U e1 r)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VisF e k2 =
_observe
  (Vis e1
     (<span class="kr">fun</span>
        <span class="nv">r</span> : {i0
            : fin (length (ks +‚ñ∂ u_rsp U e1)%ctx) &amp;
            k_rsp U
              ((ks +‚ñ∂ u_rsp U e1)%ctx .[ i0])} =&gt;
      ogs_emb
        (d_concat ks (u_rsp U e1) c1
           (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e1)))
              (<span class="nv">b</span> : k_rsp U ((u_rsp U e1) .[ a]))
            =&gt; k0 (a,&amp; b)))
        (uncurry2&#39;
           (d_get (ks +‚ñ∂ u_rsp U e1)%ctx
              (d_concat ks 
                 (u_rsp U e1) c1
                 (<span class="kr">fun</span>
                    (<span class="nv">a</span> : 
                     fin 
                       (length (u_rsp U e1)))
                    (<span class="nv">b</span> : 
                     k_rsp U 
                       ((u_rsp U e1) .[ a])) =&gt;
                  k0 (a,&amp; b)))) r)))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) i 
  (VisF e0 k) (VisF e1 k0)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk1b" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk1b"><span class="highlight"><span class="nb">cbn</span> [_observe] <span class="kr">in</span> Ha, Hb.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry (ogs U) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k1, k2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : rsp (ogs U) e,
itree (ogs U) (X ‚àò fst) (nxt (ogs U) e x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">v</span> : rsp (ogs U) e,
paco3 (eqit_ eq·µ¢ true true id) bot3
  (nxt (ogs U) e v) (k1 v) 
  (k2 v)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry U i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : rsp U e0, itree U X (nxt U e0 r)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VisF e k1 =
VisF e0
  (<span class="kr">fun</span>
     <span class="nv">r</span> : {i0
         : fin (length (ks +‚ñ∂ u_rsp U e0)%ctx) &amp;
         k_rsp U ((ks +‚ñ∂ u_rsp U e0)%ctx .[ i0])}
   =&gt;
   ogs_emb
     (d_concat ks (u_rsp U e0) c0
        (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e0)))
           (<span class="nv">b</span> : k_rsp U ((u_rsp U e0) .[ a])) =&gt;
         k (a,&amp; b)))
     (uncurry2&#39;
        (d_get (ks +‚ñ∂ u_rsp U e0)%ctx
           (d_concat ks (u_rsp U e0) c0
              (<span class="kr">fun</span>
                 (<span class="nv">a</span> : fin (length (u_rsp U e0)))
                 (<span class="nv">b</span> : k_rsp U
                        ((u_rsp U e0) .[ a])) =&gt;
               k (a,&amp; b)))) r))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry U i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : rsp U e1, itree U X (nxt U e1 r)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VisF e k2 =
VisF e1
  (<span class="kr">fun</span>
     <span class="nv">r</span> : {i0
         : fin (length (ks +‚ñ∂ u_rsp U e1)%ctx) &amp;
         k_rsp U ((ks +‚ñ∂ u_rsp U e1)%ctx .[ i0])}
   =&gt;
   ogs_emb
     (d_concat ks (u_rsp U e1) c1
        (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e1)))
           (<span class="nv">b</span> : k_rsp U ((u_rsp U e1) .[ a])) =&gt;
         k0 (a,&amp; b)))
     (uncurry2&#39;
        (d_get (ks +‚ñ∂ u_rsp U e1)%ctx
           (d_concat ks (u_rsp U e1) c1
              (<span class="kr">fun</span>
                 (<span class="nv">a</span> : fin (length (u_rsp U e1)))
                 (<span class="nv">b</span> : k_rsp U
                        ((u_rsp U e1) .[ a])) =&gt;
               k0 (a,&amp; b)))) r))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) i 
  (VisF e0 k) (VisF e1 k0)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk1c"><span class="highlight"><span class="nb">injection</span> Ha <span class="kr">as</span> &lt;- Ha; <span class="nb">injection</span> Hb <span class="kr">as</span> &lt;- Hb.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry (ogs U) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k1, k2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : rsp (ogs U) e,
itree (ogs U) (X ‚àò fst) (nxt (ogs U) e x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">v</span> : rsp (ogs U) e,
paco3 (eqit_ eq·µ¢ true true id) bot3
  (nxt (ogs U) e v) (k1 v) 
  (k2 v)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : rsp U e, itree U X (nxt U e r)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">e,&amp; k1 =
e,&amp;
(<span class="kr">fun</span>
   <span class="nv">r</span> : {i0 : fin (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
       k_rsp U ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])} =&gt;
 ogs_emb
   (d_concat ks (u_rsp U e) c0
      (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
         (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
       k (a,&amp; b)))
   (uncurry2&#39;
      (d_get (ks +‚ñ∂ u_rsp U e)%ctx
         (d_concat ks (u_rsp U e) c0
            (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
               (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
             =&gt; k (a,&amp; b)))) r))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : rsp U e, itree U X (nxt U e r)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">e,&amp; k2 =
e,&amp;
(<span class="kr">fun</span>
   <span class="nv">r</span> : {i0 : fin (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
       k_rsp U ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])} =&gt;
 ogs_emb
   (d_concat ks (u_rsp U e) c1
      (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
         (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
       k0 (a,&amp; b)))
   (uncurry2&#39;
      (d_get (ks +‚ñ∂ u_rsp U e)%ctx
         (d_concat ks (u_rsp U e) c1
            (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
               (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
             =&gt; k0 (a,&amp; b)))) r))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) i 
  (VisF e k) (VisF e k0)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk1d"><span class="highlight"><span class="nb">econstructor</span>; <span class="nb">intros</span> v; <span class="nb">right</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry (ogs U) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k1, k2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : rsp (ogs U) e,
itree (ogs U) (X ‚àò fst) (nxt (ogs U) e x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">v</span> : rsp (ogs U) e,
paco3 (eqit_ eq·µ¢ true true id) bot3
  (nxt (ogs U) e v) (k1 v) 
  (k2 v)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : rsp U e, itree U X (nxt U e r)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">e,&amp; k1 =
e,&amp;
(<span class="kr">fun</span>
   <span class="nv">r</span> : {i0 : fin (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
       k_rsp U ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])} =&gt;
 ogs_emb
   (d_concat ks (u_rsp U e) c0
      (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
         (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
       k (a,&amp; b)))
   (uncurry2&#39;
      (d_get (ks +‚ñ∂ u_rsp U e)%ctx
         (d_concat ks (u_rsp U e) c0
            (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
               (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
             =&gt; k (a,&amp; b)))) r))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : rsp U e, itree U X (nxt U e r)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">e,&amp; k2 =
e,&amp;
(<span class="kr">fun</span>
   <span class="nv">r</span> : {i0 : fin (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
       k_rsp U ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])} =&gt;
 ogs_emb
   (d_concat ks (u_rsp U e) c1
      (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
         (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
       k0 (a,&amp; b)))
   (uncurry2&#39;
      (d_get (ks +‚ñ∂ u_rsp U e)%ctx
         (d_concat ks (u_rsp U e) c1
            (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
               (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
             =&gt; k0 (a,&amp; b)))) r))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">rsp U e</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">r (nxt U e v) (k v) (k0 v)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk1e"><span class="highlight"><span class="nb">apply</span> (CIH _ _ (d_concat ks _ c0 (<span class="kr">fun</span> <span class="nv">a</span> <span class="nv">b</span> =&gt; k (a ,&amp; b)))
               (d_concat ks _ c1 (<span class="kr">fun</span> <span class="nv">a</span> <span class="nv">b</span> =&gt; k0 (a ,&amp; b)))).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry (ogs U) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k1, k2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : rsp (ogs U) e,
itree (ogs U) (X ‚àò fst) (nxt (ogs U) e x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">v</span> : rsp (ogs U) e,
paco3 (eqit_ eq·µ¢ true true id) bot3
  (nxt (ogs U) e v) (k1 v) 
  (k2 v)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : rsp U e, itree U X (nxt U e r)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">e,&amp; k1 =
e,&amp;
(<span class="kr">fun</span>
   <span class="nv">r</span> : {i0 : fin (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
       k_rsp U ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])} =&gt;
 ogs_emb
   (d_concat ks (u_rsp U e) c0
      (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
         (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
       k (a,&amp; b)))
   (uncurry2&#39;
      (d_get (ks +‚ñ∂ u_rsp U e)%ctx
         (d_concat ks (u_rsp U e) c0
            (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
               (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
             =&gt; k (a,&amp; b)))) r))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : rsp U e, itree U X (nxt U e r)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">e,&amp; k2 =
e,&amp;
(<span class="kr">fun</span>
   <span class="nv">r</span> : {i0 : fin (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
       k_rsp U ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])} =&gt;
 ogs_emb
   (d_concat ks (u_rsp U e) c1
      (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
         (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
       k0 (a,&amp; b)))
   (uncurry2&#39;
      (d_get (ks +‚ñ∂ u_rsp U e)%ctx
         (d_concat ks (u_rsp U e) c1
            (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
               (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
             =&gt; k0 (a,&amp; b)))) r))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">rsp U e</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ogs_emb
  (d_concat ks (u_rsp U e) c0
     (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
        (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt; 
      k (a,&amp; b))) (k v)
‚âà ogs_emb
    (d_concat ks (u_rsp U e) c1
       (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
          (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
        k0 (a,&amp; b))) (k0 v)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk1f" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk1f"><span class="highlight"><span class="nb">dependent induction</span> Ha.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry (ogs U) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : rsp U e, itree U X (nxt U e r)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : rsp (ogs U) e,
itree (ogs U) (X ‚àò fst) (nxt (ogs U) e x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">v</span> : rsp (ogs U) e,
paco3 (eqit_ eq·µ¢ true true id) bot3
  (nxt (ogs U) e v)
  (ogs_emb
     (d_concat ks (u_rsp U e) c0
        (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
           (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
         k (a,&amp; b)))
     (uncurry2&#39;
        (d_get (ks +‚ñ∂ u_rsp U e)%ctx
           (d_concat ks (u_rsp U e) c0
              (<span class="kr">fun</span>
                 (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U
                        ((u_rsp U e) .[ a])) =&gt;
               k (a,&amp; b)))) v)) 
  (k2 v)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : rsp U e, itree U X (nxt U e r)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">e,&amp; k2 =
e,&amp;
(<span class="kr">fun</span>
   <span class="nv">r</span> : {i0 : fin (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
       k_rsp U ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])} =&gt;
 ogs_emb
   (d_concat ks (u_rsp U e) c1
      (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
         (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
       k0 (a,&amp; b)))
   (uncurry2&#39;
      (d_get (ks +‚ñ∂ u_rsp U e)%ctx
         (d_concat ks (u_rsp U e) c1
            (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
               (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
             =&gt; k0 (a,&amp; b)))) r))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">rsp U e</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ogs_emb
  (d_concat ks (u_rsp U e) c0
     (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
        (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt; 
      k (a,&amp; b))) (k v)
‚âà ogs_emb
    (d_concat ks (u_rsp U e) c1
       (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
          (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
        k0 (a,&amp; b))) (k0 v)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk20" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk20"><span class="highlight"><span class="nb">dependent induction</span> Hb.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry (ogs U) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : rsp U e, itree U X (nxt U e r)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : rsp U e, itree U X (nxt U e r)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">v</span> : rsp (ogs U) e,
paco3 (eqit_ eq·µ¢ true true id) bot3
  (nxt (ogs U) e v)
  (ogs_emb
     (d_concat ks (u_rsp U e) c0
        (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
           (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
         k (a,&amp; b)))
     (uncurry2&#39;
        (d_get (ks +‚ñ∂ u_rsp U e)%ctx
           (d_concat ks (u_rsp U e) c0
              (<span class="kr">fun</span>
                 (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U
                        ((u_rsp U e) .[ a])) =&gt;
               k (a,&amp; b)))) v))
  (ogs_emb
     (d_concat ks (u_rsp U e) c1
        (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
           (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
         k0 (a,&amp; b)))
     (uncurry2&#39;
        (d_get (ks +‚ñ∂ u_rsp U e)%ctx
           (d_concat ks (u_rsp U e) c1
              (<span class="kr">fun</span>
                 (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U
                        ((u_rsp U e) .[ a])) =&gt;
               k0 (a,&amp; b)))) v))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">rsp U e</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ogs_emb
  (d_concat ks (u_rsp U e) c0
     (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
        (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt; 
      k (a,&amp; b))) (k v)
‚âà ogs_emb
    (d_concat ks (u_rsp U e) c1
       (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
          (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
        k0 (a,&amp; b))) (k0 v)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk21"><span class="highlight"><span class="nb">apply</span> (<span class="kr">fun</span> <span class="nv">f</span> =&gt; f (ogs_inj_rsp v)) <span class="kr">in</span> REL.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry (ogs U) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : rsp U e, itree U X (nxt U e r)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : rsp U e, itree U X (nxt U e r)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">rsp U e</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">paco3 (eqit_ eq·µ¢ true true id) bot3
  (nxt (ogs U) e (ogs_inj_rsp v))
  (ogs_emb
     (d_concat ks (u_rsp U e) c0
        (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
           (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
         k (a,&amp; b)))
     (uncurry2&#39;
        (d_get (ks +‚ñ∂ u_rsp U e)%ctx
           (d_concat ks (u_rsp U e) c0
              (<span class="kr">fun</span>
                 (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U
                        ((u_rsp U e) .[ a])) =&gt;
               k (a,&amp; b)))) 
        (ogs_inj_rsp v)))
  (ogs_emb
     (d_concat ks (u_rsp U e) c1
        (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
           (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
         k0 (a,&amp; b)))
     (uncurry2&#39;
        (d_get (ks +‚ñ∂ u_rsp U e)%ctx
           (d_concat ks (u_rsp U e) c1
              (<span class="kr">fun</span>
                 (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U
                        ((u_rsp U e) .[ a])) =&gt;
               k0 (a,&amp; b)))) 
        (ogs_inj_rsp v)))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ogs_emb
  (d_concat ks (u_rsp U e) c0
     (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
        (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt; 
      k (a,&amp; b))) (k v)
‚âà ogs_emb
    (d_concat ks (u_rsp U e) c1
       (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
          (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
        k0 (a,&amp; b))) (k0 v)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk22" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk22"><span class="highlight"><span class="nb">cbn</span> [projT1 projT2 ogs_inj_rsp] <span class="kr">in</span> REL.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry (ogs U) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : rsp U e, itree U X (nxt U e r)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : rsp U e, itree U X (nxt U e r)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">rsp U e</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">paco3 (eqit_ eq·µ¢ true true id) bot3
  (nxt (ogs U) e (ogs_inj_rsp v))
  (ogs_emb
     (d_concat ks (u_rsp U e) c0
        (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
           (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
         k (a,&amp; b)))
     (uncurry2&#39;
        (d_get (ks +‚ñ∂ u_rsp U e)%ctx
           (d_concat ks (u_rsp U e) c0
              (<span class="kr">fun</span>
                 (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U
                        ((u_rsp U e) .[ a])) =&gt;
               k (a,&amp; b)))) 
        (ogs_inj_rsp v)))
  (ogs_emb
     (d_concat ks (u_rsp U e) c1
        (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
           (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
         k0 (a,&amp; b)))
     (uncurry2&#39;
        (d_get (ks +‚ñ∂ u_rsp U e)%ctx
           (d_concat ks (u_rsp U e) c1
              (<span class="kr">fun</span>
                 (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U
                        ((u_rsp U e) .[ a])) =&gt;
               k0 (a,&amp; b)))) 
        (ogs_inj_rsp v)))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ogs_emb
  (d_concat ks (u_rsp U e) c0
     (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
        (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt; 
      k (a,&amp; b))) (k v)
‚âà ogs_emb
    (d_concat ks (u_rsp U e) c1
       (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
          (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
        k0 (a,&amp; b))) (k0 v)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">admit</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk23"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree (ogs U) (X ‚àò fst) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ot2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree&#39; (ogs U) (X ‚àò fst) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CHECK</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">is_true true</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) bot3) 
  (i, ks) (observe t1) ot2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHeqitF</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(<span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
   (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
   (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
 ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b) -&gt;
<span class="kr">forall</span> (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
observe t1 = observe (ogs_emb c0 a) -&gt;
ot2 = observe (ogs_emb c1 b) -&gt;
eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) i
  (observe a) (observe b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF t1 =
_observe
  <span class="kr">match</span> _observe a <span class="kr">with</span>
  | RetF x =&gt; Ret x
  | TauF t =&gt; Tau (ogs_emb c0 t)
  | VisF e k =&gt;
      Vis e
        (<span class="kr">fun</span>
           <span class="nv">r</span> : {i0
               : fin
                   (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
               k_rsp U
                 ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
         =&gt;
         ogs_emb
           (d_concat ks (u_rsp U e) c0
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
               =&gt; k (a,&amp; b)))
           (uncurry2&#39;
              (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                 (d_concat ks 
                    (u_rsp U e) c0
                    (<span class="kr">fun</span>
                       (<span class="nv">a</span> : 
                        fin 
                        (length (u_rsp U e)))
                       (<span class="nv">b</span> : 
                        k_rsp U
                        ((u_rsp U e) .[ a])) =&gt;
                     k (a,&amp; b)))) r))
  <span class="kr">end</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ot2 =
_observe
  <span class="kr">match</span> _observe b <span class="kr">with</span>
  | RetF x =&gt; Ret x
  | TauF t =&gt; Tau (ogs_emb c1 t)
  | VisF e k =&gt;
      Vis e
        (<span class="kr">fun</span>
           <span class="nv">r</span> : {i0
               : fin
                   (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
               k_rsp U
                 ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
         =&gt;
         ogs_emb
           (d_concat ks (u_rsp U e) c1
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
               =&gt; k (a,&amp; b)))
           (uncurry2&#39;
              (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                 (d_concat ks 
                    (u_rsp U e) c1
                    (<span class="kr">fun</span>
                       (<span class="nv">a</span> : 
                        fin 
                        (length (u_rsp U e)))
                       (<span class="nv">b</span> : 
                        k_rsp U
                        ((u_rsp U e) .[ a])) =&gt;
                     k (a,&amp; b)))) r))
  <span class="kr">end</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) i 
  (_observe a) (_observe b)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk24" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk24"><span class="highlight"><span class="nb">destruct</span> (_observe a); <span class="kp">try</span> <span class="bp">discriminate</span> Ha.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree (ogs U) (X ‚àò fst) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ot2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree&#39; (ogs U) (X ‚àò fst) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CHECK</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">is_true true</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) bot3) 
  (i, ks) (observe t1) ot2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHeqitF</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(<span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
   (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
   (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
 ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b) -&gt;
<span class="kr">forall</span> (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
observe t1 = observe (ogs_emb c0 a) -&gt;
ot2 = observe (ogs_emb c1 b) -&gt;
eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) i
  (observe a) (observe b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b, t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF t1 = _observe (Tau (ogs_emb c0 t))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ot2 =
_observe
  <span class="kr">match</span> _observe b <span class="kr">with</span>
  | RetF x =&gt; Ret x
  | TauF t =&gt; Tau (ogs_emb c1 t)
  | VisF e k =&gt;
      Vis e
        (<span class="kr">fun</span>
           <span class="nv">r</span> : {i0
               : fin
                   (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
               k_rsp U
                 ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
         =&gt;
         ogs_emb
           (d_concat ks (u_rsp U e) c1
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
               =&gt; k (a,&amp; b)))
           (uncurry2&#39;
              (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                 (d_concat ks 
                    (u_rsp U e) c1
                    (<span class="kr">fun</span>
                       (<span class="nv">a</span> : 
                        fin 
                        (length (u_rsp U e)))
                       (<span class="nv">b</span> : 
                        k_rsp U
                        ((u_rsp U e) .[ a])) =&gt;
                     k (a,&amp; b)))) r))
  <span class="kr">end</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) i 
  (TauF t) (_observe b)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk25" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk25"><span class="highlight"><span class="nb">econstructor</span>; <span class="nb">auto</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree (ogs U) (X ‚àò fst) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ot2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree&#39; (ogs U) (X ‚àò fst) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CHECK</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">is_true true</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) bot3) 
  (i, ks) (observe t1) ot2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHeqitF</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(<span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
   (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
   (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
 ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b) -&gt;
<span class="kr">forall</span> (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
observe t1 = observe (ogs_emb c0 a) -&gt;
ot2 = observe (ogs_emb c1 b) -&gt;
eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) i
  (observe a) (observe b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b, t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF t1 = _observe (Tau (ogs_emb c0 t))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ot2 =
_observe
  <span class="kr">match</span> _observe b <span class="kr">with</span>
  | RetF x =&gt; Ret x
  | TauF t =&gt; Tau (ogs_emb c1 t)
  | VisF e k =&gt;
      Vis e
        (<span class="kr">fun</span>
           <span class="nv">r</span> : {i0
               : fin
                   (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
               k_rsp U
                 ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
         =&gt;
         ogs_emb
           (d_concat ks (u_rsp U e) c1
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
               =&gt; k (a,&amp; b)))
           (uncurry2&#39;
              (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                 (d_concat ks 
                    (u_rsp U e) c1
                    (<span class="kr">fun</span>
                       (<span class="nv">a</span> : 
                        fin 
                        (length (u_rsp U e)))
                       (<span class="nv">b</span> : 
                        k_rsp U
                        ((u_rsp U e) .[ a])) =&gt;
                     k (a,&amp; b)))) r))
  <span class="kr">end</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) i 
  (observe t) (_observe b)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk26" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk26"><span class="highlight"><span class="nb">enough</span> (Hcut : _) <span class="bp">by</span> <span class="nb">apply</span> (IHeqitF CIH c0 c1 t b Hcut Hb).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree (ogs U) (X ‚àò fst) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ot2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree&#39; (ogs U) (X ‚àò fst) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CHECK</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">is_true true</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) bot3) 
  (i, ks) (observe t1) ot2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHeqitF</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(<span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
   (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
   (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
 ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b) -&gt;
<span class="kr">forall</span> (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
observe t1 = observe (ogs_emb c0 a) -&gt;
ot2 = observe (ogs_emb c1 b) -&gt;
eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) i
  (observe a) (observe b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b, t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF t1 = _observe (Tau (ogs_emb c0 t))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ot2 =
_observe
  <span class="kr">match</span> _observe b <span class="kr">with</span>
  | RetF x =&gt; Ret x
  | TauF t =&gt; Tau (ogs_emb c1 t)
  | VisF e k =&gt;
      Vis e
        (<span class="kr">fun</span>
           <span class="nv">r</span> : {i0
               : fin
                   (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
               k_rsp U
                 ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
         =&gt;
         ogs_emb
           (d_concat ks (u_rsp U e) c1
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
               =&gt; k (a,&amp; b)))
           (uncurry2&#39;
              (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                 (d_concat ks 
                    (u_rsp U e) c1
                    (<span class="kr">fun</span>
                       (<span class="nv">a</span> : 
                        fin 
                        (length (u_rsp U e)))
                       (<span class="nv">b</span> : 
                        k_rsp U
                        ((u_rsp U e) .[ a])) =&gt;
                     k (a,&amp; b)))) r))
  <span class="kr">end</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">observe t1 = observe (ogs_emb c0 t)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">f_equal</span>; <span class="nb">injection</span> Ha <span class="kr">as</span> Ha; <span class="bp">exact</span> Ha.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk27" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk27"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ot1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree&#39; (ogs U) (X ‚àò fst) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree (ogs U) (X ‚àò fst) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CHECK</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">is_true true</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) bot3) 
  (i, ks) ot1 (observe t2)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHeqitF</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(<span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
   (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
   (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
 ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b) -&gt;
<span class="kr">forall</span> (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ot1 = observe (ogs_emb c0 a) -&gt;
observe t2 = observe (ogs_emb c1 b) -&gt;
eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) i
  (observe a) (observe b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ot1 =
_observe
  <span class="kr">match</span> _observe a <span class="kr">with</span>
  | RetF x =&gt; Ret x
  | TauF t =&gt; Tau (ogs_emb c0 t)
  | VisF e k =&gt;
      Vis e
        (<span class="kr">fun</span>
           <span class="nv">r</span> : {i0
               : fin
                   (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
               k_rsp U
                 ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
         =&gt;
         ogs_emb
           (d_concat ks (u_rsp U e) c0
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
               =&gt; k (a,&amp; b)))
           (uncurry2&#39;
              (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                 (d_concat ks 
                    (u_rsp U e) c0
                    (<span class="kr">fun</span>
                       (<span class="nv">a</span> : 
                        fin 
                        (length (u_rsp U e)))
                       (<span class="nv">b</span> : 
                        k_rsp U
                        ((u_rsp U e) .[ a])) =&gt;
                     k (a,&amp; b)))) r))
  <span class="kr">end</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF t2 =
_observe
  <span class="kr">match</span> _observe b <span class="kr">with</span>
  | RetF x =&gt; Ret x
  | TauF t =&gt; Tau (ogs_emb c1 t)
  | VisF e k =&gt;
      Vis e
        (<span class="kr">fun</span>
           <span class="nv">r</span> : {i0
               : fin
                   (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
               k_rsp U
                 ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
         =&gt;
         ogs_emb
           (d_concat ks (u_rsp U e) c1
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
               =&gt; k (a,&amp; b)))
           (uncurry2&#39;
              (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                 (d_concat ks 
                    (u_rsp U e) c1
                    (<span class="kr">fun</span>
                       (<span class="nv">a</span> : 
                        fin 
                        (length (u_rsp U e)))
                       (<span class="nv">b</span> : 
                        k_rsp U
                        ((u_rsp U e) .[ a])) =&gt;
                     k (a,&amp; b)))) r))
  <span class="kr">end</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) i 
  (_observe a) (_observe b)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk28" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk28"><span class="highlight"><span class="nb">destruct</span> (_observe b); <span class="kp">try</span> <span class="bp">discriminate</span> Hb.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ot1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree&#39; (ogs U) (X ‚àò fst) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree (ogs U) (X ‚àò fst) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CHECK</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">is_true true</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) bot3) 
  (i, ks) ot1 (observe t2)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHeqitF</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(<span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
   (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
   (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
 ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b) -&gt;
<span class="kr">forall</span> (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ot1 = observe (ogs_emb c0 a) -&gt;
observe t2 = observe (ogs_emb c1 b) -&gt;
eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) i
  (observe a) (observe b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ot1 =
_observe
  <span class="kr">match</span> _observe a <span class="kr">with</span>
  | RetF x =&gt; Ret x
  | TauF t =&gt; Tau (ogs_emb c0 t)
  | VisF e k =&gt;
      Vis e
        (<span class="kr">fun</span>
           <span class="nv">r</span> : {i0
               : fin
                   (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
               k_rsp U
                 ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
         =&gt;
         ogs_emb
           (d_concat ks (u_rsp U e) c0
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
               =&gt; k (a,&amp; b)))
           (uncurry2&#39;
              (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                 (d_concat ks 
                    (u_rsp U e) c0
                    (<span class="kr">fun</span>
                       (<span class="nv">a</span> : 
                        fin 
                        (length (u_rsp U e)))
                       (<span class="nv">b</span> : 
                        k_rsp U
                        ((u_rsp U e) .[ a])) =&gt;
                     k (a,&amp; b)))) r))
  <span class="kr">end</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF t2 = _observe (Tau (ogs_emb c1 t))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) i 
  (_observe a) (TauF t)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk29" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk29"><span class="highlight"><span class="nb">econstructor</span>; <span class="nb">auto</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ot1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree&#39; (ogs U) (X ‚àò fst) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree (ogs U) (X ‚àò fst) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CHECK</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">is_true true</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) bot3) 
  (i, ks) ot1 (observe t2)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHeqitF</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(<span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
   (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
   (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
 ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b) -&gt;
<span class="kr">forall</span> (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ot1 = observe (ogs_emb c0 a) -&gt;
observe t2 = observe (ogs_emb c1 b) -&gt;
eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) i
  (observe a) (observe b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ot1 =
_observe
  <span class="kr">match</span> _observe a <span class="kr">with</span>
  | RetF x =&gt; Ret x
  | TauF t =&gt; Tau (ogs_emb c0 t)
  | VisF e k =&gt;
      Vis e
        (<span class="kr">fun</span>
           <span class="nv">r</span> : {i0
               : fin
                   (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
               k_rsp U
                 ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
         =&gt;
         ogs_emb
           (d_concat ks (u_rsp U e) c0
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
               =&gt; k (a,&amp; b)))
           (uncurry2&#39;
              (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                 (d_concat ks 
                    (u_rsp U e) c0
                    (<span class="kr">fun</span>
                       (<span class="nv">a</span> : 
                        fin 
                        (length (u_rsp U e)))
                       (<span class="nv">b</span> : 
                        k_rsp U
                        ((u_rsp U e) .[ a])) =&gt;
                     k (a,&amp; b)))) r))
  <span class="kr">end</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF t2 = _observe (Tau (ogs_emb c1 t))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) i 
  (_observe a) (observe t)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk2a"><span class="highlight"><span class="nb">enough</span> (Hcut : _) <span class="bp">by</span> <span class="nb">apply</span> (IHeqitF CIH c0 c1 a t Ha Hcut).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I, itree U X x -&gt; itree U X x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ot1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree&#39; (ogs U) (X ‚àò fst) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree (ogs U) (X ‚àò fst) (i, ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CHECK</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">is_true true</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) bot3) 
  (i, ks) ot1 (observe t2)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHeqitF</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(<span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
   (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
   (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
 ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b) -&gt;
<span class="kr">forall</span> (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ot1 = observe (ogs_emb c0 a) -&gt;
observe t2 = observe (ogs_emb c1 b) -&gt;
eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) i
  (observe a) (observe b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ogs_emb c0 a ‚âà ogs_emb c1 b -&gt; r i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ot1 =
_observe
  <span class="kr">match</span> _observe a <span class="kr">with</span>
  | RetF x =&gt; Ret x
  | TauF t =&gt; Tau (ogs_emb c0 t)
  | VisF e k =&gt;
      Vis e
        (<span class="kr">fun</span>
           <span class="nv">r</span> : {i0
               : fin
                   (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
               k_rsp U
                 ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
         =&gt;
         ogs_emb
           (d_concat ks (u_rsp U e) c0
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
               =&gt; k (a,&amp; b)))
           (uncurry2&#39;
              (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                 (d_concat ks 
                    (u_rsp U e) c0
                    (<span class="kr">fun</span>
                       (<span class="nv">a</span> : 
                        fin 
                        (length (u_rsp U e)))
                       (<span class="nv">b</span> : 
                        k_rsp U
                        ((u_rsp U e) .[ a])) =&gt;
                     k (a,&amp; b)))) r))
  <span class="kr">end</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF t2 = _observe (Tau (ogs_emb c1 t))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">observe t2 = observe (ogs_emb c1 t)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">f_equal</span>; <span class="nb">injection</span> Hb <span class="kr">as</span> Hb; <span class="bp">exact</span> Hb.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Admitted</span>.</span></span></span></pre><p>The completeness result: given two eutt trees and two pointwise eutt forests,
the OGS embedding are eutt. Again this is a direct proof by coinduction and
pattern matching on the proofs.</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk2b" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk2b"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">ogs_complete</span> {<span class="nv">I</span>} {<span class="nv">U</span> : uniform_event I I} {<span class="nv">X</span> <span class="nv">i</span> <span class="nv">ks</span>}
        (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks) (<span class="nv">a</span> <span class="nv">b</span> : itree U X i)
        : (a ‚âà b) -&gt; eutt_conf c0 c1 -&gt; ogs_emb c0 a ‚âà ogs_emb c1 b.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">a ‚âà b -&gt;
eutt_conf c0 c1 -&gt; ogs_emb c0 a ‚âà ogs_emb c1 b</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk2c"><span class="highlight"><span class="nb">revert</span> i ks c0 c1 a b.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt; ogs_emb c0 a ‚âà ogs_emb c1 b</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk2d"><span class="highlight">pcofix CIH.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
paco3 (eqit_ eq·µ¢ true true id) r 
  (i, ks) (ogs_emb c0 a) 
  (ogs_emb c1 b)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk2e" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk2e"><span class="highlight"><span class="nb">intros</span> i ks c0 c1 a b H0 H1.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a ‚âà b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eutt_conf c0 c1</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">paco3 (eqit_ eq·µ¢ true true id) r 
  (i, ks) (ogs_emb c0 a) 
  (ogs_emb c1 b)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk2f"><span class="highlight">pstep; punfold H0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqit_ eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) bot3) i a b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eutt_conf c0 c1</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eqit_ eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) 
  (i, ks) (ogs_emb c0 a) 
  (ogs_emb c1 b)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk30" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk30"><span class="highlight"><span class="nb">red</span> <span class="kr">in</span> H0, H1 |- *.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) bot3) i
  (observe a) (observe b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
  (<span class="nv">r</span> : k_rsp U (ks .[ i])),
d_get ks c0 i r ‚âà d_get ks c1 i r</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) 
  (i, ks) (observe (ogs_emb c0 a))
  (observe (ogs_emb c1 b))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk31" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk31"><span class="highlight"><span class="nb">cbv</span> [ observe ] <span class="kr">in</span> H0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) bot3) i
  (_observe a) (_observe b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
  (<span class="nv">r</span> : k_rsp U (ks .[ i])),
d_get ks c0 i r ‚âà d_get ks c1 i r</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) 
  (i, ks) (observe (ogs_emb c0 a))
  (observe (ogs_emb c1 b))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk32" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk32"><span class="highlight"><span class="nb">cbv</span> [ ogs_emb observe ]; <span class="nb">cbn</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) bot3) i
  (_observe a) (_observe b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
  (<span class="nv">r</span> : k_rsp U (ks .[ i])),
d_get ks c0 i r ‚âà d_get ks c1 i r</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) 
  (i, ks)
  (_observe
     <span class="kr">match</span> _observe a <span class="kr">with</span>
     | RetF x =&gt; Ret x
     | TauF t =&gt;
         Tau
           ((<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks : list (kon U))
               (c : ogs_conf (itree U X) ks)
               (x : itree U X i) :
                 itree (ogs U) (X ‚àò fst) (i, ks) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t0 =&gt; Tau (_ogs_emb i ks c t0)
               | VisF e k =&gt;
                   Vis e
                     (<span class="kr">fun</span>
                        <span class="nv">r</span> : 
                        {i0
                        : 
                        fin
                        (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                        k_rsp U
                        ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb 
                        (k_nxt U (projT2 r))
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))
                        (uncurry2&#39;
                        (d_get 
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin ...)
                        (<span class="nv">b</span> : k_rsp U ...) =&gt; 
                        k (a,&amp; b)))) r))
               <span class="kr">end</span>) i ks c0 t)
     | VisF e k =&gt;
         Vis e
           (<span class="kr">fun</span>
              <span class="nv">r</span> : {i0
                  : fin (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                  k_rsp U
                    ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])} =&gt;
            (<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks : list (kon U))
               (c : ogs_conf (itree U X) ks)
               (x : itree U X i) :
                 itree (ogs U) (X ‚àò fst) (i, ks) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t =&gt; Tau (_ogs_emb i ks c t)
               | VisF e0 k0 =&gt;
                   Vis e0
                     (<span class="kr">fun</span>
                        <span class="nv">r0</span> : 
                        {i0
                        : 
                        fin
                        (length (ks +‚ñ∂ u_rsp U e0)%ctx) &amp;
                        k_rsp U
                        ((ks +‚ñ∂ u_rsp U e0)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb 
                        (k_nxt U (projT2 r0))
                        (ks +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks 
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin (length (...)))
                        (<span class="nv">b</span> : k_rsp U ((...) .[ a])) =&gt;
                        k0 (a,&amp; b)))
                        (uncurry2&#39;
                        (d_get 
                        (ks +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks 
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> (<span class="nv">a</span> : ...) (<span class="nv">b</span> : ...) =&gt;
                        k0 (...)))) r0))
               <span class="kr">end</span>) (k_nxt U (projT2 r))
              (ks +‚ñ∂ u_rsp U e)%ctx
              (d_concat ks 
                 (u_rsp U e) c0
                 (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                    (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
                  =&gt; k (a,&amp; b)))
              (uncurry2&#39;
                 (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                    (d_concat ks 
                       (u_rsp U e) c0
                       (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))) r))
     <span class="kr">end</span>)
  (_observe
     <span class="kr">match</span> _observe b <span class="kr">with</span>
     | RetF x =&gt; Ret x
     | TauF t =&gt;
         Tau
           ((<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks : list (kon U))
               (c : ogs_conf (itree U X) ks)
               (x : itree U X i) :
                 itree (ogs U) (X ‚àò fst) (i, ks) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t0 =&gt; Tau (_ogs_emb i ks c t0)
               | VisF e k =&gt;
                   Vis e
                     (<span class="kr">fun</span>
                        <span class="nv">r</span> : 
                        {i0
                        : 
                        fin
                        (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                        k_rsp U
                        ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb 
                        (k_nxt U (projT2 r))
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))
                        (uncurry2&#39;
                        (d_get 
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin ...)
                        (<span class="nv">b</span> : k_rsp U ...) =&gt; 
                        k (a,&amp; b)))) r))
               <span class="kr">end</span>) i ks c1 t)
     | VisF e k =&gt;
         Vis e
           (<span class="kr">fun</span>
              <span class="nv">r</span> : {i0
                  : fin (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                  k_rsp U
                    ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])} =&gt;
            (<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks : list (kon U))
               (c : ogs_conf (itree U X) ks)
               (x : itree U X i) :
                 itree (ogs U) (X ‚àò fst) (i, ks) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t =&gt; Tau (_ogs_emb i ks c t)
               | VisF e0 k0 =&gt;
                   Vis e0
                     (<span class="kr">fun</span>
                        <span class="nv">r0</span> : 
                        {i0
                        : 
                        fin
                        (length (ks +‚ñ∂ u_rsp U e0)%ctx) &amp;
                        k_rsp U
                        ((ks +‚ñ∂ u_rsp U e0)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb 
                        (k_nxt U (projT2 r0))
                        (ks +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks 
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin (length (...)))
                        (<span class="nv">b</span> : k_rsp U ((...) .[ a])) =&gt;
                        k0 (a,&amp; b)))
                        (uncurry2&#39;
                        (d_get 
                        (ks +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks 
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> (<span class="nv">a</span> : ...) (<span class="nv">b</span> : ...) =&gt;
                        k0 (...)))) r0))
               <span class="kr">end</span>) (k_nxt U (projT2 r))
              (ks +‚ñ∂ u_rsp U e)%ctx
              (d_concat ks 
                 (u_rsp U e) c1
                 (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                    (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
                  =&gt; k (a,&amp; b)))
              (uncurry2&#39;
                 (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                    (d_concat ks 
                       (u_rsp U e) c1
                       (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))) r))
     <span class="kr">end</span>)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk33" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk33"><span class="highlight"><span class="nb">remember</span> (_observe a) <span class="kr">as</span> x.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree&#39; U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = _observe a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) bot3) i x
  (_observe b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
  (<span class="nv">r</span> : k_rsp U (ks .[ i])),
d_get ks c0 i r ‚âà d_get ks c1 i r</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) 
  (i, ks)
  (_observe
     <span class="kr">match</span> x <span class="kr">with</span>
     | RetF x =&gt; Ret x
     | TauF t =&gt;
         Tau
           ((<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks : list (kon U))
               (c : ogs_conf (itree U X) ks)
               (x : itree U X i) :
                 itree (ogs U) (X ‚àò fst) (i, ks) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t0 =&gt; Tau (_ogs_emb i ks c t0)
               | VisF e k =&gt;
                   Vis e
                     (<span class="kr">fun</span>
                        <span class="nv">r</span> : 
                        {i0
                        : 
                        fin
                        (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                        k_rsp U
                        ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb 
                        (k_nxt U (projT2 r))
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))
                        (uncurry2&#39;
                        (d_get 
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin ...)
                        (<span class="nv">b</span> : k_rsp U ...) =&gt; 
                        k (a,&amp; b)))) r))
               <span class="kr">end</span>) i ks c0 t)
     | VisF e k =&gt;
         Vis e
           (<span class="kr">fun</span>
              <span class="nv">r</span> : {i0
                  : fin (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                  k_rsp U
                    ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])} =&gt;
            (<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks : list (kon U))
               (c : ogs_conf (itree U X) ks)
               (x : itree U X i) :
                 itree (ogs U) (X ‚àò fst) (i, ks) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t =&gt; Tau (_ogs_emb i ks c t)
               | VisF e0 k0 =&gt;
                   Vis e0
                     (<span class="kr">fun</span>
                        <span class="nv">r0</span> : 
                        {i0
                        : 
                        fin
                        (length (ks +‚ñ∂ u_rsp U e0)%ctx) &amp;
                        k_rsp U
                        ((ks +‚ñ∂ u_rsp U e0)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb 
                        (k_nxt U (projT2 r0))
                        (ks +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks 
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin (length (...)))
                        (<span class="nv">b</span> : k_rsp U ((...) .[ a])) =&gt;
                        k0 (a,&amp; b)))
                        (uncurry2&#39;
                        (d_get 
                        (ks +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks 
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> (<span class="nv">a</span> : ...) (<span class="nv">b</span> : ...) =&gt;
                        k0 (...)))) r0))
               <span class="kr">end</span>) (k_nxt U (projT2 r))
              (ks +‚ñ∂ u_rsp U e)%ctx
              (d_concat ks 
                 (u_rsp U e) c0
                 (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                    (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
                  =&gt; k (a,&amp; b)))
              (uncurry2&#39;
                 (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                    (d_concat ks 
                       (u_rsp U e) c0
                       (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))) r))
     <span class="kr">end</span>)
  (_observe
     <span class="kr">match</span> _observe b <span class="kr">with</span>
     | RetF x =&gt; Ret x
     | TauF t =&gt;
         Tau
           ((<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks : list (kon U))
               (c : ogs_conf (itree U X) ks)
               (x : itree U X i) :
                 itree (ogs U) (X ‚àò fst) (i, ks) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t0 =&gt; Tau (_ogs_emb i ks c t0)
               | VisF e k =&gt;
                   Vis e
                     (<span class="kr">fun</span>
                        <span class="nv">r</span> : 
                        {i0
                        : 
                        fin
                        (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                        k_rsp U
                        ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb 
                        (k_nxt U (projT2 r))
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))
                        (uncurry2&#39;
                        (d_get 
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin ...)
                        (<span class="nv">b</span> : k_rsp U ...) =&gt; 
                        k (a,&amp; b)))) r))
               <span class="kr">end</span>) i ks c1 t)
     | VisF e k =&gt;
         Vis e
           (<span class="kr">fun</span>
              <span class="nv">r</span> : {i0
                  : fin (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                  k_rsp U
                    ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])} =&gt;
            (<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks : list (kon U))
               (c : ogs_conf (itree U X) ks)
               (x : itree U X i) :
                 itree (ogs U) (X ‚àò fst) (i, ks) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t =&gt; Tau (_ogs_emb i ks c t)
               | VisF e0 k0 =&gt;
                   Vis e0
                     (<span class="kr">fun</span>
                        <span class="nv">r0</span> : 
                        {i0
                        : 
                        fin
                        (length (ks +‚ñ∂ u_rsp U e0)%ctx) &amp;
                        k_rsp U
                        ((ks +‚ñ∂ u_rsp U e0)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb 
                        (k_nxt U (projT2 r0))
                        (ks +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks 
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin (length (...)))
                        (<span class="nv">b</span> : k_rsp U ((...) .[ a])) =&gt;
                        k0 (a,&amp; b)))
                        (uncurry2&#39;
                        (d_get 
                        (ks +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks 
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> (<span class="nv">a</span> : ...) (<span class="nv">b</span> : ...) =&gt;
                        k0 (...)))) r0))
               <span class="kr">end</span>) (k_nxt U (projT2 r))
              (ks +‚ñ∂ u_rsp U e)%ctx
              (d_concat ks 
                 (u_rsp U e) c1
                 (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                    (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
                  =&gt; k (a,&amp; b)))
              (uncurry2&#39;
                 (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                    (d_concat ks 
                       (u_rsp U e) c1
                       (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))) r))
     <span class="kr">end</span>)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk34" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk34"><span class="highlight"><span class="nb">remember</span> (_observe b) <span class="kr">as</span> y.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree&#39; U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = _observe a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree&#39; U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">y = _observe b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) bot3) i x y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
  (<span class="nv">r</span> : k_rsp U (ks .[ i])),
d_get ks c0 i r ‚âà d_get ks c1 i r</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) 
  (i, ks)
  (_observe
     <span class="kr">match</span> x <span class="kr">with</span>
     | RetF x =&gt; Ret x
     | TauF t =&gt;
         Tau
           ((<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks : list (kon U))
               (c : ogs_conf (itree U X) ks)
               (x : itree U X i) :
                 itree (ogs U) (X ‚àò fst) (i, ks) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t0 =&gt; Tau (_ogs_emb i ks c t0)
               | VisF e k =&gt;
                   Vis e
                     (<span class="kr">fun</span>
                        <span class="nv">r</span> : 
                        {i0
                        : 
                        fin
                        (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                        k_rsp U
                        ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb 
                        (k_nxt U (projT2 r))
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))
                        (uncurry2&#39;
                        (d_get 
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin ...)
                        (<span class="nv">b</span> : k_rsp U ...) =&gt; 
                        k (a,&amp; b)))) r))
               <span class="kr">end</span>) i ks c0 t)
     | VisF e k =&gt;
         Vis e
           (<span class="kr">fun</span>
              <span class="nv">r</span> : {i0
                  : fin (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                  k_rsp U
                    ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])} =&gt;
            (<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks : list (kon U))
               (c : ogs_conf (itree U X) ks)
               (x : itree U X i) :
                 itree (ogs U) (X ‚àò fst) (i, ks) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t =&gt; Tau (_ogs_emb i ks c t)
               | VisF e0 k0 =&gt;
                   Vis e0
                     (<span class="kr">fun</span>
                        <span class="nv">r0</span> : 
                        {i0
                        : 
                        fin
                        (length (ks +‚ñ∂ u_rsp U e0)%ctx) &amp;
                        k_rsp U
                        ((ks +‚ñ∂ u_rsp U e0)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb 
                        (k_nxt U (projT2 r0))
                        (ks +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks 
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin (length (...)))
                        (<span class="nv">b</span> : k_rsp U ((...) .[ a])) =&gt;
                        k0 (a,&amp; b)))
                        (uncurry2&#39;
                        (d_get 
                        (ks +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks 
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> (<span class="nv">a</span> : ...) (<span class="nv">b</span> : ...) =&gt;
                        k0 (...)))) r0))
               <span class="kr">end</span>) (k_nxt U (projT2 r))
              (ks +‚ñ∂ u_rsp U e)%ctx
              (d_concat ks 
                 (u_rsp U e) c0
                 (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                    (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
                  =&gt; k (a,&amp; b)))
              (uncurry2&#39;
                 (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                    (d_concat ks 
                       (u_rsp U e) c0
                       (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))) r))
     <span class="kr">end</span>)
  (_observe
     <span class="kr">match</span> y <span class="kr">with</span>
     | RetF x =&gt; Ret x
     | TauF t =&gt;
         Tau
           ((<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks : list (kon U))
               (c : ogs_conf (itree U X) ks)
               (x : itree U X i) :
                 itree (ogs U) (X ‚àò fst) (i, ks) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t0 =&gt; Tau (_ogs_emb i ks c t0)
               | VisF e k =&gt;
                   Vis e
                     (<span class="kr">fun</span>
                        <span class="nv">r</span> : 
                        {i0
                        : 
                        fin
                        (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                        k_rsp U
                        ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb 
                        (k_nxt U (projT2 r))
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))
                        (uncurry2&#39;
                        (d_get 
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin ...)
                        (<span class="nv">b</span> : k_rsp U ...) =&gt; 
                        k (a,&amp; b)))) r))
               <span class="kr">end</span>) i ks c1 t)
     | VisF e k =&gt;
         Vis e
           (<span class="kr">fun</span>
              <span class="nv">r</span> : {i0
                  : fin (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                  k_rsp U
                    ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])} =&gt;
            (<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks : list (kon U))
               (c : ogs_conf (itree U X) ks)
               (x : itree U X i) :
                 itree (ogs U) (X ‚àò fst) (i, ks) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t =&gt; Tau (_ogs_emb i ks c t)
               | VisF e0 k0 =&gt;
                   Vis e0
                     (<span class="kr">fun</span>
                        <span class="nv">r0</span> : 
                        {i0
                        : 
                        fin
                        (length (ks +‚ñ∂ u_rsp U e0)%ctx) &amp;
                        k_rsp U
                        ((ks +‚ñ∂ u_rsp U e0)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb 
                        (k_nxt U (projT2 r0))
                        (ks +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks 
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin (length (...)))
                        (<span class="nv">b</span> : k_rsp U ((...) .[ a])) =&gt;
                        k0 (a,&amp; b)))
                        (uncurry2&#39;
                        (d_get 
                        (ks +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks 
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> (<span class="nv">a</span> : ...) (<span class="nv">b</span> : ...) =&gt;
                        k0 (...)))) r0))
               <span class="kr">end</span>) (k_nxt U (projT2 r))
              (ks +‚ñ∂ u_rsp U e)%ctx
              (d_concat ks 
                 (u_rsp U e) c1
                 (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                    (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
                  =&gt; k (a,&amp; b)))
              (uncurry2&#39;
                 (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                    (d_concat ks 
                       (u_rsp U e) c1
                       (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))) r))
     <span class="kr">end</span>)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk35" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk35"><span class="highlight">hinduction H0 <span class="nb">before</span> r; <span class="nb">intros</span> CIH ks c0 c1 a b Ha Hb H1.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1, r2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eq·µ¢ i r1 r2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">RetF r1 = _observe a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">RetF r2 = _observe b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
  (<span class="nv">r</span> : k_rsp U (ks .[ i])),
d_get ks c0 i r ‚âà d_get ks c1 i r</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) 
  (i, ks) (_observe (Ret r1)) 
  (_observe (Ret r2))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ogsd-v-chk36" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1, m2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">upaco3 (eqit_ eq·µ¢ true true id) bot3 i m1 m2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF m1 = _observe a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF m2 = _observe b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
  (<span class="nv">r</span> : k_rsp U (ks .[ i])),
d_get ks c0 i r ‚âà d_get ks c1 i r</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="ogsd-v-chk36"><hr></label><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) 
  (i, ks)
  (_observe
     (Tau
        ((<span class="kr">cofix</span> _ogs_emb
            (i : I) (ks : list (kon U))
            (c : ogs_conf (itree U X) ks)
            (x : itree U X i) :
              itree (ogs U) (X ‚àò fst) (i, ks) :=
            <span class="kr">match</span> _observe x <span class="kr">with</span>
            | RetF x0 =&gt; Ret x0
            | TauF t =&gt; Tau (_ogs_emb i ks c t)
            | VisF e k =&gt;
                Vis e
                  (<span class="kr">fun</span>
                     <span class="nv">r</span> : 
                      {i0
                      : fin
                        (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                      k_rsp U
                        ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
                   =&gt;
                   _ogs_emb 
                     (k_nxt U (projT2 r))
                     (ks +‚ñ∂ u_rsp U e)%ctx
                     (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))
                     (uncurry2&#39;
                        (d_get 
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin (...))
                        (<span class="nv">b</span> : k_rsp U (...)) =&gt;
                        k (a,&amp; b)))) r))
            <span class="kr">end</span>) i ks c0 m1)))
  (_observe
     (Tau
        ((<span class="kr">cofix</span> _ogs_emb
            (i : I) (ks : list (kon U))
            (c : ogs_conf (itree U X) ks)
            (x : itree U X i) :
              itree (ogs U) (X ‚àò fst) (i, ks) :=
            <span class="kr">match</span> _observe x <span class="kr">with</span>
            | RetF x0 =&gt; Ret x0
            | TauF t =&gt; Tau (_ogs_emb i ks c t)
            | VisF e k =&gt;
                Vis e
                  (<span class="kr">fun</span>
                     <span class="nv">r</span> : 
                      {i0
                      : fin
                        (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                      k_rsp U
                        ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
                   =&gt;
                   _ogs_emb 
                     (k_nxt U (projT2 r))
                     (ks +‚ñ∂ u_rsp U e)%ctx
                     (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))
                     (uncurry2&#39;
                        (d_get 
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin (...))
                        (<span class="nv">b</span> : k_rsp U (...)) =&gt;
                        k (a,&amp; b)))) r))
            <span class="kr">end</span>) i ks c1 m2)))</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="ogsd-v-chk37" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry U i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k1, k2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : rsp U e, itree U X (nxt U e x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">v</span> : rsp U e,
id (upaco3 (eqit_ eq·µ¢ true true id) bot3)
  (nxt U e v) (k1 v) (k2 v)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VisF e k1 = _observe a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VisF e k2 = _observe b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
  (<span class="nv">r</span> : k_rsp U (ks .[ i])),
d_get ks c0 i r ‚âà d_get ks c1 i r</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="ogsd-v-chk37"><hr></label><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) 
  (i, ks)
  (_observe
     (Vis e
        (<span class="kr">fun</span>
           <span class="nv">r</span> : {i0
               : fin (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
               k_rsp U ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
         =&gt;
         (<span class="kr">cofix</span> _ogs_emb
            (i : I) (ks : list (kon U))
            (c : ogs_conf (itree U X) ks)
            (x : itree U X i) :
              itree (ogs U) (X ‚àò fst) (i, ks) :=
            <span class="kr">match</span> _observe x <span class="kr">with</span>
            | RetF x0 =&gt; Ret x0
            | TauF t =&gt; Tau (_ogs_emb i ks c t)
            | VisF e k =&gt;
                Vis e
                  (<span class="kr">fun</span>
                     <span class="nv">r0</span> : 
                      {i0
                      : fin
                        (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                      k_rsp U
                        ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
                   =&gt;
                   _ogs_emb 
                     (k_nxt U (projT2 r0))
                     (ks +‚ñ∂ u_rsp U e)%ctx
                     (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))
                     (uncurry2&#39;
                        (d_get 
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin ...)
                        (<span class="nv">b</span> : k_rsp U ...) =&gt; 
                        k (a,&amp; b)))) r0))
            <span class="kr">end</span>) (k_nxt U (projT2 r))
           (ks +‚ñ∂ u_rsp U e)%ctx
           (d_concat ks (u_rsp U e) c0
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
               k1 (a,&amp; b)))
           (uncurry2&#39;
              (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                 (d_concat ks 
                    (u_rsp U e) c0
                    (<span class="kr">fun</span>
                       (<span class="nv">a</span> : fin (length (u_rsp U e)))
                       (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                     k1 (a,&amp; b)))) r))))
  (_observe
     (Vis e
        (<span class="kr">fun</span>
           <span class="nv">r</span> : {i0
               : fin (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
               k_rsp U ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
         =&gt;
         (<span class="kr">cofix</span> _ogs_emb
            (i : I) (ks : list (kon U))
            (c : ogs_conf (itree U X) ks)
            (x : itree U X i) :
              itree (ogs U) (X ‚àò fst) (i, ks) :=
            <span class="kr">match</span> _observe x <span class="kr">with</span>
            | RetF x0 =&gt; Ret x0
            | TauF t =&gt; Tau (_ogs_emb i ks c t)
            | VisF e k =&gt;
                Vis e
                  (<span class="kr">fun</span>
                     <span class="nv">r0</span> : 
                      {i0
                      : fin
                        (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                      k_rsp U
                        ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
                   =&gt;
                   _ogs_emb 
                     (k_nxt U (projT2 r0))
                     (ks +‚ñ∂ u_rsp U e)%ctx
                     (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))
                     (uncurry2&#39;
                        (d_get 
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin ...)
                        (<span class="nv">b</span> : k_rsp U ...) =&gt; 
                        k (a,&amp; b)))) r0))
            <span class="kr">end</span>) (k_nxt U (projT2 r))
           (ks +‚ñ∂ u_rsp U e)%ctx
           (d_concat ks (u_rsp U e) c1
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
               k2 (a,&amp; b)))
           (uncurry2&#39;
              (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                 (d_concat ks 
                    (u_rsp U e) c1
                    (<span class="kr">fun</span>
                       (<span class="nv">a</span> : fin (length (u_rsp U e)))
                       (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                     k2 (a,&amp; b)))) r))))</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="ogsd-v-chk38" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ot2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree&#39; U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CHECK</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">is_true true</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) bot3) i
  (observe t1) ot2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHeqitF</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(<span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
   (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
   (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
 a ‚âà b -&gt;
 eutt_conf c0 c1 -&gt;
 r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)) -&gt;
<span class="kr">forall</span> (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
observe t1 = _observe a -&gt;
ot2 = _observe b -&gt;
(<span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
   (<span class="nv">r</span> : k_rsp U (ks .[ i])),
 d_get ks c0 i r ‚âà d_get ks c1 i r) -&gt;
eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r)
  (i, ks)
  (_observe
     <span class="kr">match</span> observe t1 <span class="kr">with</span>
     | RetF x =&gt; Ret x
     | TauF t =&gt;
         Tau
           ((<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks0 : list (kon U))
               (c : ogs_conf (itree U X) ks0)
               (x : itree U X i) :
                 itree (ogs U) 
                   (X ‚àò fst) 
                   (i, ks0) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t0 =&gt;
                   Tau (_ogs_emb i ks0 c t0)
               | VisF e k =&gt;
                   Vis e
                     (<span class="kr">fun</span>
                        <span class="nv">r</span> : 
                        {i0
                        : 
                        fin
                        (length (...)%ctx) &amp;
                        k_rsp U
                        ((...)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb
                        (k_nxt U (projT2 r))
                        (ks0 +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks0
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a0</span> : ...)
                        (<span class="nv">b0</span> : ...) =&gt;
                        k (...)))
                        (uncurry2&#39;
                        (d_get
                        (ks0 +‚ñ∂ ...)%ctx
                        (d_concat ks0 ... c
                        ...)) r))
               <span class="kr">end</span>) i ks c0 t)
     | VisF e k =&gt;
         Vis e
           (<span class="kr">fun</span>
              <span class="nv">r</span> : {i0
                  : fin
                      (length
                        (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                  k_rsp U
                    ((ks +‚ñ∂ u_rsp U e)%ctx
                     .[ i0])} =&gt;
            (<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks0 : list (kon U))
               (c : ogs_conf (itree U X) ks0)
               (x : itree U X i) :
                 itree (ogs U) 
                   (X ‚àò fst) 
                   (i, ks0) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t =&gt;
                   Tau (_ogs_emb i ks0 c t)
               | VisF e0 k0 =&gt;
                   Vis e0
                     (<span class="kr">fun</span>
                        <span class="nv">r0</span> : 
                        {i0
                        : 
                        fin 
                        (length ...%ctx) &amp;
                        k_rsp U
                        (...%ctx .[ i0])} =&gt;
                      _ogs_emb
                        (k_nxt U (projT2 r0))
                        (ks0 +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks0
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> ... ... =&gt;
                        k0 ...))
                        (uncurry2&#39;
                        (d_get 
                        (...)%ctx 
                        (...)) r0))
               <span class="kr">end</span>) (k_nxt U (projT2 r))
              (ks +‚ñ∂ u_rsp U e)%ctx
              (d_concat ks 
                 (u_rsp U e) c0
                 (<span class="kr">fun</span>
                    (<span class="nv">a0</span> : 
                     fin
                       (length (u_rsp U e)))
                    (<span class="nv">b0</span> : 
                     k_rsp U
                       ((u_rsp U e) .[ a0]))
                  =&gt; k (a0,&amp; b0)))
              (uncurry2&#39;
                 (d_get
                    (ks +‚ñ∂ u_rsp U e)%ctx
                    (d_concat ks 
                       (u_rsp U e) c0
                       (<span class="kr">fun</span>
                        (<span class="nv">a0</span> : 
                        fin 
                        (length ...))
                        (<span class="nv">b0</span> : 
                        k_rsp U 
                        (... .[ a0])) =&gt;
                        k (a0,&amp; b0)))) r))
     <span class="kr">end</span>)
  (_observe
     <span class="kr">match</span> ot2 <span class="kr">with</span>
     | RetF x =&gt; Ret x
     | TauF t =&gt;
         Tau
           ((<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks0 : list (kon U))
               (c : ogs_conf (itree U X) ks0)
               (x : itree U X i) :
                 itree (ogs U) 
                   (X ‚àò fst) 
                   (i, ks0) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t0 =&gt;
                   Tau (_ogs_emb i ks0 c t0)
               | VisF e k =&gt;
                   Vis e
                     (<span class="kr">fun</span>
                        <span class="nv">r</span> : 
                        {i0
                        : 
                        fin
                        (length (...)%ctx) &amp;
                        k_rsp U
                        ((...)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb
                        (k_nxt U (projT2 r))
                        (ks0 +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks0
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a0</span> : ...)
                        (<span class="nv">b0</span> : ...) =&gt;
                        k (...)))
                        (uncurry2&#39;
                        (d_get
                        (ks0 +‚ñ∂ ...)%ctx
                        (d_concat ks0 ... c
                        ...)) r))
               <span class="kr">end</span>) i ks c1 t)
     | VisF e k =&gt;
         Vis e
           (<span class="kr">fun</span>
              <span class="nv">r</span> : {i0
                  : fin
                      (length
                        (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                  k_rsp U
                    ((ks +‚ñ∂ u_rsp U e)%ctx
                     .[ i0])} =&gt;
            (<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks0 : list (kon U))
               (c : ogs_conf (itree U X) ks0)
               (x : itree U X i) :
                 itree (ogs U) 
                   (X ‚àò fst) 
                   (i, ks0) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t =&gt;
                   Tau (_ogs_emb i ks0 c t)
               | VisF e0 k0 =&gt;
                   Vis e0
                     (<span class="kr">fun</span>
                        <span class="nv">r0</span> : 
                        {i0
                        : 
                        fin 
                        (length ...%ctx) &amp;
                        k_rsp U
                        (...%ctx .[ i0])} =&gt;
                      _ogs_emb
                        (k_nxt U (projT2 r0))
                        (ks0 +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks0
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> ... ... =&gt;
                        k0 ...))
                        (uncurry2&#39;
                        (d_get 
                        (...)%ctx 
                        (...)) r0))
               <span class="kr">end</span>) (k_nxt U (projT2 r))
              (ks +‚ñ∂ u_rsp U e)%ctx
              (d_concat ks 
                 (u_rsp U e) c1
                 (<span class="kr">fun</span>
                    (<span class="nv">a0</span> : 
                     fin
                       (length (u_rsp U e)))
                    (<span class="nv">b0</span> : 
                     k_rsp U
                       ((u_rsp U e) .[ a0]))
                  =&gt; k (a0,&amp; b0)))
              (uncurry2&#39;
                 (d_get
                    (ks +‚ñ∂ u_rsp U e)%ctx
                    (d_concat ks 
                       (u_rsp U e) c1
                       (<span class="kr">fun</span>
                        (<span class="nv">a0</span> : 
                        fin 
                        (length ...))
                        (<span class="nv">b0</span> : 
                        k_rsp U 
                        (... .[ a0])) =&gt;
                        k (a0,&amp; b0)))) r))
     <span class="kr">end</span>)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF t1 = _observe a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ot2 = _observe b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
  (<span class="nv">r</span> : k_rsp U (ks .[ i])),
d_get ks c0 i r ‚âà d_get ks c1 i r</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="ogsd-v-chk38"><hr></label><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) 
  (i, ks)
  (_observe
     (Tau
        ((<span class="kr">cofix</span> _ogs_emb
            (i : I) (ks : list (kon U))
            (c : ogs_conf (itree U X) ks)
            (x : itree U X i) :
              itree (ogs U) (X ‚àò fst) (i, ks) :=
            <span class="kr">match</span> _observe x <span class="kr">with</span>
            | RetF x0 =&gt; Ret x0
            | TauF t =&gt; Tau (_ogs_emb i ks c t)
            | VisF e k =&gt;
                Vis e
                  (<span class="kr">fun</span>
                     <span class="nv">r</span> : 
                      {i0
                      : fin
                        (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                      k_rsp U
                        ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
                   =&gt;
                   _ogs_emb 
                     (k_nxt U (projT2 r))
                     (ks +‚ñ∂ u_rsp U e)%ctx
                     (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))
                     (uncurry2&#39;
                        (d_get 
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin (...))
                        (<span class="nv">b</span> : k_rsp U (...)) =&gt;
                        k (a,&amp; b)))) r))
            <span class="kr">end</span>) i ks c0 t1)))
  (_observe
     <span class="kr">match</span> ot2 <span class="kr">with</span>
     | RetF x =&gt; Ret x
     | TauF t =&gt;
         Tau
           ((<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks : list (kon U))
               (c : ogs_conf (itree U X) ks)
               (x : itree U X i) :
                 itree (ogs U) (X ‚àò fst) (i, ks) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t0 =&gt; Tau (_ogs_emb i ks c t0)
               | VisF e k =&gt;
                   Vis e
                     (<span class="kr">fun</span>
                        <span class="nv">r</span> : 
                        {i0
                        : 
                        fin
                        (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                        k_rsp U
                        ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb 
                        (k_nxt U (projT2 r))
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))
                        (uncurry2&#39;
                        (d_get 
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin ...)
                        (<span class="nv">b</span> : k_rsp U ...) =&gt; 
                        k (a,&amp; b)))) r))
               <span class="kr">end</span>) i ks c1 t)
     | VisF e k =&gt;
         Vis e
           (<span class="kr">fun</span>
              <span class="nv">r</span> : {i0
                  : fin (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                  k_rsp U
                    ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])} =&gt;
            (<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks : list (kon U))
               (c : ogs_conf (itree U X) ks)
               (x : itree U X i) :
                 itree (ogs U) (X ‚àò fst) (i, ks) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t =&gt; Tau (_ogs_emb i ks c t)
               | VisF e0 k0 =&gt;
                   Vis e0
                     (<span class="kr">fun</span>
                        <span class="nv">r0</span> : 
                        {i0
                        : 
                        fin
                        (length (ks +‚ñ∂ u_rsp U e0)%ctx) &amp;
                        k_rsp U
                        ((ks +‚ñ∂ u_rsp U e0)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb 
                        (k_nxt U (projT2 r0))
                        (ks +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks 
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin (length (...)))
                        (<span class="nv">b</span> : k_rsp U ((...) .[ a])) =&gt;
                        k0 (a,&amp; b)))
                        (uncurry2&#39;
                        (d_get 
                        (ks +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks 
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> (<span class="nv">a</span> : ...) (<span class="nv">b</span> : ...) =&gt;
                        k0 (...)))) r0))
               <span class="kr">end</span>) (k_nxt U (projT2 r))
              (ks +‚ñ∂ u_rsp U e)%ctx
              (d_concat ks 
                 (u_rsp U e) c1
                 (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                    (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
                  =&gt; k (a,&amp; b)))
              (uncurry2&#39;
                 (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                    (d_concat ks 
                       (u_rsp U e) c1
                       (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))) r))
     <span class="kr">end</span>)</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="ogsd-v-chk39" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ot1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree&#39; U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CHECK</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">is_true true</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) bot3) i ot1
  (observe t2)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHeqitF</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(<span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
   (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
   (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
 a ‚âà b -&gt;
 eutt_conf c0 c1 -&gt;
 r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)) -&gt;
<span class="kr">forall</span> (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ot1 = _observe a -&gt;
observe t2 = _observe b -&gt;
(<span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
   (<span class="nv">r</span> : k_rsp U (ks .[ i])),
 d_get ks c0 i r ‚âà d_get ks c1 i r) -&gt;
eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r)
  (i, ks)
  (_observe
     <span class="kr">match</span> ot1 <span class="kr">with</span>
     | RetF x =&gt; Ret x
     | TauF t =&gt;
         Tau
           ((<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks0 : list (kon U))
               (c : ogs_conf (itree U X) ks0)
               (x : itree U X i) :
                 itree (ogs U) 
                   (X ‚àò fst) 
                   (i, ks0) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t0 =&gt;
                   Tau (_ogs_emb i ks0 c t0)
               | VisF e k =&gt;
                   Vis e
                     (<span class="kr">fun</span>
                        <span class="nv">r</span> : 
                        {i0
                        : 
                        fin
                        (length (...)%ctx) &amp;
                        k_rsp U
                        ((...)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb
                        (k_nxt U (projT2 r))
                        (ks0 +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks0
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a0</span> : ...)
                        (<span class="nv">b0</span> : ...) =&gt;
                        k (...)))
                        (uncurry2&#39;
                        (d_get
                        (ks0 +‚ñ∂ ...)%ctx
                        (d_concat ks0 ... c
                        ...)) r))
               <span class="kr">end</span>) i ks c0 t)
     | VisF e k =&gt;
         Vis e
           (<span class="kr">fun</span>
              <span class="nv">r</span> : {i0
                  : fin
                      (length
                        (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                  k_rsp U
                    ((ks +‚ñ∂ u_rsp U e)%ctx
                     .[ i0])} =&gt;
            (<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks0 : list (kon U))
               (c : ogs_conf (itree U X) ks0)
               (x : itree U X i) :
                 itree (ogs U) 
                   (X ‚àò fst) 
                   (i, ks0) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t =&gt;
                   Tau (_ogs_emb i ks0 c t)
               | VisF e0 k0 =&gt;
                   Vis e0
                     (<span class="kr">fun</span>
                        <span class="nv">r0</span> : 
                        {i0
                        : 
                        fin 
                        (length ...%ctx) &amp;
                        k_rsp U
                        (...%ctx .[ i0])} =&gt;
                      _ogs_emb
                        (k_nxt U (projT2 r0))
                        (ks0 +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks0
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> ... ... =&gt;
                        k0 ...))
                        (uncurry2&#39;
                        (d_get 
                        (...)%ctx 
                        (...)) r0))
               <span class="kr">end</span>) (k_nxt U (projT2 r))
              (ks +‚ñ∂ u_rsp U e)%ctx
              (d_concat ks 
                 (u_rsp U e) c0
                 (<span class="kr">fun</span>
                    (<span class="nv">a0</span> : 
                     fin
                       (length (u_rsp U e)))
                    (<span class="nv">b0</span> : 
                     k_rsp U
                       ((u_rsp U e) .[ a0]))
                  =&gt; k (a0,&amp; b0)))
              (uncurry2&#39;
                 (d_get
                    (ks +‚ñ∂ u_rsp U e)%ctx
                    (d_concat ks 
                       (u_rsp U e) c0
                       (<span class="kr">fun</span>
                        (<span class="nv">a0</span> : 
                        fin 
                        (length ...))
                        (<span class="nv">b0</span> : 
                        k_rsp U 
                        (... .[ a0])) =&gt;
                        k (a0,&amp; b0)))) r))
     <span class="kr">end</span>)
  (_observe
     <span class="kr">match</span> observe t2 <span class="kr">with</span>
     | RetF x =&gt; Ret x
     | TauF t =&gt;
         Tau
           ((<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks0 : list (kon U))
               (c : ogs_conf (itree U X) ks0)
               (x : itree U X i) :
                 itree (ogs U) 
                   (X ‚àò fst) 
                   (i, ks0) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t0 =&gt;
                   Tau (_ogs_emb i ks0 c t0)
               | VisF e k =&gt;
                   Vis e
                     (<span class="kr">fun</span>
                        <span class="nv">r</span> : 
                        {i0
                        : 
                        fin
                        (length (...)%ctx) &amp;
                        k_rsp U
                        ((...)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb
                        (k_nxt U (projT2 r))
                        (ks0 +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks0
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a0</span> : ...)
                        (<span class="nv">b0</span> : ...) =&gt;
                        k (...)))
                        (uncurry2&#39;
                        (d_get
                        (ks0 +‚ñ∂ ...)%ctx
                        (d_concat ks0 ... c
                        ...)) r))
               <span class="kr">end</span>) i ks c1 t)
     | VisF e k =&gt;
         Vis e
           (<span class="kr">fun</span>
              <span class="nv">r</span> : {i0
                  : fin
                      (length
                        (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                  k_rsp U
                    ((ks +‚ñ∂ u_rsp U e)%ctx
                     .[ i0])} =&gt;
            (<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks0 : list (kon U))
               (c : ogs_conf (itree U X) ks0)
               (x : itree U X i) :
                 itree (ogs U) 
                   (X ‚àò fst) 
                   (i, ks0) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t =&gt;
                   Tau (_ogs_emb i ks0 c t)
               | VisF e0 k0 =&gt;
                   Vis e0
                     (<span class="kr">fun</span>
                        <span class="nv">r0</span> : 
                        {i0
                        : 
                        fin 
                        (length ...%ctx) &amp;
                        k_rsp U
                        (...%ctx .[ i0])} =&gt;
                      _ogs_emb
                        (k_nxt U (projT2 r0))
                        (ks0 +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks0
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> ... ... =&gt;
                        k0 ...))
                        (uncurry2&#39;
                        (d_get 
                        (...)%ctx 
                        (...)) r0))
               <span class="kr">end</span>) (k_nxt U (projT2 r))
              (ks +‚ñ∂ u_rsp U e)%ctx
              (d_concat ks 
                 (u_rsp U e) c1
                 (<span class="kr">fun</span>
                    (<span class="nv">a0</span> : 
                     fin
                       (length (u_rsp U e)))
                    (<span class="nv">b0</span> : 
                     k_rsp U
                       ((u_rsp U e) .[ a0]))
                  =&gt; k (a0,&amp; b0)))
              (uncurry2&#39;
                 (d_get
                    (ks +‚ñ∂ u_rsp U e)%ctx
                    (d_concat ks 
                       (u_rsp U e) c1
                       (<span class="kr">fun</span>
                        (<span class="nv">a0</span> : 
                        fin 
                        (length ...))
                        (<span class="nv">b0</span> : 
                        k_rsp U 
                        (... .[ a0])) =&gt;
                        k (a0,&amp; b0)))) r))
     <span class="kr">end</span>)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ot1 = _observe a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF t2 = _observe b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
  (<span class="nv">r</span> : k_rsp U (ks .[ i])),
d_get ks c0 i r ‚âà d_get ks c1 i r</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="ogsd-v-chk39"><hr></label><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) 
  (i, ks)
  (_observe
     <span class="kr">match</span> ot1 <span class="kr">with</span>
     | RetF x =&gt; Ret x
     | TauF t =&gt;
         Tau
           ((<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks : list (kon U))
               (c : ogs_conf (itree U X) ks)
               (x : itree U X i) :
                 itree (ogs U) (X ‚àò fst) (i, ks) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t0 =&gt; Tau (_ogs_emb i ks c t0)
               | VisF e k =&gt;
                   Vis e
                     (<span class="kr">fun</span>
                        <span class="nv">r</span> : 
                        {i0
                        : 
                        fin
                        (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                        k_rsp U
                        ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb 
                        (k_nxt U (projT2 r))
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))
                        (uncurry2&#39;
                        (d_get 
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin ...)
                        (<span class="nv">b</span> : k_rsp U ...) =&gt; 
                        k (a,&amp; b)))) r))
               <span class="kr">end</span>) i ks c0 t)
     | VisF e k =&gt;
         Vis e
           (<span class="kr">fun</span>
              <span class="nv">r</span> : {i0
                  : fin (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                  k_rsp U
                    ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])} =&gt;
            (<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks : list (kon U))
               (c : ogs_conf (itree U X) ks)
               (x : itree U X i) :
                 itree (ogs U) (X ‚àò fst) (i, ks) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t =&gt; Tau (_ogs_emb i ks c t)
               | VisF e0 k0 =&gt;
                   Vis e0
                     (<span class="kr">fun</span>
                        <span class="nv">r0</span> : 
                        {i0
                        : 
                        fin
                        (length (ks +‚ñ∂ u_rsp U e0)%ctx) &amp;
                        k_rsp U
                        ((ks +‚ñ∂ u_rsp U e0)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb 
                        (k_nxt U (projT2 r0))
                        (ks +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks 
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin (length (...)))
                        (<span class="nv">b</span> : k_rsp U ((...) .[ a])) =&gt;
                        k0 (a,&amp; b)))
                        (uncurry2&#39;
                        (d_get 
                        (ks +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks 
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> (<span class="nv">a</span> : ...) (<span class="nv">b</span> : ...) =&gt;
                        k0 (...)))) r0))
               <span class="kr">end</span>) (k_nxt U (projT2 r))
              (ks +‚ñ∂ u_rsp U e)%ctx
              (d_concat ks 
                 (u_rsp U e) c0
                 (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                    (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
                  =&gt; k (a,&amp; b)))
              (uncurry2&#39;
                 (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                    (d_concat ks 
                       (u_rsp U e) c0
                       (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))) r))
     <span class="kr">end</span>)
  (_observe
     (Tau
        ((<span class="kr">cofix</span> _ogs_emb
            (i : I) (ks : list (kon U))
            (c : ogs_conf (itree U X) ks)
            (x : itree U X i) :
              itree (ogs U) (X ‚àò fst) (i, ks) :=
            <span class="kr">match</span> _observe x <span class="kr">with</span>
            | RetF x0 =&gt; Ret x0
            | TauF t =&gt; Tau (_ogs_emb i ks c t)
            | VisF e k =&gt;
                Vis e
                  (<span class="kr">fun</span>
                     <span class="nv">r</span> : 
                      {i0
                      : fin
                        (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                      k_rsp U
                        ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
                   =&gt;
                   _ogs_emb 
                     (k_nxt U (projT2 r))
                     (ks +‚ñ∂ u_rsp U e)%ctx
                     (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))
                     (uncurry2&#39;
                        (d_get 
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin (...))
                        (<span class="nv">b</span> : k_rsp U (...)) =&gt;
                        k (a,&amp; b)))) r))
            <span class="kr">end</span>) i ks c1 t2)))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk3a" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk3a"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1, r2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eq·µ¢ i r1 r2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">RetF r1 = _observe a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">RetF r2 = _observe b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
  (<span class="nv">r</span> : k_rsp U (ks .[ i])),
d_get ks c0 i r ‚âà d_get ks c1 i r</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) 
  (i, ks) (_observe (Ret r1)) 
  (_observe (Ret r2))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">econstructor</span>; <span class="nb">eauto</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk3b" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk3b"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1, m2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">upaco3 (eqit_ eq·µ¢ true true id) bot3 i m1 m2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF m1 = _observe a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF m2 = _observe b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
  (<span class="nv">r</span> : k_rsp U (ks .[ i])),
d_get ks c0 i r ‚âà d_get ks c1 i r</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) 
  (i, ks)
  (_observe
     (Tau
        ((<span class="kr">cofix</span> _ogs_emb
            (i : I) (ks : list (kon U))
            (c : ogs_conf (itree U X) ks)
            (x : itree U X i) :
              itree (ogs U) (X ‚àò fst) (i, ks) :=
            <span class="kr">match</span> _observe x <span class="kr">with</span>
            | RetF x0 =&gt; Ret x0
            | TauF t =&gt; Tau (_ogs_emb i ks c t)
            | VisF e k =&gt;
                Vis e
                  (<span class="kr">fun</span>
                     <span class="nv">r</span> : 
                      {i0
                      : fin
                        (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                      k_rsp U
                        ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
                   =&gt;
                   _ogs_emb 
                     (k_nxt U (projT2 r))
                     (ks +‚ñ∂ u_rsp U e)%ctx
                     (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))
                     (uncurry2&#39;
                        (d_get 
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin (...))
                        (<span class="nv">b</span> : k_rsp U (...)) =&gt;
                        k (a,&amp; b)))) r))
            <span class="kr">end</span>) i ks c0 m1)))
  (_observe
     (Tau
        ((<span class="kr">cofix</span> _ogs_emb
            (i : I) (ks : list (kon U))
            (c : ogs_conf (itree U X) ks)
            (x : itree U X i) :
              itree (ogs U) (X ‚àò fst) (i, ks) :=
            <span class="kr">match</span> _observe x <span class="kr">with</span>
            | RetF x0 =&gt; Ret x0
            | TauF t =&gt; Tau (_ogs_emb i ks c t)
            | VisF e k =&gt;
                Vis e
                  (<span class="kr">fun</span>
                     <span class="nv">r</span> : 
                      {i0
                      : fin
                        (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                      k_rsp U
                        ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
                   =&gt;
                   _ogs_emb 
                     (k_nxt U (projT2 r))
                     (ks +‚ñ∂ u_rsp U e)%ctx
                     (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))
                     (uncurry2&#39;
                        (d_get 
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin (...))
                        (<span class="nv">b</span> : k_rsp U (...)) =&gt;
                        k (a,&amp; b)))) r))
            <span class="kr">end</span>) i ks c1 m2)))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk3c" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk3c"><span class="highlight"><span class="nb">econstructor</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1, m2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">upaco3 (eqit_ eq·µ¢ true true id) bot3 i m1 m2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF m1 = _observe a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF m2 = _observe b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
  (<span class="nv">r</span> : k_rsp U (ks .[ i])),
d_get ks c0 i r ‚âà d_get ks c1 i r</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">upaco3 (eqit_ eq·µ¢ true true id) r 
  (i, ks)
  ((<span class="kr">cofix</span> _ogs_emb
      (i : I) (ks : list (kon U))
      (c : ogs_conf (itree U X) ks) 
      (x : itree U X i) :
        itree (ogs U) (X ‚àò fst) (i, ks) :=
      <span class="kr">match</span> _observe x <span class="kr">with</span>
      | RetF x0 =&gt; Ret x0
      | TauF t =&gt; Tau (_ogs_emb i ks c t)
      | VisF e k =&gt;
          Vis e
            (<span class="kr">fun</span>
               <span class="nv">r</span> : {i0
                   : fin
                       (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                   k_rsp U
                     ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
             =&gt;
             _ogs_emb (k_nxt U (projT2 r))
               (ks +‚ñ∂ u_rsp U e)%ctx
               (d_concat ks 
                  (u_rsp U e) c
                  (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                     (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
                   =&gt; k (a,&amp; b)))
               (uncurry2&#39;
                  (d_get 
                     (ks +‚ñ∂ u_rsp U e)%ctx
                     (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))) r))
      <span class="kr">end</span>) i ks c0 m1)
  ((<span class="kr">cofix</span> _ogs_emb
      (i : I) (ks : list (kon U))
      (c : ogs_conf (itree U X) ks) 
      (x : itree U X i) :
        itree (ogs U) (X ‚àò fst) (i, ks) :=
      <span class="kr">match</span> _observe x <span class="kr">with</span>
      | RetF x0 =&gt; Ret x0
      | TauF t =&gt; Tau (_ogs_emb i ks c t)
      | VisF e k =&gt;
          Vis e
            (<span class="kr">fun</span>
               <span class="nv">r</span> : {i0
                   : fin
                       (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                   k_rsp U
                     ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
             =&gt;
             _ogs_emb (k_nxt U (projT2 r))
               (ks +‚ñ∂ u_rsp U e)%ctx
               (d_concat ks 
                  (u_rsp U e) c
                  (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                     (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
                   =&gt; k (a,&amp; b)))
               (uncurry2&#39;
                  (d_get 
                     (ks +‚ñ∂ u_rsp U e)%ctx
                     (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))) r))
      <span class="kr">end</span>) i ks c1 m2)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk3d" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk3d"><span class="highlight"><span class="nb">right</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1, m2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">upaco3 (eqit_ eq·µ¢ true true id) bot3 i m1 m2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF m1 = _observe a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF m2 = _observe b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
  (<span class="nv">r</span> : k_rsp U (ks .[ i])),
d_get ks c0 i r ‚âà d_get ks c1 i r</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">r (i, ks)
  ((<span class="kr">cofix</span> _ogs_emb
      (i : I) (ks : list (kon U))
      (c : ogs_conf (itree U X) ks) 
      (x : itree U X i) :
        itree (ogs U) (X ‚àò fst) (i, ks) :=
      <span class="kr">match</span> _observe x <span class="kr">with</span>
      | RetF x0 =&gt; Ret x0
      | TauF t =&gt; Tau (_ogs_emb i ks c t)
      | VisF e k =&gt;
          Vis e
            (<span class="kr">fun</span>
               <span class="nv">r</span> : {i0
                   : fin
                       (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                   k_rsp U
                     ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
             =&gt;
             _ogs_emb (k_nxt U (projT2 r))
               (ks +‚ñ∂ u_rsp U e)%ctx
               (d_concat ks 
                  (u_rsp U e) c
                  (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                     (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
                   =&gt; k (a,&amp; b)))
               (uncurry2&#39;
                  (d_get 
                     (ks +‚ñ∂ u_rsp U e)%ctx
                     (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))) r))
      <span class="kr">end</span>) i ks c0 m1)
  ((<span class="kr">cofix</span> _ogs_emb
      (i : I) (ks : list (kon U))
      (c : ogs_conf (itree U X) ks) 
      (x : itree U X i) :
        itree (ogs U) (X ‚àò fst) (i, ks) :=
      <span class="kr">match</span> _observe x <span class="kr">with</span>
      | RetF x0 =&gt; Ret x0
      | TauF t =&gt; Tau (_ogs_emb i ks c t)
      | VisF e k =&gt;
          Vis e
            (<span class="kr">fun</span>
               <span class="nv">r</span> : {i0
                   : fin
                       (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                   k_rsp U
                     ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
             =&gt;
             _ogs_emb (k_nxt U (projT2 r))
               (ks +‚ñ∂ u_rsp U e)%ctx
               (d_concat ks 
                  (u_rsp U e) c
                  (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                     (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
                   =&gt; k (a,&amp; b)))
               (uncurry2&#39;
                  (d_get 
                     (ks +‚ñ∂ u_rsp U e)%ctx
                     (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))) r))
      <span class="kr">end</span>) i ks c1 m2)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk3e" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk3e"><span class="highlight"><span class="nb">destruct</span> (_observe a); <span class="kp">try</span> <span class="bp">discriminate</span> Ha.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1, m2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">upaco3 (eqit_ eq·µ¢ true true id) bot3 i m1 m2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b, t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF m1 = TauF t</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF m2 = _observe b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
  (<span class="nv">r</span> : k_rsp U (ks .[ i])),
d_get ks c0 i r ‚âà d_get ks c1 i r</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">r (i, ks)
  ((<span class="kr">cofix</span> _ogs_emb
      (i : I) (ks : list (kon U))
      (c : ogs_conf (itree U X) ks) 
      (x : itree U X i) :
        itree (ogs U) (X ‚àò fst) (i, ks) :=
      <span class="kr">match</span> _observe x <span class="kr">with</span>
      | RetF x0 =&gt; Ret x0
      | TauF t =&gt; Tau (_ogs_emb i ks c t)
      | VisF e k =&gt;
          Vis e
            (<span class="kr">fun</span>
               <span class="nv">r</span> : {i0
                   : fin
                       (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                   k_rsp U
                     ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
             =&gt;
             _ogs_emb (k_nxt U (projT2 r))
               (ks +‚ñ∂ u_rsp U e)%ctx
               (d_concat ks 
                  (u_rsp U e) c
                  (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                     (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
                   =&gt; k (a,&amp; b)))
               (uncurry2&#39;
                  (d_get 
                     (ks +‚ñ∂ u_rsp U e)%ctx
                     (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))) r))
      <span class="kr">end</span>) i ks c0 m1)
  ((<span class="kr">cofix</span> _ogs_emb
      (i : I) (ks : list (kon U))
      (c : ogs_conf (itree U X) ks) 
      (x : itree U X i) :
        itree (ogs U) (X ‚àò fst) (i, ks) :=
      <span class="kr">match</span> _observe x <span class="kr">with</span>
      | RetF x0 =&gt; Ret x0
      | TauF t =&gt; Tau (_ogs_emb i ks c t)
      | VisF e k =&gt;
          Vis e
            (<span class="kr">fun</span>
               <span class="nv">r</span> : {i0
                   : fin
                       (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                   k_rsp U
                     ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
             =&gt;
             _ogs_emb (k_nxt U (projT2 r))
               (ks +‚ñ∂ u_rsp U e)%ctx
               (d_concat ks 
                  (u_rsp U e) c
                  (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                     (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
                   =&gt; k (a,&amp; b)))
               (uncurry2&#39;
                  (d_get 
                     (ks +‚ñ∂ u_rsp U e)%ctx
                     (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))) r))
      <span class="kr">end</span>) i ks c1 m2)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk3f" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk3f"><span class="highlight"><span class="nb">destruct</span> (_observe b); <span class="kp">try</span> <span class="bp">discriminate</span> Hb.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1, m2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">upaco3 (eqit_ eq·µ¢ true true id) bot3 i m1 m2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b, t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF m1 = TauF t</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF m2 = TauF t0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
  (<span class="nv">r</span> : k_rsp U (ks .[ i])),
d_get ks c0 i r ‚âà d_get ks c1 i r</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">r (i, ks)
  ((<span class="kr">cofix</span> _ogs_emb
      (i : I) (ks : list (kon U))
      (c : ogs_conf (itree U X) ks) 
      (x : itree U X i) :
        itree (ogs U) (X ‚àò fst) (i, ks) :=
      <span class="kr">match</span> _observe x <span class="kr">with</span>
      | RetF x0 =&gt; Ret x0
      | TauF t =&gt; Tau (_ogs_emb i ks c t)
      | VisF e k =&gt;
          Vis e
            (<span class="kr">fun</span>
               <span class="nv">r</span> : {i0
                   : fin
                       (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                   k_rsp U
                     ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
             =&gt;
             _ogs_emb (k_nxt U (projT2 r))
               (ks +‚ñ∂ u_rsp U e)%ctx
               (d_concat ks 
                  (u_rsp U e) c
                  (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                     (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
                   =&gt; k (a,&amp; b)))
               (uncurry2&#39;
                  (d_get 
                     (ks +‚ñ∂ u_rsp U e)%ctx
                     (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))) r))
      <span class="kr">end</span>) i ks c0 m1)
  ((<span class="kr">cofix</span> _ogs_emb
      (i : I) (ks : list (kon U))
      (c : ogs_conf (itree U X) ks) 
      (x : itree U X i) :
        itree (ogs U) (X ‚àò fst) (i, ks) :=
      <span class="kr">match</span> _observe x <span class="kr">with</span>
      | RetF x0 =&gt; Ret x0
      | TauF t =&gt; Tau (_ogs_emb i ks c t)
      | VisF e k =&gt;
          Vis e
            (<span class="kr">fun</span>
               <span class="nv">r</span> : {i0
                   : fin
                       (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                   k_rsp U
                     ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
             =&gt;
             _ogs_emb (k_nxt U (projT2 r))
               (ks +‚ñ∂ u_rsp U e)%ctx
               (d_concat ks 
                  (u_rsp U e) c
                  (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                     (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
                   =&gt; k (a,&amp; b)))
               (uncurry2&#39;
                  (d_get 
                     (ks +‚ñ∂ u_rsp U e)%ctx
                     (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))) r))
      <span class="kr">end</span>) i ks c1 m2)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk40" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk40"><span class="highlight"><span class="nb">enough</span> (Hcut : _) <span class="bp">by</span> <span class="nb">apply</span> (CIH i ks c0 c1 m1 m2 Hcut H1).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1, m2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">upaco3 (eqit_ eq·µ¢ true true id) bot3 i m1 m2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b, t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF m1 = TauF t</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF m2 = TauF t0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
  (<span class="nv">r</span> : k_rsp U (ks .[ i])),
d_get ks c0 i r ‚âà d_get ks c1 i r</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">m1 ‚âà m2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">destruct</span> REL; [<span class="nb">eauto</span> | <span class="nb">destruct</span> H ].</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk41" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk41"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry U i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k1, k2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : rsp U e, itree U X (nxt U e x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">v</span> : rsp U e,
id (upaco3 (eqit_ eq·µ¢ true true id) bot3)
  (nxt U e v) (k1 v) (k2 v)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VisF e k1 = _observe a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VisF e k2 = _observe b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
  (<span class="nv">r</span> : k_rsp U (ks .[ i])),
d_get ks c0 i r ‚âà d_get ks c1 i r</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) 
  (i, ks)
  (_observe
     (Vis e
        (<span class="kr">fun</span>
           <span class="nv">r</span> : {i0
               : fin (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
               k_rsp U ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
         =&gt;
         (<span class="kr">cofix</span> _ogs_emb
            (i : I) (ks : list (kon U))
            (c : ogs_conf (itree U X) ks)
            (x : itree U X i) :
              itree (ogs U) (X ‚àò fst) (i, ks) :=
            <span class="kr">match</span> _observe x <span class="kr">with</span>
            | RetF x0 =&gt; Ret x0
            | TauF t =&gt; Tau (_ogs_emb i ks c t)
            | VisF e k =&gt;
                Vis e
                  (<span class="kr">fun</span>
                     <span class="nv">r0</span> : 
                      {i0
                      : fin
                        (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                      k_rsp U
                        ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
                   =&gt;
                   _ogs_emb 
                     (k_nxt U (projT2 r0))
                     (ks +‚ñ∂ u_rsp U e)%ctx
                     (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))
                     (uncurry2&#39;
                        (d_get 
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin ...)
                        (<span class="nv">b</span> : k_rsp U ...) =&gt; 
                        k (a,&amp; b)))) r0))
            <span class="kr">end</span>) (k_nxt U (projT2 r))
           (ks +‚ñ∂ u_rsp U e)%ctx
           (d_concat ks (u_rsp U e) c0
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
               k1 (a,&amp; b)))
           (uncurry2&#39;
              (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                 (d_concat ks 
                    (u_rsp U e) c0
                    (<span class="kr">fun</span>
                       (<span class="nv">a</span> : fin (length (u_rsp U e)))
                       (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                     k1 (a,&amp; b)))) r))))
  (_observe
     (Vis e
        (<span class="kr">fun</span>
           <span class="nv">r</span> : {i0
               : fin (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
               k_rsp U ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
         =&gt;
         (<span class="kr">cofix</span> _ogs_emb
            (i : I) (ks : list (kon U))
            (c : ogs_conf (itree U X) ks)
            (x : itree U X i) :
              itree (ogs U) (X ‚àò fst) (i, ks) :=
            <span class="kr">match</span> _observe x <span class="kr">with</span>
            | RetF x0 =&gt; Ret x0
            | TauF t =&gt; Tau (_ogs_emb i ks c t)
            | VisF e k =&gt;
                Vis e
                  (<span class="kr">fun</span>
                     <span class="nv">r0</span> : 
                      {i0
                      : fin
                        (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                      k_rsp U
                        ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
                   =&gt;
                   _ogs_emb 
                     (k_nxt U (projT2 r0))
                     (ks +‚ñ∂ u_rsp U e)%ctx
                     (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))
                     (uncurry2&#39;
                        (d_get 
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin ...)
                        (<span class="nv">b</span> : k_rsp U ...) =&gt; 
                        k (a,&amp; b)))) r0))
            <span class="kr">end</span>) (k_nxt U (projT2 r))
           (ks +‚ñ∂ u_rsp U e)%ctx
           (d_concat ks (u_rsp U e) c1
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
               k2 (a,&amp; b)))
           (uncurry2&#39;
              (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                 (d_concat ks 
                    (u_rsp U e) c1
                    (<span class="kr">fun</span>
                       (<span class="nv">a</span> : fin (length (u_rsp U e)))
                       (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                     k2 (a,&amp; b)))) r))))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk42" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk42"><span class="highlight"><span class="nb">econstructor</span>; <span class="nb">intros</span> [ci cr]; <span class="nb">right</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry U i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k1, k2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : rsp U e, itree U X (nxt U e x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">v</span> : rsp U e,
id (upaco3 (eqit_ eq·µ¢ true true id) bot3)
  (nxt U e v) (k1 v) (k2 v)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VisF e k1 = _observe a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VisF e k2 = _observe b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
  (<span class="nv">r</span> : k_rsp U (ks .[ i])),
d_get ks c0 i r ‚âà d_get ks c1 i r</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ci</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">fin (length (ks +‚ñ∂ u_rsp U e)%ctx)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cr</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k_rsp U ((ks +‚ñ∂ u_rsp U e)%ctx .[ ci])</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">r (nxt (ogs U) e (ci,&amp; cr))
  ((<span class="kr">cofix</span> _ogs_emb
      (i : I) (ks : list (kon U))
      (c : ogs_conf (itree U X) ks) 
      (x : itree U X i) :
        itree (ogs U) (X ‚àò fst) (i, ks) :=
      <span class="kr">match</span> _observe x <span class="kr">with</span>
      | RetF x0 =&gt; Ret x0
      | TauF t =&gt; Tau (_ogs_emb i ks c t)
      | VisF e k =&gt;
          Vis e
            (<span class="kr">fun</span>
               <span class="nv">r</span> : {i0
                   : fin
                       (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                   k_rsp U
                     ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
             =&gt;
             _ogs_emb (k_nxt U (projT2 r))
               (ks +‚ñ∂ u_rsp U e)%ctx
               (d_concat ks 
                  (u_rsp U e) c
                  (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                     (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
                   =&gt; k (a,&amp; b)))
               (uncurry2&#39;
                  (d_get 
                     (ks +‚ñ∂ u_rsp U e)%ctx
                     (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))) r))
      <span class="kr">end</span>) (k_nxt U (projT2 (ci,&amp; cr)))
     (ks +‚ñ∂ u_rsp U e)%ctx
     (d_concat ks (u_rsp U e) c0
        (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
           (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
         k1 (a,&amp; b)))
     (uncurry2&#39;
        (d_get (ks +‚ñ∂ u_rsp U e)%ctx
           (d_concat ks (u_rsp U e) c0
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
               k1 (a,&amp; b)))) 
        (ci,&amp; cr)))
  ((<span class="kr">cofix</span> _ogs_emb
      (i : I) (ks : list (kon U))
      (c : ogs_conf (itree U X) ks) 
      (x : itree U X i) :
        itree (ogs U) (X ‚àò fst) (i, ks) :=
      <span class="kr">match</span> _observe x <span class="kr">with</span>
      | RetF x0 =&gt; Ret x0
      | TauF t =&gt; Tau (_ogs_emb i ks c t)
      | VisF e k =&gt;
          Vis e
            (<span class="kr">fun</span>
               <span class="nv">r</span> : {i0
                   : fin
                       (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                   k_rsp U
                     ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
             =&gt;
             _ogs_emb (k_nxt U (projT2 r))
               (ks +‚ñ∂ u_rsp U e)%ctx
               (d_concat ks 
                  (u_rsp U e) c
                  (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                     (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
                   =&gt; k (a,&amp; b)))
               (uncurry2&#39;
                  (d_get 
                     (ks +‚ñ∂ u_rsp U e)%ctx
                     (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))) r))
      <span class="kr">end</span>) (k_nxt U (projT2 (ci,&amp; cr)))
     (ks +‚ñ∂ u_rsp U e)%ctx
     (d_concat ks (u_rsp U e) c1
        (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
           (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
         k2 (a,&amp; b)))
     (uncurry2&#39;
        (d_get (ks +‚ñ∂ u_rsp U e)%ctx
           (d_concat ks (u_rsp U e) c1
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
               k2 (a,&amp; b)))) 
        (ci,&amp; cr)))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk43" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk43"><span class="highlight"><span class="nb">destruct</span> (_observe a); <span class="kp">try</span> <span class="bp">discriminate</span> Ha.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry U i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k1, k2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : rsp U e, itree U X (nxt U e x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">v</span> : rsp U e,
id (upaco3 (eqit_ eq·µ¢ true true id) bot3)
  (nxt U e v) (k1 v) (k2 v)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry U i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : rsp U e0, itree U X (nxt U e0 r)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VisF e k1 = VisF e0 k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VisF e k2 = _observe b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
  (<span class="nv">r</span> : k_rsp U (ks .[ i])),
d_get ks c0 i r ‚âà d_get ks c1 i r</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ci</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">fin (length (ks +‚ñ∂ u_rsp U e)%ctx)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cr</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k_rsp U ((ks +‚ñ∂ u_rsp U e)%ctx .[ ci])</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">r (nxt (ogs U) e (ci,&amp; cr))
  ((<span class="kr">cofix</span> _ogs_emb
      (i : I) (ks : list (kon U))
      (c : ogs_conf (itree U X) ks) 
      (x : itree U X i) :
        itree (ogs U) (X ‚àò fst) (i, ks) :=
      <span class="kr">match</span> _observe x <span class="kr">with</span>
      | RetF x0 =&gt; Ret x0
      | TauF t =&gt; Tau (_ogs_emb i ks c t)
      | VisF e k =&gt;
          Vis e
            (<span class="kr">fun</span>
               <span class="nv">r</span> : {i0
                   : fin
                       (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                   k_rsp U
                     ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
             =&gt;
             _ogs_emb (k_nxt U (projT2 r))
               (ks +‚ñ∂ u_rsp U e)%ctx
               (d_concat ks 
                  (u_rsp U e) c
                  (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                     (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
                   =&gt; k (a,&amp; b)))
               (uncurry2&#39;
                  (d_get 
                     (ks +‚ñ∂ u_rsp U e)%ctx
                     (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))) r))
      <span class="kr">end</span>) (k_nxt U (projT2 (ci,&amp; cr)))
     (ks +‚ñ∂ u_rsp U e)%ctx
     (d_concat ks (u_rsp U e) c0
        (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
           (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
         k1 (a,&amp; b)))
     (uncurry2&#39;
        (d_get (ks +‚ñ∂ u_rsp U e)%ctx
           (d_concat ks (u_rsp U e) c0
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
               k1 (a,&amp; b)))) 
        (ci,&amp; cr)))
  ((<span class="kr">cofix</span> _ogs_emb
      (i : I) (ks : list (kon U))
      (c : ogs_conf (itree U X) ks) 
      (x : itree U X i) :
        itree (ogs U) (X ‚àò fst) (i, ks) :=
      <span class="kr">match</span> _observe x <span class="kr">with</span>
      | RetF x0 =&gt; Ret x0
      | TauF t =&gt; Tau (_ogs_emb i ks c t)
      | VisF e k =&gt;
          Vis e
            (<span class="kr">fun</span>
               <span class="nv">r</span> : {i0
                   : fin
                       (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                   k_rsp U
                     ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
             =&gt;
             _ogs_emb (k_nxt U (projT2 r))
               (ks +‚ñ∂ u_rsp U e)%ctx
               (d_concat ks 
                  (u_rsp U e) c
                  (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                     (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
                   =&gt; k (a,&amp; b)))
               (uncurry2&#39;
                  (d_get 
                     (ks +‚ñ∂ u_rsp U e)%ctx
                     (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))) r))
      <span class="kr">end</span>) (k_nxt U (projT2 (ci,&amp; cr)))
     (ks +‚ñ∂ u_rsp U e)%ctx
     (d_concat ks (u_rsp U e) c1
        (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
           (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
         k2 (a,&amp; b)))
     (uncurry2&#39;
        (d_get (ks +‚ñ∂ u_rsp U e)%ctx
           (d_concat ks (u_rsp U e) c1
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
               k2 (a,&amp; b)))) 
        (ci,&amp; cr)))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk44" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk44"><span class="highlight"><span class="nb">destruct</span> (_observe b); <span class="kp">try</span> <span class="bp">discriminate</span> Hb.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry U i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k1, k2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : rsp U e, itree U X (nxt U e x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">v</span> : rsp U e,
id (upaco3 (eqit_ eq·µ¢ true true id) bot3)
  (nxt U e v) (k1 v) (k2 v)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry U i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : rsp U e0, itree U X (nxt U e0 r)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VisF e k1 = VisF e0 k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry U i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : rsp U e1, itree U X (nxt U e1 r)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VisF e k2 = VisF e1 k0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
  (<span class="nv">r</span> : k_rsp U (ks .[ i])),
d_get ks c0 i r ‚âà d_get ks c1 i r</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ci</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">fin (length (ks +‚ñ∂ u_rsp U e)%ctx)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cr</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k_rsp U ((ks +‚ñ∂ u_rsp U e)%ctx .[ ci])</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">r (nxt (ogs U) e (ci,&amp; cr))
  ((<span class="kr">cofix</span> _ogs_emb
      (i : I) (ks : list (kon U))
      (c : ogs_conf (itree U X) ks) 
      (x : itree U X i) :
        itree (ogs U) (X ‚àò fst) (i, ks) :=
      <span class="kr">match</span> _observe x <span class="kr">with</span>
      | RetF x0 =&gt; Ret x0
      | TauF t =&gt; Tau (_ogs_emb i ks c t)
      | VisF e k =&gt;
          Vis e
            (<span class="kr">fun</span>
               <span class="nv">r</span> : {i0
                   : fin
                       (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                   k_rsp U
                     ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
             =&gt;
             _ogs_emb (k_nxt U (projT2 r))
               (ks +‚ñ∂ u_rsp U e)%ctx
               (d_concat ks 
                  (u_rsp U e) c
                  (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                     (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
                   =&gt; k (a,&amp; b)))
               (uncurry2&#39;
                  (d_get 
                     (ks +‚ñ∂ u_rsp U e)%ctx
                     (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))) r))
      <span class="kr">end</span>) (k_nxt U (projT2 (ci,&amp; cr)))
     (ks +‚ñ∂ u_rsp U e)%ctx
     (d_concat ks (u_rsp U e) c0
        (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
           (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
         k1 (a,&amp; b)))
     (uncurry2&#39;
        (d_get (ks +‚ñ∂ u_rsp U e)%ctx
           (d_concat ks (u_rsp U e) c0
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
               k1 (a,&amp; b)))) 
        (ci,&amp; cr)))
  ((<span class="kr">cofix</span> _ogs_emb
      (i : I) (ks : list (kon U))
      (c : ogs_conf (itree U X) ks) 
      (x : itree U X i) :
        itree (ogs U) (X ‚àò fst) (i, ks) :=
      <span class="kr">match</span> _observe x <span class="kr">with</span>
      | RetF x0 =&gt; Ret x0
      | TauF t =&gt; Tau (_ogs_emb i ks c t)
      | VisF e k =&gt;
          Vis e
            (<span class="kr">fun</span>
               <span class="nv">r</span> : {i0
                   : fin
                       (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                   k_rsp U
                     ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
             =&gt;
             _ogs_emb (k_nxt U (projT2 r))
               (ks +‚ñ∂ u_rsp U e)%ctx
               (d_concat ks 
                  (u_rsp U e) c
                  (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                     (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
                   =&gt; k (a,&amp; b)))
               (uncurry2&#39;
                  (d_get 
                     (ks +‚ñ∂ u_rsp U e)%ctx
                     (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))) r))
      <span class="kr">end</span>) (k_nxt U (projT2 (ci,&amp; cr)))
     (ks +‚ñ∂ u_rsp U e)%ctx
     (d_concat ks (u_rsp U e) c1
        (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
           (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
         k2 (a,&amp; b)))
     (uncurry2&#39;
        (d_get (ks +‚ñ∂ u_rsp U e)%ctx
           (d_concat ks (u_rsp U e) c1
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
               k2 (a,&amp; b)))) 
        (ci,&amp; cr)))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk45" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk45"><span class="highlight"><span class="nb">pose</span> (c0&#39; :=  (d_concat ks (u_rsp U e) c0 (<span class="kr">fun</span> <span class="nv">a0</span> <span class="nv">b0</span> =&gt; k1 (a0,&amp; b0)))).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry U i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k1, k2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : rsp U e, itree U X (nxt U e x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">v</span> : rsp U e,
id (upaco3 (eqit_ eq·µ¢ true true id) bot3)
  (nxt U e v) (k1 v) (k2 v)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry U i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : rsp U e0, itree U X (nxt U e0 r)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VisF e k1 = VisF e0 k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry U i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : rsp U e1, itree U X (nxt U e1 r)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VisF e k2 = VisF e1 k0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
  (<span class="nv">r</span> : k_rsp U (ks .[ i])),
d_get ks c0 i r ‚âà d_get ks c1 i r</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ci</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">fin (length (ks +‚ñ∂ u_rsp U e)%ctx)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cr</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k_rsp U ((ks +‚ñ∂ u_rsp U e)%ctx .[ ci])</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">d_concat ks (u_rsp U e) c0
  (<span class="kr">fun</span> (<span class="nv">a0</span> : fin (length (u_rsp U e)))
     (<span class="nv">b0</span> : k_rsp U ((u_rsp U e) .[ a0])) =&gt;
   k1 (a0,&amp; b0))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">dvec
  (<span class="kr">fun</span> <span class="nv">k</span> : kon U =&gt;
   <span class="kr">forall</span> <span class="nv">r</span> : k_rsp U k, itree U X (k_nxt U r))
  (ks +‚ñ∂ u_rsp U e)%ctx</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">r (nxt (ogs U) e (ci,&amp; cr))
  ((<span class="kr">cofix</span> _ogs_emb
      (i : I) (ks : list (kon U))
      (c : ogs_conf (itree U X) ks) 
      (x : itree U X i) :
        itree (ogs U) (X ‚àò fst) (i, ks) :=
      <span class="kr">match</span> _observe x <span class="kr">with</span>
      | RetF x0 =&gt; Ret x0
      | TauF t =&gt; Tau (_ogs_emb i ks c t)
      | VisF e k =&gt;
          Vis e
            (<span class="kr">fun</span>
               <span class="nv">r</span> : {i0
                   : fin
                       (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                   k_rsp U
                     ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
             =&gt;
             _ogs_emb (k_nxt U (projT2 r))
               (ks +‚ñ∂ u_rsp U e)%ctx
               (d_concat ks 
                  (u_rsp U e) c
                  (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                     (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
                   =&gt; k (a,&amp; b)))
               (uncurry2&#39;
                  (d_get 
                     (ks +‚ñ∂ u_rsp U e)%ctx
                     (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))) r))
      <span class="kr">end</span>) (k_nxt U (projT2 (ci,&amp; cr)))
     (ks +‚ñ∂ u_rsp U e)%ctx
     (d_concat ks (u_rsp U e) c0
        (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
           (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
         k1 (a,&amp; b)))
     (uncurry2&#39;
        (d_get (ks +‚ñ∂ u_rsp U e)%ctx
           (d_concat ks (u_rsp U e) c0
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
               k1 (a,&amp; b)))) 
        (ci,&amp; cr)))
  ((<span class="kr">cofix</span> _ogs_emb
      (i : I) (ks : list (kon U))
      (c : ogs_conf (itree U X) ks) 
      (x : itree U X i) :
        itree (ogs U) (X ‚àò fst) (i, ks) :=
      <span class="kr">match</span> _observe x <span class="kr">with</span>
      | RetF x0 =&gt; Ret x0
      | TauF t =&gt; Tau (_ogs_emb i ks c t)
      | VisF e k =&gt;
          Vis e
            (<span class="kr">fun</span>
               <span class="nv">r</span> : {i0
                   : fin
                       (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                   k_rsp U
                     ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
             =&gt;
             _ogs_emb (k_nxt U (projT2 r))
               (ks +‚ñ∂ u_rsp U e)%ctx
               (d_concat ks 
                  (u_rsp U e) c
                  (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                     (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
                   =&gt; k (a,&amp; b)))
               (uncurry2&#39;
                  (d_get 
                     (ks +‚ñ∂ u_rsp U e)%ctx
                     (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))) r))
      <span class="kr">end</span>) (k_nxt U (projT2 (ci,&amp; cr)))
     (ks +‚ñ∂ u_rsp U e)%ctx
     (d_concat ks (u_rsp U e) c1
        (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
           (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
         k2 (a,&amp; b)))
     (uncurry2&#39;
        (d_get (ks +‚ñ∂ u_rsp U e)%ctx
           (d_concat ks (u_rsp U e) c1
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
               k2 (a,&amp; b)))) 
        (ci,&amp; cr)))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk46" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk46"><span class="highlight"><span class="nb">pose</span> (c1&#39; :=  (d_concat ks (u_rsp U e) c1 (<span class="kr">fun</span> <span class="nv">a0</span> <span class="nv">b0</span> =&gt; k2 (a0,&amp; b0)))).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry U i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k1, k2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : rsp U e, itree U X (nxt U e x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">v</span> : rsp U e,
id (upaco3 (eqit_ eq·µ¢ true true id) bot3)
  (nxt U e v) (k1 v) (k2 v)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry U i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : rsp U e0, itree U X (nxt U e0 r)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VisF e k1 = VisF e0 k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry U i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : rsp U e1, itree U X (nxt U e1 r)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VisF e k2 = VisF e1 k0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
  (<span class="nv">r</span> : k_rsp U (ks .[ i])),
d_get ks c0 i r ‚âà d_get ks c1 i r</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ci</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">fin (length (ks +‚ñ∂ u_rsp U e)%ctx)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cr</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k_rsp U ((ks +‚ñ∂ u_rsp U e)%ctx .[ ci])</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">d_concat ks (u_rsp U e) c0
  (<span class="kr">fun</span> (<span class="nv">a0</span> : fin (length (u_rsp U e)))
     (<span class="nv">b0</span> : k_rsp U ((u_rsp U e) .[ a0])) =&gt;
   k1 (a0,&amp; b0))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">dvec
  (<span class="kr">fun</span> <span class="nv">k</span> : kon U =&gt;
   <span class="kr">forall</span> <span class="nv">r</span> : k_rsp U k, itree U X (k_nxt U r))
  (ks +‚ñ∂ u_rsp U e)%ctx</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c1'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">d_concat ks (u_rsp U e) c1
  (<span class="kr">fun</span> (<span class="nv">a0</span> : fin (length (u_rsp U e)))
     (<span class="nv">b0</span> : k_rsp U ((u_rsp U e) .[ a0])) =&gt;
   k2 (a0,&amp; b0))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">dvec
  (<span class="kr">fun</span> <span class="nv">k</span> : kon U =&gt;
   <span class="kr">forall</span> <span class="nv">r</span> : k_rsp U k, itree U X (k_nxt U r))
  (ks +‚ñ∂ u_rsp U e)%ctx</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">r (nxt (ogs U) e (ci,&amp; cr))
  ((<span class="kr">cofix</span> _ogs_emb
      (i : I) (ks : list (kon U))
      (c : ogs_conf (itree U X) ks) 
      (x : itree U X i) :
        itree (ogs U) (X ‚àò fst) (i, ks) :=
      <span class="kr">match</span> _observe x <span class="kr">with</span>
      | RetF x0 =&gt; Ret x0
      | TauF t =&gt; Tau (_ogs_emb i ks c t)
      | VisF e k =&gt;
          Vis e
            (<span class="kr">fun</span>
               <span class="nv">r</span> : {i0
                   : fin
                       (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                   k_rsp U
                     ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
             =&gt;
             _ogs_emb (k_nxt U (projT2 r))
               (ks +‚ñ∂ u_rsp U e)%ctx
               (d_concat ks 
                  (u_rsp U e) c
                  (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                     (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
                   =&gt; k (a,&amp; b)))
               (uncurry2&#39;
                  (d_get 
                     (ks +‚ñ∂ u_rsp U e)%ctx
                     (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))) r))
      <span class="kr">end</span>) (k_nxt U (projT2 (ci,&amp; cr)))
     (ks +‚ñ∂ u_rsp U e)%ctx
     (d_concat ks (u_rsp U e) c0
        (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
           (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
         k1 (a,&amp; b)))
     (uncurry2&#39;
        (d_get (ks +‚ñ∂ u_rsp U e)%ctx
           (d_concat ks (u_rsp U e) c0
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
               k1 (a,&amp; b)))) 
        (ci,&amp; cr)))
  ((<span class="kr">cofix</span> _ogs_emb
      (i : I) (ks : list (kon U))
      (c : ogs_conf (itree U X) ks) 
      (x : itree U X i) :
        itree (ogs U) (X ‚àò fst) (i, ks) :=
      <span class="kr">match</span> _observe x <span class="kr">with</span>
      | RetF x0 =&gt; Ret x0
      | TauF t =&gt; Tau (_ogs_emb i ks c t)
      | VisF e k =&gt;
          Vis e
            (<span class="kr">fun</span>
               <span class="nv">r</span> : {i0
                   : fin
                       (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                   k_rsp U
                     ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
             =&gt;
             _ogs_emb (k_nxt U (projT2 r))
               (ks +‚ñ∂ u_rsp U e)%ctx
               (d_concat ks 
                  (u_rsp U e) c
                  (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                     (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
                   =&gt; k (a,&amp; b)))
               (uncurry2&#39;
                  (d_get 
                     (ks +‚ñ∂ u_rsp U e)%ctx
                     (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))) r))
      <span class="kr">end</span>) (k_nxt U (projT2 (ci,&amp; cr)))
     (ks +‚ñ∂ u_rsp U e)%ctx
     (d_concat ks (u_rsp U e) c1
        (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
           (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
         k2 (a,&amp; b)))
     (uncurry2&#39;
        (d_get (ks +‚ñ∂ u_rsp U e)%ctx
           (d_concat ks (u_rsp U e) c1
              (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                 (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a])) =&gt;
               k2 (a,&amp; b)))) 
        (ci,&amp; cr)))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk47" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk47"><span class="highlight"><span class="nb">enough</span> (Hcut : eutt_conf c0&#39; c1&#39;)
      <span class="bp">by</span> <span class="nb">apply</span> (CIH _ _ c0&#39; c1&#39; _ _ (Hcut ci cr) Hcut).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry U i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k1, k2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : rsp U e, itree U X (nxt U e x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">v</span> : rsp U e,
id (upaco3 (eqit_ eq·µ¢ true true id) bot3)
  (nxt U e v) (k1 v) (k2 v)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry U i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : rsp U e0, itree U X (nxt U e0 r)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VisF e k1 = VisF e0 k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry U i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : rsp U e1, itree U X (nxt U e1 r)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VisF e k2 = VisF e1 k0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
  (<span class="nv">r</span> : k_rsp U (ks .[ i])),
d_get ks c0 i r ‚âà d_get ks c1 i r</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ci</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">fin (length (ks +‚ñ∂ u_rsp U e)%ctx)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cr</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k_rsp U ((ks +‚ñ∂ u_rsp U e)%ctx .[ ci])</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">d_concat ks (u_rsp U e) c0
  (<span class="kr">fun</span> (<span class="nv">a0</span> : fin (length (u_rsp U e)))
     (<span class="nv">b0</span> : k_rsp U ((u_rsp U e) .[ a0])) =&gt;
   k1 (a0,&amp; b0))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">dvec
  (<span class="kr">fun</span> <span class="nv">k</span> : kon U =&gt;
   <span class="kr">forall</span> <span class="nv">r</span> : k_rsp U k, itree U X (k_nxt U r))
  (ks +‚ñ∂ u_rsp U e)%ctx</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c1'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">d_concat ks (u_rsp U e) c1
  (<span class="kr">fun</span> (<span class="nv">a0</span> : fin (length (u_rsp U e)))
     (<span class="nv">b0</span> : k_rsp U ((u_rsp U e) .[ a0])) =&gt;
   k2 (a0,&amp; b0))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">dvec
  (<span class="kr">fun</span> <span class="nv">k</span> : kon U =&gt;
   <span class="kr">forall</span> <span class="nv">r</span> : k_rsp U k, itree U X (k_nxt U r))
  (ks +‚ñ∂ u_rsp U e)%ctx</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eutt_conf c0&#39; c1&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk48" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk48"><span class="highlight"><span class="nb">clear</span> ci cr.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry U i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k1, k2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : rsp U e, itree U X (nxt U e x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">v</span> : rsp U e,
id (upaco3 (eqit_ eq·µ¢ true true id) bot3)
  (nxt U e v) (k1 v) (k2 v)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry U i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : rsp U e0, itree U X (nxt U e0 r)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VisF e k1 = VisF e0 k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry U i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : rsp U e1, itree U X (nxt U e1 r)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VisF e k2 = VisF e1 k0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
  (<span class="nv">r</span> : k_rsp U (ks .[ i])),
d_get ks c0 i r ‚âà d_get ks c1 i r</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">d_concat ks (u_rsp U e) c0
  (<span class="kr">fun</span> (<span class="nv">a0</span> : fin (length (u_rsp U e)))
     (<span class="nv">b0</span> : k_rsp U ((u_rsp U e) .[ a0])) =&gt;
   k1 (a0,&amp; b0))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">dvec
  (<span class="kr">fun</span> <span class="nv">k</span> : kon U =&gt;
   <span class="kr">forall</span> <span class="nv">r</span> : k_rsp U k, itree U X (k_nxt U r))
  (ks +‚ñ∂ u_rsp U e)%ctx</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c1'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">d_concat ks (u_rsp U e) c1
  (<span class="kr">fun</span> (<span class="nv">a0</span> : fin (length (u_rsp U e)))
     (<span class="nv">b0</span> : k_rsp U ((u_rsp U e) .[ a0])) =&gt;
   k2 (a0,&amp; b0))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">dvec
  (<span class="kr">fun</span> <span class="nv">k</span> : kon U =&gt;
   <span class="kr">forall</span> <span class="nv">r</span> : k_rsp U k, itree U X (k_nxt U r))
  (ks +‚ñ∂ u_rsp U e)%ctx</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eutt_conf c0&#39; c1&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk49" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk49"><span class="highlight"><span class="nb">injection</span> Ha <span class="kr">as</span> &lt;- Ha.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry U i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k1, k2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : rsp U e, itree U X (nxt U e x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">v</span> : rsp U e,
id (upaco3 (eqit_ eq·µ¢ true true id) bot3)
  (nxt U e v) (k1 v) (k2 v)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : rsp U e, itree U X (nxt U e r)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">e,&amp; k1 = e,&amp; k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry U i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : rsp U e1, itree U X (nxt U e1 r)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VisF e k2 = VisF e1 k0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
  (<span class="nv">r</span> : k_rsp U (ks .[ i])),
d_get ks c0 i r ‚âà d_get ks c1 i r</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">d_concat ks (u_rsp U e) c0
  (<span class="kr">fun</span> (<span class="nv">a0</span> : fin (length (u_rsp U e)))
     (<span class="nv">b0</span> : k_rsp U ((u_rsp U e) .[ a0])) =&gt;
   k1 (a0,&amp; b0))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">dvec
  (<span class="kr">fun</span> <span class="nv">k</span> : kon U =&gt;
   <span class="kr">forall</span> <span class="nv">r</span> : k_rsp U k, itree U X (k_nxt U r))
  (ks +‚ñ∂ u_rsp U e)%ctx</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c1'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">d_concat ks (u_rsp U e) c1
  (<span class="kr">fun</span> (<span class="nv">a0</span> : fin (length (u_rsp U e)))
     (<span class="nv">b0</span> : k_rsp U ((u_rsp U e) .[ a0])) =&gt;
   k2 (a0,&amp; b0))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">dvec
  (<span class="kr">fun</span> <span class="nv">k</span> : kon U =&gt;
   <span class="kr">forall</span> <span class="nv">r</span> : k_rsp U k, itree U X (k_nxt U r))
  (ks +‚ñ∂ u_rsp U e)%ctx</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eutt_conf c0&#39; c1&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk4a" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk4a"><span class="highlight"><span class="nb">injection</span> Hb <span class="kr">as</span> &lt;- Hb.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry U i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k1, k2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : rsp U e, itree U X (nxt U e x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">v</span> : rsp U e,
id (upaco3 (eqit_ eq·µ¢ true true id) bot3)
  (nxt U e v) (k1 v) (k2 v)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : rsp U e, itree U X (nxt U e r)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">e,&amp; k1 = e,&amp; k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : rsp U e, itree U X (nxt U e r)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">e,&amp; k2 = e,&amp; k0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
  (<span class="nv">r</span> : k_rsp U (ks .[ i])),
d_get ks c0 i r ‚âà d_get ks c1 i r</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">d_concat ks (u_rsp U e) c0
  (<span class="kr">fun</span> (<span class="nv">a0</span> : fin (length (u_rsp U e)))
     (<span class="nv">b0</span> : k_rsp U ((u_rsp U e) .[ a0])) =&gt;
   k1 (a0,&amp; b0))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">dvec
  (<span class="kr">fun</span> <span class="nv">k</span> : kon U =&gt;
   <span class="kr">forall</span> <span class="nv">r</span> : k_rsp U k, itree U X (k_nxt U r))
  (ks +‚ñ∂ u_rsp U e)%ctx</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c1'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">d_concat ks (u_rsp U e) c1
  (<span class="kr">fun</span> (<span class="nv">a0</span> : fin (length (u_rsp U e)))
     (<span class="nv">b0</span> : k_rsp U ((u_rsp U e) .[ a0])) =&gt;
   k2 (a0,&amp; b0))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">dvec
  (<span class="kr">fun</span> <span class="nv">k</span> : kon U =&gt;
   <span class="kr">forall</span> <span class="nv">r</span> : k_rsp U k, itree U X (k_nxt U r))
  (ks +‚ñ∂ u_rsp U e)%ctx</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eutt_conf c0&#39; c1&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk4b" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk4b"><span class="highlight"><span class="nb">unfold</span> eutt_conf.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry U i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k1, k2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : rsp U e, itree U X (nxt U e x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">v</span> : rsp U e,
id (upaco3 (eqit_ eq·µ¢ true true id) bot3)
  (nxt U e v) (k1 v) (k2 v)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : rsp U e, itree U X (nxt U e r)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">e,&amp; k1 = e,&amp; k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : rsp U e, itree U X (nxt U e r)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">e,&amp; k2 = e,&amp; k0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
  (<span class="nv">r</span> : k_rsp U (ks .[ i])),
d_get ks c0 i r ‚âà d_get ks c1 i r</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">d_concat ks (u_rsp U e) c0
  (<span class="kr">fun</span> (<span class="nv">a0</span> : fin (length (u_rsp U e)))
     (<span class="nv">b0</span> : k_rsp U ((u_rsp U e) .[ a0])) =&gt;
   k1 (a0,&amp; b0))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">dvec
  (<span class="kr">fun</span> <span class="nv">k</span> : kon U =&gt;
   <span class="kr">forall</span> <span class="nv">r</span> : k_rsp U k, itree U X (k_nxt U r))
  (ks +‚ñ∂ u_rsp U e)%ctx</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c1'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">d_concat ks (u_rsp U e) c1
  (<span class="kr">fun</span> (<span class="nv">a0</span> : fin (length (u_rsp U e)))
     (<span class="nv">b0</span> : k_rsp U ((u_rsp U e) .[ a0])) =&gt;
   k2 (a0,&amp; b0))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">dvec
  (<span class="kr">fun</span> <span class="nv">k</span> : kon U =&gt;
   <span class="kr">forall</span> <span class="nv">r</span> : k_rsp U k, itree U X (k_nxt U r))
  (ks +‚ñ∂ u_rsp U e)%ctx</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i0</span> : fin (length (ks +‚ñ∂ u_rsp U e)%ctx))
  (<span class="nv">r</span> : k_rsp U ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])),
d_get (ks +‚ñ∂ u_rsp U e)%ctx c0&#39; i0 r
‚âà d_get (ks +‚ñ∂ u_rsp U e)%ctx c1&#39; i0 r</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk4c" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk4c"><span class="highlight"><span class="nb">enough</span> (Hcut : _)
      <span class="bp">by</span> <span class="nb">eapply</span> (d_concat_lem (<span class="kr">fun</span> <span class="nv">_</span> (<span class="nv">f0</span> : <span class="kr">forall</span> <span class="nv">r</span>, _) (<span class="nv">f1</span> : <span class="kr">forall</span> <span class="nv">r</span>, _) =&gt; <span class="kr">forall</span> <span class="nv">r</span>, f0 r ‚âà f1 r)
                  ks (u_rsp U e) c0 c1
                  (<span class="kr">fun</span> <span class="nv">a0</span> <span class="nv">b0</span> =&gt; k1 (a0 ,&amp; b0)) (<span class="kr">fun</span> <span class="nv">a0</span> <span class="nv">b0</span> =&gt; k2 (a0 ,&amp; b0))
                  H1 Hcut).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry U i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k1, k2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : rsp U e, itree U X (nxt U e x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">v</span> : rsp U e,
id (upaco3 (eqit_ eq·µ¢ true true id) bot3)
  (nxt U e v) (k1 v) (k2 v)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : rsp U e, itree U X (nxt U e r)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">e,&amp; k1 = e,&amp; k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : rsp U e, itree U X (nxt U e r)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">e,&amp; k2 = e,&amp; k0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
  (<span class="nv">r</span> : k_rsp U (ks .[ i])),
d_get ks c0 i r ‚âà d_get ks c1 i r</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">d_concat ks (u_rsp U e) c0
  (<span class="kr">fun</span> (<span class="nv">a0</span> : fin (length (u_rsp U e)))
     (<span class="nv">b0</span> : k_rsp U ((u_rsp U e) .[ a0])) =&gt;
   k1 (a0,&amp; b0))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">dvec
  (<span class="kr">fun</span> <span class="nv">k</span> : kon U =&gt;
   <span class="kr">forall</span> <span class="nv">r</span> : k_rsp U k, itree U X (k_nxt U r))
  (ks +‚ñ∂ u_rsp U e)%ctx</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c1'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">d_concat ks (u_rsp U e) c1
  (<span class="kr">fun</span> (<span class="nv">a0</span> : fin (length (u_rsp U e)))
     (<span class="nv">b0</span> : k_rsp U ((u_rsp U e) .[ a0])) =&gt;
   k2 (a0,&amp; b0))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">dvec
  (<span class="kr">fun</span> <span class="nv">k</span> : kon U =&gt;
   <span class="kr">forall</span> <span class="nv">r</span> : k_rsp U k, itree U X (k_nxt U r))
  (ks +‚ñ∂ u_rsp U e)%ctx</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">i0</span> : fin (length (u_rsp U e)),
(<span class="kr">fun</span> (<span class="nv">x</span> : kon U)
   (<span class="nv">f0</span>
    <span class="nv">f1</span> : <span class="kr">forall</span> <span class="nv">r</span> : k_rsp U x, itree U X (k_nxt U r))
 =&gt; <span class="kr">forall</span> <span class="nv">r</span> : k_rsp U x, f0 r ‚âà f1 r)
  ((u_rsp U e) .[ i0])
  ((<span class="kr">fun</span> (<span class="nv">a0</span> : fin (length (u_rsp U e)))
      (<span class="nv">b0</span> : k_rsp U ((u_rsp U e) .[ a0])) =&gt;
    k1 (a0,&amp; b0)) i0)
  ((<span class="kr">fun</span> (<span class="nv">a0</span> : fin (length (u_rsp U e)))
      (<span class="nv">b0</span> : k_rsp U ((u_rsp U e) .[ a0])) =&gt;
    k2 (a0,&amp; b0)) i0)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk4d" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk4d"><span class="highlight"><span class="nb">intros</span> ci cr.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qry U i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k1, k2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : rsp U e, itree U X (nxt U e x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">REL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">v</span> : rsp U e,
id (upaco3 (eqit_ eq·µ¢ true true id) bot3)
  (nxt U e v) (k1 v) (k2 v)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : rsp U e, itree U X (nxt U e r)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">e,&amp; k1 = e,&amp; k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : rsp U e, itree U X (nxt U e r)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">e,&amp; k2 = e,&amp; k0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
  (<span class="nv">r</span> : k_rsp U (ks .[ i])),
d_get ks c0 i r ‚âà d_get ks c1 i r</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">d_concat ks (u_rsp U e) c0
  (<span class="kr">fun</span> (<span class="nv">a0</span> : fin (length (u_rsp U e)))
     (<span class="nv">b0</span> : k_rsp U ((u_rsp U e) .[ a0])) =&gt;
   k1 (a0,&amp; b0))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">dvec
  (<span class="kr">fun</span> <span class="nv">k</span> : kon U =&gt;
   <span class="kr">forall</span> <span class="nv">r</span> : k_rsp U k, itree U X (k_nxt U r))
  (ks +‚ñ∂ u_rsp U e)%ctx</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c1'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">d_concat ks (u_rsp U e) c1
  (<span class="kr">fun</span> (<span class="nv">a0</span> : fin (length (u_rsp U e)))
     (<span class="nv">b0</span> : k_rsp U ((u_rsp U e) .[ a0])) =&gt;
   k2 (a0,&amp; b0))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">dvec
  (<span class="kr">fun</span> <span class="nv">k</span> : kon U =&gt;
   <span class="kr">forall</span> <span class="nv">r</span> : k_rsp U k, itree U X (k_nxt U r))
  (ks +‚ñ∂ u_rsp U e)%ctx</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ci</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">fin (length (u_rsp U e))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cr</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k_rsp U ((u_rsp U e) .[ ci])</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">k1 (ci,&amp; cr) ‚âà k2 (ci,&amp; cr)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">destruct</span> (REL (ci ,&amp; cr)); [ <span class="nb">auto</span> | <span class="nb">destruct</span> H ].</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk4e" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk4e"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ot2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree&#39; U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CHECK</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">is_true true</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) bot3) i
  (observe t1) ot2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHeqitF</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(<span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
   (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
   (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
 a ‚âà b -&gt;
 eutt_conf c0 c1 -&gt;
 r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)) -&gt;
<span class="kr">forall</span> (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
observe t1 = _observe a -&gt;
ot2 = _observe b -&gt;
(<span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
   (<span class="nv">r</span> : k_rsp U (ks .[ i])),
 d_get ks c0 i r ‚âà d_get ks c1 i r) -&gt;
eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r)
  (i, ks)
  (_observe
     <span class="kr">match</span> observe t1 <span class="kr">with</span>
     | RetF x =&gt; Ret x
     | TauF t =&gt;
         Tau
           ((<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks0 : list (kon U))
               (c : ogs_conf (itree U X) ks0)
               (x : itree U X i) :
                 itree (ogs U) 
                   (X ‚àò fst) 
                   (i, ks0) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t0 =&gt;
                   Tau (_ogs_emb i ks0 c t0)
               | VisF e k =&gt;
                   Vis e
                     (<span class="kr">fun</span>
                        <span class="nv">r</span> : 
                        {i0
                        : 
                        fin
                        (length (...)%ctx) &amp;
                        k_rsp U
                        ((...)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb
                        (k_nxt U (projT2 r))
                        (ks0 +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks0
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a0</span> : ...)
                        (<span class="nv">b0</span> : ...) =&gt;
                        k (...)))
                        (uncurry2&#39;
                        (d_get
                        (ks0 +‚ñ∂ ...)%ctx
                        (d_concat ks0 ... c
                        ...)) r))
               <span class="kr">end</span>) i ks c0 t)
     | VisF e k =&gt;
         Vis e
           (<span class="kr">fun</span>
              <span class="nv">r</span> : {i0
                  : fin
                      (length
                        (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                  k_rsp U
                    ((ks +‚ñ∂ u_rsp U e)%ctx
                     .[ i0])} =&gt;
            (<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks0 : list (kon U))
               (c : ogs_conf (itree U X) ks0)
               (x : itree U X i) :
                 itree (ogs U) 
                   (X ‚àò fst) 
                   (i, ks0) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t =&gt;
                   Tau (_ogs_emb i ks0 c t)
               | VisF e0 k0 =&gt;
                   Vis e0
                     (<span class="kr">fun</span>
                        <span class="nv">r0</span> : 
                        {i0
                        : 
                        fin 
                        (length ...%ctx) &amp;
                        k_rsp U
                        (...%ctx .[ i0])} =&gt;
                      _ogs_emb
                        (k_nxt U (projT2 r0))
                        (ks0 +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks0
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> ... ... =&gt;
                        k0 ...))
                        (uncurry2&#39;
                        (d_get 
                        (...)%ctx 
                        (...)) r0))
               <span class="kr">end</span>) (k_nxt U (projT2 r))
              (ks +‚ñ∂ u_rsp U e)%ctx
              (d_concat ks 
                 (u_rsp U e) c0
                 (<span class="kr">fun</span>
                    (<span class="nv">a0</span> : 
                     fin
                       (length (u_rsp U e)))
                    (<span class="nv">b0</span> : 
                     k_rsp U
                       ((u_rsp U e) .[ a0]))
                  =&gt; k (a0,&amp; b0)))
              (uncurry2&#39;
                 (d_get
                    (ks +‚ñ∂ u_rsp U e)%ctx
                    (d_concat ks 
                       (u_rsp U e) c0
                       (<span class="kr">fun</span>
                        (<span class="nv">a0</span> : 
                        fin 
                        (length ...))
                        (<span class="nv">b0</span> : 
                        k_rsp U 
                        (... .[ a0])) =&gt;
                        k (a0,&amp; b0)))) r))
     <span class="kr">end</span>)
  (_observe
     <span class="kr">match</span> ot2 <span class="kr">with</span>
     | RetF x =&gt; Ret x
     | TauF t =&gt;
         Tau
           ((<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks0 : list (kon U))
               (c : ogs_conf (itree U X) ks0)
               (x : itree U X i) :
                 itree (ogs U) 
                   (X ‚àò fst) 
                   (i, ks0) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t0 =&gt;
                   Tau (_ogs_emb i ks0 c t0)
               | VisF e k =&gt;
                   Vis e
                     (<span class="kr">fun</span>
                        <span class="nv">r</span> : 
                        {i0
                        : 
                        fin
                        (length (...)%ctx) &amp;
                        k_rsp U
                        ((...)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb
                        (k_nxt U (projT2 r))
                        (ks0 +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks0
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a0</span> : ...)
                        (<span class="nv">b0</span> : ...) =&gt;
                        k (...)))
                        (uncurry2&#39;
                        (d_get
                        (ks0 +‚ñ∂ ...)%ctx
                        (d_concat ks0 ... c
                        ...)) r))
               <span class="kr">end</span>) i ks c1 t)
     | VisF e k =&gt;
         Vis e
           (<span class="kr">fun</span>
              <span class="nv">r</span> : {i0
                  : fin
                      (length
                        (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                  k_rsp U
                    ((ks +‚ñ∂ u_rsp U e)%ctx
                     .[ i0])} =&gt;
            (<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks0 : list (kon U))
               (c : ogs_conf (itree U X) ks0)
               (x : itree U X i) :
                 itree (ogs U) 
                   (X ‚àò fst) 
                   (i, ks0) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t =&gt;
                   Tau (_ogs_emb i ks0 c t)
               | VisF e0 k0 =&gt;
                   Vis e0
                     (<span class="kr">fun</span>
                        <span class="nv">r0</span> : 
                        {i0
                        : 
                        fin 
                        (length ...%ctx) &amp;
                        k_rsp U
                        (...%ctx .[ i0])} =&gt;
                      _ogs_emb
                        (k_nxt U (projT2 r0))
                        (ks0 +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks0
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> ... ... =&gt;
                        k0 ...))
                        (uncurry2&#39;
                        (d_get 
                        (...)%ctx 
                        (...)) r0))
               <span class="kr">end</span>) (k_nxt U (projT2 r))
              (ks +‚ñ∂ u_rsp U e)%ctx
              (d_concat ks 
                 (u_rsp U e) c1
                 (<span class="kr">fun</span>
                    (<span class="nv">a0</span> : 
                     fin
                       (length (u_rsp U e)))
                    (<span class="nv">b0</span> : 
                     k_rsp U
                       ((u_rsp U e) .[ a0]))
                  =&gt; k (a0,&amp; b0)))
              (uncurry2&#39;
                 (d_get
                    (ks +‚ñ∂ u_rsp U e)%ctx
                    (d_concat ks 
                       (u_rsp U e) c1
                       (<span class="kr">fun</span>
                        (<span class="nv">a0</span> : 
                        fin 
                        (length ...))
                        (<span class="nv">b0</span> : 
                        k_rsp U 
                        (... .[ a0])) =&gt;
                        k (a0,&amp; b0)))) r))
     <span class="kr">end</span>)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF t1 = _observe a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ot2 = _observe b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
  (<span class="nv">r</span> : k_rsp U (ks .[ i])),
d_get ks c0 i r ‚âà d_get ks c1 i r</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) 
  (i, ks)
  (_observe
     (Tau
        ((<span class="kr">cofix</span> _ogs_emb
            (i : I) (ks : list (kon U))
            (c : ogs_conf (itree U X) ks)
            (x : itree U X i) :
              itree (ogs U) (X ‚àò fst) (i, ks) :=
            <span class="kr">match</span> _observe x <span class="kr">with</span>
            | RetF x0 =&gt; Ret x0
            | TauF t =&gt; Tau (_ogs_emb i ks c t)
            | VisF e k =&gt;
                Vis e
                  (<span class="kr">fun</span>
                     <span class="nv">r</span> : 
                      {i0
                      : fin
                        (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                      k_rsp U
                        ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
                   =&gt;
                   _ogs_emb 
                     (k_nxt U (projT2 r))
                     (ks +‚ñ∂ u_rsp U e)%ctx
                     (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))
                     (uncurry2&#39;
                        (d_get 
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin (...))
                        (<span class="nv">b</span> : k_rsp U (...)) =&gt;
                        k (a,&amp; b)))) r))
            <span class="kr">end</span>) i ks c0 t1)))
  (_observe
     <span class="kr">match</span> ot2 <span class="kr">with</span>
     | RetF x =&gt; Ret x
     | TauF t =&gt;
         Tau
           ((<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks : list (kon U))
               (c : ogs_conf (itree U X) ks)
               (x : itree U X i) :
                 itree (ogs U) (X ‚àò fst) (i, ks) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t0 =&gt; Tau (_ogs_emb i ks c t0)
               | VisF e k =&gt;
                   Vis e
                     (<span class="kr">fun</span>
                        <span class="nv">r</span> : 
                        {i0
                        : 
                        fin
                        (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                        k_rsp U
                        ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb 
                        (k_nxt U (projT2 r))
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))
                        (uncurry2&#39;
                        (d_get 
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin ...)
                        (<span class="nv">b</span> : k_rsp U ...) =&gt; 
                        k (a,&amp; b)))) r))
               <span class="kr">end</span>) i ks c1 t)
     | VisF e k =&gt;
         Vis e
           (<span class="kr">fun</span>
              <span class="nv">r</span> : {i0
                  : fin (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                  k_rsp U
                    ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])} =&gt;
            (<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks : list (kon U))
               (c : ogs_conf (itree U X) ks)
               (x : itree U X i) :
                 itree (ogs U) (X ‚àò fst) (i, ks) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t =&gt; Tau (_ogs_emb i ks c t)
               | VisF e0 k0 =&gt;
                   Vis e0
                     (<span class="kr">fun</span>
                        <span class="nv">r0</span> : 
                        {i0
                        : 
                        fin
                        (length (ks +‚ñ∂ u_rsp U e0)%ctx) &amp;
                        k_rsp U
                        ((ks +‚ñ∂ u_rsp U e0)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb 
                        (k_nxt U (projT2 r0))
                        (ks +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks 
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin (length (...)))
                        (<span class="nv">b</span> : k_rsp U ((...) .[ a])) =&gt;
                        k0 (a,&amp; b)))
                        (uncurry2&#39;
                        (d_get 
                        (ks +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks 
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> (<span class="nv">a</span> : ...) (<span class="nv">b</span> : ...) =&gt;
                        k0 (...)))) r0))
               <span class="kr">end</span>) (k_nxt U (projT2 r))
              (ks +‚ñ∂ u_rsp U e)%ctx
              (d_concat ks 
                 (u_rsp U e) c1
                 (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                    (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
                  =&gt; k (a,&amp; b)))
              (uncurry2&#39;
                 (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                    (d_concat ks 
                       (u_rsp U e) c1
                       (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))) r))
     <span class="kr">end</span>)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk4f" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk4f"><span class="highlight"><span class="nb">econstructor</span>; <span class="nb">auto</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ot2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree&#39; U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CHECK</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">is_true true</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) bot3) i
  (observe t1) ot2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHeqitF</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(<span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
   (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
   (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
 a ‚âà b -&gt;
 eutt_conf c0 c1 -&gt;
 r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)) -&gt;
<span class="kr">forall</span> (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
observe t1 = _observe a -&gt;
ot2 = _observe b -&gt;
(<span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
   (<span class="nv">r</span> : k_rsp U (ks .[ i])),
 d_get ks c0 i r ‚âà d_get ks c1 i r) -&gt;
eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r)
  (i, ks)
  (_observe
     <span class="kr">match</span> observe t1 <span class="kr">with</span>
     | RetF x =&gt; Ret x
     | TauF t =&gt;
         Tau
           ((<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks0 : list (kon U))
               (c : ogs_conf (itree U X) ks0)
               (x : itree U X i) :
                 itree (ogs U) 
                   (X ‚àò fst) 
                   (i, ks0) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t0 =&gt;
                   Tau (_ogs_emb i ks0 c t0)
               | VisF e k =&gt;
                   Vis e
                     (<span class="kr">fun</span>
                        <span class="nv">r</span> : 
                        {i0
                        : 
                        fin
                        (length (...)%ctx) &amp;
                        k_rsp U
                        ((...)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb
                        (k_nxt U (projT2 r))
                        (ks0 +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks0
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a0</span> : ...)
                        (<span class="nv">b0</span> : ...) =&gt;
                        k (...)))
                        (uncurry2&#39;
                        (d_get
                        (ks0 +‚ñ∂ ...)%ctx
                        (d_concat ks0 ... c
                        ...)) r))
               <span class="kr">end</span>) i ks c0 t)
     | VisF e k =&gt;
         Vis e
           (<span class="kr">fun</span>
              <span class="nv">r</span> : {i0
                  : fin
                      (length
                        (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                  k_rsp U
                    ((ks +‚ñ∂ u_rsp U e)%ctx
                     .[ i0])} =&gt;
            (<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks0 : list (kon U))
               (c : ogs_conf (itree U X) ks0)
               (x : itree U X i) :
                 itree (ogs U) 
                   (X ‚àò fst) 
                   (i, ks0) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t =&gt;
                   Tau (_ogs_emb i ks0 c t)
               | VisF e0 k0 =&gt;
                   Vis e0
                     (<span class="kr">fun</span>
                        <span class="nv">r0</span> : 
                        {i0
                        : 
                        fin 
                        (length ...%ctx) &amp;
                        k_rsp U
                        (...%ctx .[ i0])} =&gt;
                      _ogs_emb
                        (k_nxt U (projT2 r0))
                        (ks0 +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks0
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> ... ... =&gt;
                        k0 ...))
                        (uncurry2&#39;
                        (d_get 
                        (...)%ctx 
                        (...)) r0))
               <span class="kr">end</span>) (k_nxt U (projT2 r))
              (ks +‚ñ∂ u_rsp U e)%ctx
              (d_concat ks 
                 (u_rsp U e) c0
                 (<span class="kr">fun</span>
                    (<span class="nv">a0</span> : 
                     fin
                       (length (u_rsp U e)))
                    (<span class="nv">b0</span> : 
                     k_rsp U
                       ((u_rsp U e) .[ a0]))
                  =&gt; k (a0,&amp; b0)))
              (uncurry2&#39;
                 (d_get
                    (ks +‚ñ∂ u_rsp U e)%ctx
                    (d_concat ks 
                       (u_rsp U e) c0
                       (<span class="kr">fun</span>
                        (<span class="nv">a0</span> : 
                        fin 
                        (length ...))
                        (<span class="nv">b0</span> : 
                        k_rsp U 
                        (... .[ a0])) =&gt;
                        k (a0,&amp; b0)))) r))
     <span class="kr">end</span>)
  (_observe
     <span class="kr">match</span> ot2 <span class="kr">with</span>
     | RetF x =&gt; Ret x
     | TauF t =&gt;
         Tau
           ((<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks0 : list (kon U))
               (c : ogs_conf (itree U X) ks0)
               (x : itree U X i) :
                 itree (ogs U) 
                   (X ‚àò fst) 
                   (i, ks0) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t0 =&gt;
                   Tau (_ogs_emb i ks0 c t0)
               | VisF e k =&gt;
                   Vis e
                     (<span class="kr">fun</span>
                        <span class="nv">r</span> : 
                        {i0
                        : 
                        fin
                        (length (...)%ctx) &amp;
                        k_rsp U
                        ((...)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb
                        (k_nxt U (projT2 r))
                        (ks0 +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks0
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a0</span> : ...)
                        (<span class="nv">b0</span> : ...) =&gt;
                        k (...)))
                        (uncurry2&#39;
                        (d_get
                        (ks0 +‚ñ∂ ...)%ctx
                        (d_concat ks0 ... c
                        ...)) r))
               <span class="kr">end</span>) i ks c1 t)
     | VisF e k =&gt;
         Vis e
           (<span class="kr">fun</span>
              <span class="nv">r</span> : {i0
                  : fin
                      (length
                        (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                  k_rsp U
                    ((ks +‚ñ∂ u_rsp U e)%ctx
                     .[ i0])} =&gt;
            (<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks0 : list (kon U))
               (c : ogs_conf (itree U X) ks0)
               (x : itree U X i) :
                 itree (ogs U) 
                   (X ‚àò fst) 
                   (i, ks0) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t =&gt;
                   Tau (_ogs_emb i ks0 c t)
               | VisF e0 k0 =&gt;
                   Vis e0
                     (<span class="kr">fun</span>
                        <span class="nv">r0</span> : 
                        {i0
                        : 
                        fin 
                        (length ...%ctx) &amp;
                        k_rsp U
                        (...%ctx .[ i0])} =&gt;
                      _ogs_emb
                        (k_nxt U (projT2 r0))
                        (ks0 +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks0
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> ... ... =&gt;
                        k0 ...))
                        (uncurry2&#39;
                        (d_get 
                        (...)%ctx 
                        (...)) r0))
               <span class="kr">end</span>) (k_nxt U (projT2 r))
              (ks +‚ñ∂ u_rsp U e)%ctx
              (d_concat ks 
                 (u_rsp U e) c1
                 (<span class="kr">fun</span>
                    (<span class="nv">a0</span> : 
                     fin
                       (length (u_rsp U e)))
                    (<span class="nv">b0</span> : 
                     k_rsp U
                       ((u_rsp U e) .[ a0]))
                  =&gt; k (a0,&amp; b0)))
              (uncurry2&#39;
                 (d_get
                    (ks +‚ñ∂ u_rsp U e)%ctx
                    (d_concat ks 
                       (u_rsp U e) c1
                       (<span class="kr">fun</span>
                        (<span class="nv">a0</span> : 
                        fin 
                        (length ...))
                        (<span class="nv">b0</span> : 
                        k_rsp U 
                        (... .[ a0])) =&gt;
                        k (a0,&amp; b0)))) r))
     <span class="kr">end</span>)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF t1 = _observe a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ot2 = _observe b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
  (<span class="nv">r</span> : k_rsp U (ks .[ i])),
d_get ks c0 i r ‚âà d_get ks c1 i r</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) 
  (i, ks)
  (observe
     ((<span class="kr">cofix</span> _ogs_emb
         (i : I) (ks : list (kon U))
         (c : ogs_conf (itree U X) ks)
         (x : itree U X i) :
           itree (ogs U) (X ‚àò fst) (i, ks) :=
         <span class="kr">match</span> _observe x <span class="kr">with</span>
         | RetF x0 =&gt; Ret x0
         | TauF t =&gt; Tau (_ogs_emb i ks c t)
         | VisF e k =&gt;
             Vis e
               (<span class="kr">fun</span>
                  <span class="nv">r</span> : {i0
                      : fin
                        (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                      k_rsp U
                        ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
                =&gt;
                _ogs_emb 
                  (k_nxt U (projT2 r))
                  (ks +‚ñ∂ u_rsp U e)%ctx
                  (d_concat ks 
                     (u_rsp U e) c
                     (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                      k (a,&amp; b)))
                  (uncurry2&#39;
                     (d_get 
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin (length (...)))
                        (<span class="nv">b</span> : k_rsp U ((...) .[ a])) =&gt;
                        k (a,&amp; b)))) r))
         <span class="kr">end</span>) i ks c0 t1))
  (_observe
     <span class="kr">match</span> ot2 <span class="kr">with</span>
     | RetF x =&gt; Ret x
     | TauF t =&gt;
         Tau
           ((<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks : list (kon U))
               (c : ogs_conf (itree U X) ks)
               (x : itree U X i) :
                 itree (ogs U) (X ‚àò fst) (i, ks) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t0 =&gt; Tau (_ogs_emb i ks c t0)
               | VisF e k =&gt;
                   Vis e
                     (<span class="kr">fun</span>
                        <span class="nv">r</span> : 
                        {i0
                        : 
                        fin
                        (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                        k_rsp U
                        ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb 
                        (k_nxt U (projT2 r))
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))
                        (uncurry2&#39;
                        (d_get 
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin ...)
                        (<span class="nv">b</span> : k_rsp U ...) =&gt; 
                        k (a,&amp; b)))) r))
               <span class="kr">end</span>) i ks c1 t)
     | VisF e k =&gt;
         Vis e
           (<span class="kr">fun</span>
              <span class="nv">r</span> : {i0
                  : fin (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                  k_rsp U
                    ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])} =&gt;
            (<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks : list (kon U))
               (c : ogs_conf (itree U X) ks)
               (x : itree U X i) :
                 itree (ogs U) (X ‚àò fst) (i, ks) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t =&gt; Tau (_ogs_emb i ks c t)
               | VisF e0 k0 =&gt;
                   Vis e0
                     (<span class="kr">fun</span>
                        <span class="nv">r0</span> : 
                        {i0
                        : 
                        fin
                        (length (ks +‚ñ∂ u_rsp U e0)%ctx) &amp;
                        k_rsp U
                        ((ks +‚ñ∂ u_rsp U e0)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb 
                        (k_nxt U (projT2 r0))
                        (ks +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks 
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin (length (...)))
                        (<span class="nv">b</span> : k_rsp U ((...) .[ a])) =&gt;
                        k0 (a,&amp; b)))
                        (uncurry2&#39;
                        (d_get 
                        (ks +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks 
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> (<span class="nv">a</span> : ...) (<span class="nv">b</span> : ...) =&gt;
                        k0 (...)))) r0))
               <span class="kr">end</span>) (k_nxt U (projT2 r))
              (ks +‚ñ∂ u_rsp U e)%ctx
              (d_concat ks 
                 (u_rsp U e) c1
                 (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                    (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
                  =&gt; k (a,&amp; b)))
              (uncurry2&#39;
                 (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                    (d_concat ks 
                       (u_rsp U e) c1
                       (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))) r))
     <span class="kr">end</span>)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk50" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk50"><span class="highlight"><span class="nb">destruct</span> (_observe a); <span class="kp">try</span> <span class="bp">discriminate</span> Ha.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ot2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree&#39; U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CHECK</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">is_true true</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) bot3) i
  (observe t1) ot2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHeqitF</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(<span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
   (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
   (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
 a ‚âà b -&gt;
 eutt_conf c0 c1 -&gt;
 r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)) -&gt;
<span class="kr">forall</span> (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
observe t1 = _observe a -&gt;
ot2 = _observe b -&gt;
(<span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
   (<span class="nv">r</span> : k_rsp U (ks .[ i])),
 d_get ks c0 i r ‚âà d_get ks c1 i r) -&gt;
eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r)
  (i, ks)
  (_observe
     <span class="kr">match</span> observe t1 <span class="kr">with</span>
     | RetF x =&gt; Ret x
     | TauF t =&gt;
         Tau
           ((<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks0 : list (kon U))
               (c : ogs_conf (itree U X) ks0)
               (x : itree U X i) :
                 itree (ogs U) 
                   (X ‚àò fst) 
                   (i, ks0) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t0 =&gt;
                   Tau (_ogs_emb i ks0 c t0)
               | VisF e k =&gt;
                   Vis e
                     (<span class="kr">fun</span>
                        <span class="nv">r</span> : 
                        {i0
                        : 
                        fin
                        (length (...)%ctx) &amp;
                        k_rsp U
                        ((...)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb
                        (k_nxt U (projT2 r))
                        (ks0 +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks0
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a0</span> : ...)
                        (<span class="nv">b0</span> : ...) =&gt;
                        k (...)))
                        (uncurry2&#39;
                        (d_get
                        (ks0 +‚ñ∂ ...)%ctx
                        (d_concat ks0 ... c
                        ...)) r))
               <span class="kr">end</span>) i ks c0 t)
     | VisF e k =&gt;
         Vis e
           (<span class="kr">fun</span>
              <span class="nv">r</span> : {i0
                  : fin
                      (length
                        (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                  k_rsp U
                    ((ks +‚ñ∂ u_rsp U e)%ctx
                     .[ i0])} =&gt;
            (<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks0 : list (kon U))
               (c : ogs_conf (itree U X) ks0)
               (x : itree U X i) :
                 itree (ogs U) 
                   (X ‚àò fst) 
                   (i, ks0) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t =&gt;
                   Tau (_ogs_emb i ks0 c t)
               | VisF e0 k0 =&gt;
                   Vis e0
                     (<span class="kr">fun</span>
                        <span class="nv">r0</span> : 
                        {i0
                        : 
                        fin 
                        (length ...%ctx) &amp;
                        k_rsp U
                        (...%ctx .[ i0])} =&gt;
                      _ogs_emb
                        (k_nxt U (projT2 r0))
                        (ks0 +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks0
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> ... ... =&gt;
                        k0 ...))
                        (uncurry2&#39;
                        (d_get 
                        (...)%ctx 
                        (...)) r0))
               <span class="kr">end</span>) (k_nxt U (projT2 r))
              (ks +‚ñ∂ u_rsp U e)%ctx
              (d_concat ks 
                 (u_rsp U e) c0
                 (<span class="kr">fun</span>
                    (<span class="nv">a0</span> : 
                     fin
                       (length (u_rsp U e)))
                    (<span class="nv">b0</span> : 
                     k_rsp U
                       ((u_rsp U e) .[ a0]))
                  =&gt; k (a0,&amp; b0)))
              (uncurry2&#39;
                 (d_get
                    (ks +‚ñ∂ u_rsp U e)%ctx
                    (d_concat ks 
                       (u_rsp U e) c0
                       (<span class="kr">fun</span>
                        (<span class="nv">a0</span> : 
                        fin 
                        (length ...))
                        (<span class="nv">b0</span> : 
                        k_rsp U 
                        (... .[ a0])) =&gt;
                        k (a0,&amp; b0)))) r))
     <span class="kr">end</span>)
  (_observe
     <span class="kr">match</span> ot2 <span class="kr">with</span>
     | RetF x =&gt; Ret x
     | TauF t =&gt;
         Tau
           ((<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks0 : list (kon U))
               (c : ogs_conf (itree U X) ks0)
               (x : itree U X i) :
                 itree (ogs U) 
                   (X ‚àò fst) 
                   (i, ks0) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t0 =&gt;
                   Tau (_ogs_emb i ks0 c t0)
               | VisF e k =&gt;
                   Vis e
                     (<span class="kr">fun</span>
                        <span class="nv">r</span> : 
                        {i0
                        : 
                        fin
                        (length (...)%ctx) &amp;
                        k_rsp U
                        ((...)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb
                        (k_nxt U (projT2 r))
                        (ks0 +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks0
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a0</span> : ...)
                        (<span class="nv">b0</span> : ...) =&gt;
                        k (...)))
                        (uncurry2&#39;
                        (d_get
                        (ks0 +‚ñ∂ ...)%ctx
                        (d_concat ks0 ... c
                        ...)) r))
               <span class="kr">end</span>) i ks c1 t)
     | VisF e k =&gt;
         Vis e
           (<span class="kr">fun</span>
              <span class="nv">r</span> : {i0
                  : fin
                      (length
                        (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                  k_rsp U
                    ((ks +‚ñ∂ u_rsp U e)%ctx
                     .[ i0])} =&gt;
            (<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks0 : list (kon U))
               (c : ogs_conf (itree U X) ks0)
               (x : itree U X i) :
                 itree (ogs U) 
                   (X ‚àò fst) 
                   (i, ks0) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t =&gt;
                   Tau (_ogs_emb i ks0 c t)
               | VisF e0 k0 =&gt;
                   Vis e0
                     (<span class="kr">fun</span>
                        <span class="nv">r0</span> : 
                        {i0
                        : 
                        fin 
                        (length ...%ctx) &amp;
                        k_rsp U
                        (...%ctx .[ i0])} =&gt;
                      _ogs_emb
                        (k_nxt U (projT2 r0))
                        (ks0 +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks0
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> ... ... =&gt;
                        k0 ...))
                        (uncurry2&#39;
                        (d_get 
                        (...)%ctx 
                        (...)) r0))
               <span class="kr">end</span>) (k_nxt U (projT2 r))
              (ks +‚ñ∂ u_rsp U e)%ctx
              (d_concat ks 
                 (u_rsp U e) c1
                 (<span class="kr">fun</span>
                    (<span class="nv">a0</span> : 
                     fin
                       (length (u_rsp U e)))
                    (<span class="nv">b0</span> : 
                     k_rsp U
                       ((u_rsp U e) .[ a0]))
                  =&gt; k (a0,&amp; b0)))
              (uncurry2&#39;
                 (d_get
                    (ks +‚ñ∂ u_rsp U e)%ctx
                    (d_concat ks 
                       (u_rsp U e) c1
                       (<span class="kr">fun</span>
                        (<span class="nv">a0</span> : 
                        fin 
                        (length ...))
                        (<span class="nv">b0</span> : 
                        k_rsp U 
                        (... .[ a0])) =&gt;
                        k (a0,&amp; b0)))) r))
     <span class="kr">end</span>)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b, t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF t1 = TauF t</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ot2 = _observe b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
  (<span class="nv">r</span> : k_rsp U (ks .[ i])),
d_get ks c0 i r ‚âà d_get ks c1 i r</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) 
  (i, ks)
  (observe
     ((<span class="kr">cofix</span> _ogs_emb
         (i : I) (ks : list (kon U))
         (c : ogs_conf (itree U X) ks)
         (x : itree U X i) :
           itree (ogs U) (X ‚àò fst) (i, ks) :=
         <span class="kr">match</span> _observe x <span class="kr">with</span>
         | RetF x0 =&gt; Ret x0
         | TauF t =&gt; Tau (_ogs_emb i ks c t)
         | VisF e k =&gt;
             Vis e
               (<span class="kr">fun</span>
                  <span class="nv">r</span> : {i0
                      : fin
                        (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                      k_rsp U
                        ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
                =&gt;
                _ogs_emb 
                  (k_nxt U (projT2 r))
                  (ks +‚ñ∂ u_rsp U e)%ctx
                  (d_concat ks 
                     (u_rsp U e) c
                     (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                      k (a,&amp; b)))
                  (uncurry2&#39;
                     (d_get 
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin (length (...)))
                        (<span class="nv">b</span> : k_rsp U ((...) .[ a])) =&gt;
                        k (a,&amp; b)))) r))
         <span class="kr">end</span>) i ks c0 t1))
  (_observe
     <span class="kr">match</span> ot2 <span class="kr">with</span>
     | RetF x =&gt; Ret x
     | TauF t =&gt;
         Tau
           ((<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks : list (kon U))
               (c : ogs_conf (itree U X) ks)
               (x : itree U X i) :
                 itree (ogs U) (X ‚àò fst) (i, ks) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t0 =&gt; Tau (_ogs_emb i ks c t0)
               | VisF e k =&gt;
                   Vis e
                     (<span class="kr">fun</span>
                        <span class="nv">r</span> : 
                        {i0
                        : 
                        fin
                        (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                        k_rsp U
                        ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb 
                        (k_nxt U (projT2 r))
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))
                        (uncurry2&#39;
                        (d_get 
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin ...)
                        (<span class="nv">b</span> : k_rsp U ...) =&gt; 
                        k (a,&amp; b)))) r))
               <span class="kr">end</span>) i ks c1 t)
     | VisF e k =&gt;
         Vis e
           (<span class="kr">fun</span>
              <span class="nv">r</span> : {i0
                  : fin (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                  k_rsp U
                    ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])} =&gt;
            (<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks : list (kon U))
               (c : ogs_conf (itree U X) ks)
               (x : itree U X i) :
                 itree (ogs U) (X ‚àò fst) (i, ks) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t =&gt; Tau (_ogs_emb i ks c t)
               | VisF e0 k0 =&gt;
                   Vis e0
                     (<span class="kr">fun</span>
                        <span class="nv">r0</span> : 
                        {i0
                        : 
                        fin
                        (length (ks +‚ñ∂ u_rsp U e0)%ctx) &amp;
                        k_rsp U
                        ((ks +‚ñ∂ u_rsp U e0)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb 
                        (k_nxt U (projT2 r0))
                        (ks +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks 
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin (length (...)))
                        (<span class="nv">b</span> : k_rsp U ((...) .[ a])) =&gt;
                        k0 (a,&amp; b)))
                        (uncurry2&#39;
                        (d_get 
                        (ks +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks 
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> (<span class="nv">a</span> : ...) (<span class="nv">b</span> : ...) =&gt;
                        k0 (...)))) r0))
               <span class="kr">end</span>) (k_nxt U (projT2 r))
              (ks +‚ñ∂ u_rsp U e)%ctx
              (d_concat ks 
                 (u_rsp U e) c1
                 (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                    (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
                  =&gt; k (a,&amp; b)))
              (uncurry2&#39;
                 (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                    (d_concat ks 
                       (u_rsp U e) c1
                       (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))) r))
     <span class="kr">end</span>)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk51" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk51"><span class="highlight"><span class="nb">enough</span> (Hcut : _) <span class="bp">by</span> <span class="nb">apply</span> (IHeqitF CIH ks c0 c1 t b Hcut Hb H1).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ot2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree&#39; U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CHECK</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">is_true true</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) bot3) i
  (observe t1) ot2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHeqitF</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(<span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
   (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
   (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
 a ‚âà b -&gt;
 eutt_conf c0 c1 -&gt;
 r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)) -&gt;
<span class="kr">forall</span> (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
observe t1 = _observe a -&gt;
ot2 = _observe b -&gt;
(<span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
   (<span class="nv">r</span> : k_rsp U (ks .[ i])),
 d_get ks c0 i r ‚âà d_get ks c1 i r) -&gt;
eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r)
  (i, ks)
  (_observe
     <span class="kr">match</span> observe t1 <span class="kr">with</span>
     | RetF x =&gt; Ret x
     | TauF t =&gt;
         Tau
           ((<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks0 : list (kon U))
               (c : ogs_conf (itree U X) ks0)
               (x : itree U X i) :
                 itree (ogs U) 
                   (X ‚àò fst) 
                   (i, ks0) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t0 =&gt;
                   Tau (_ogs_emb i ks0 c t0)
               | VisF e k =&gt;
                   Vis e
                     (<span class="kr">fun</span>
                        <span class="nv">r</span> : 
                        {i0
                        : 
                        fin
                        (length (...)%ctx) &amp;
                        k_rsp U
                        ((...)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb
                        (k_nxt U (projT2 r))
                        (ks0 +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks0
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a0</span> : ...)
                        (<span class="nv">b0</span> : ...) =&gt;
                        k (...)))
                        (uncurry2&#39;
                        (d_get
                        (ks0 +‚ñ∂ ...)%ctx
                        (d_concat ks0 ... c
                        ...)) r))
               <span class="kr">end</span>) i ks c0 t)
     | VisF e k =&gt;
         Vis e
           (<span class="kr">fun</span>
              <span class="nv">r</span> : {i0
                  : fin
                      (length
                        (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                  k_rsp U
                    ((ks +‚ñ∂ u_rsp U e)%ctx
                     .[ i0])} =&gt;
            (<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks0 : list (kon U))
               (c : ogs_conf (itree U X) ks0)
               (x : itree U X i) :
                 itree (ogs U) 
                   (X ‚àò fst) 
                   (i, ks0) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t =&gt;
                   Tau (_ogs_emb i ks0 c t)
               | VisF e0 k0 =&gt;
                   Vis e0
                     (<span class="kr">fun</span>
                        <span class="nv">r0</span> : 
                        {i0
                        : 
                        fin 
                        (length ...%ctx) &amp;
                        k_rsp U
                        (...%ctx .[ i0])} =&gt;
                      _ogs_emb
                        (k_nxt U (projT2 r0))
                        (ks0 +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks0
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> ... ... =&gt;
                        k0 ...))
                        (uncurry2&#39;
                        (d_get 
                        (...)%ctx 
                        (...)) r0))
               <span class="kr">end</span>) (k_nxt U (projT2 r))
              (ks +‚ñ∂ u_rsp U e)%ctx
              (d_concat ks 
                 (u_rsp U e) c0
                 (<span class="kr">fun</span>
                    (<span class="nv">a0</span> : 
                     fin
                       (length (u_rsp U e)))
                    (<span class="nv">b0</span> : 
                     k_rsp U
                       ((u_rsp U e) .[ a0]))
                  =&gt; k (a0,&amp; b0)))
              (uncurry2&#39;
                 (d_get
                    (ks +‚ñ∂ u_rsp U e)%ctx
                    (d_concat ks 
                       (u_rsp U e) c0
                       (<span class="kr">fun</span>
                        (<span class="nv">a0</span> : 
                        fin 
                        (length ...))
                        (<span class="nv">b0</span> : 
                        k_rsp U 
                        (... .[ a0])) =&gt;
                        k (a0,&amp; b0)))) r))
     <span class="kr">end</span>)
  (_observe
     <span class="kr">match</span> ot2 <span class="kr">with</span>
     | RetF x =&gt; Ret x
     | TauF t =&gt;
         Tau
           ((<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks0 : list (kon U))
               (c : ogs_conf (itree U X) ks0)
               (x : itree U X i) :
                 itree (ogs U) 
                   (X ‚àò fst) 
                   (i, ks0) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t0 =&gt;
                   Tau (_ogs_emb i ks0 c t0)
               | VisF e k =&gt;
                   Vis e
                     (<span class="kr">fun</span>
                        <span class="nv">r</span> : 
                        {i0
                        : 
                        fin
                        (length (...)%ctx) &amp;
                        k_rsp U
                        ((...)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb
                        (k_nxt U (projT2 r))
                        (ks0 +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks0
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a0</span> : ...)
                        (<span class="nv">b0</span> : ...) =&gt;
                        k (...)))
                        (uncurry2&#39;
                        (d_get
                        (ks0 +‚ñ∂ ...)%ctx
                        (d_concat ks0 ... c
                        ...)) r))
               <span class="kr">end</span>) i ks c1 t)
     | VisF e k =&gt;
         Vis e
           (<span class="kr">fun</span>
              <span class="nv">r</span> : {i0
                  : fin
                      (length
                        (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                  k_rsp U
                    ((ks +‚ñ∂ u_rsp U e)%ctx
                     .[ i0])} =&gt;
            (<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks0 : list (kon U))
               (c : ogs_conf (itree U X) ks0)
               (x : itree U X i) :
                 itree (ogs U) 
                   (X ‚àò fst) 
                   (i, ks0) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t =&gt;
                   Tau (_ogs_emb i ks0 c t)
               | VisF e0 k0 =&gt;
                   Vis e0
                     (<span class="kr">fun</span>
                        <span class="nv">r0</span> : 
                        {i0
                        : 
                        fin 
                        (length ...%ctx) &amp;
                        k_rsp U
                        (...%ctx .[ i0])} =&gt;
                      _ogs_emb
                        (k_nxt U (projT2 r0))
                        (ks0 +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks0
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> ... ... =&gt;
                        k0 ...))
                        (uncurry2&#39;
                        (d_get 
                        (...)%ctx 
                        (...)) r0))
               <span class="kr">end</span>) (k_nxt U (projT2 r))
              (ks +‚ñ∂ u_rsp U e)%ctx
              (d_concat ks 
                 (u_rsp U e) c1
                 (<span class="kr">fun</span>
                    (<span class="nv">a0</span> : 
                     fin
                       (length (u_rsp U e)))
                    (<span class="nv">b0</span> : 
                     k_rsp U
                       ((u_rsp U e) .[ a0]))
                  =&gt; k (a0,&amp; b0)))
              (uncurry2&#39;
                 (d_get
                    (ks +‚ñ∂ u_rsp U e)%ctx
                    (d_concat ks 
                       (u_rsp U e) c1
                       (<span class="kr">fun</span>
                        (<span class="nv">a0</span> : 
                        fin 
                        (length ...))
                        (<span class="nv">b0</span> : 
                        k_rsp U 
                        (... .[ a0])) =&gt;
                        k (a0,&amp; b0)))) r))
     <span class="kr">end</span>)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b, t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF t1 = TauF t</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ot2 = _observe b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
  (<span class="nv">r</span> : k_rsp U (ks .[ i])),
d_get ks c0 i r ‚âà d_get ks c1 i r</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">observe t1 = _observe t</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">injection</span> Ha <span class="kr">as</span> -&gt;; <span class="nb">auto</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk52" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk52"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ot1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree&#39; U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CHECK</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">is_true true</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) bot3) i ot1
  (observe t2)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHeqitF</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(<span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
   (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
   (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
 a ‚âà b -&gt;
 eutt_conf c0 c1 -&gt;
 r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)) -&gt;
<span class="kr">forall</span> (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ot1 = _observe a -&gt;
observe t2 = _observe b -&gt;
(<span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
   (<span class="nv">r</span> : k_rsp U (ks .[ i])),
 d_get ks c0 i r ‚âà d_get ks c1 i r) -&gt;
eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r)
  (i, ks)
  (_observe
     <span class="kr">match</span> ot1 <span class="kr">with</span>
     | RetF x =&gt; Ret x
     | TauF t =&gt;
         Tau
           ((<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks0 : list (kon U))
               (c : ogs_conf (itree U X) ks0)
               (x : itree U X i) :
                 itree (ogs U) 
                   (X ‚àò fst) 
                   (i, ks0) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t0 =&gt;
                   Tau (_ogs_emb i ks0 c t0)
               | VisF e k =&gt;
                   Vis e
                     (<span class="kr">fun</span>
                        <span class="nv">r</span> : 
                        {i0
                        : 
                        fin
                        (length (...)%ctx) &amp;
                        k_rsp U
                        ((...)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb
                        (k_nxt U (projT2 r))
                        (ks0 +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks0
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a0</span> : ...)
                        (<span class="nv">b0</span> : ...) =&gt;
                        k (...)))
                        (uncurry2&#39;
                        (d_get
                        (ks0 +‚ñ∂ ...)%ctx
                        (d_concat ks0 ... c
                        ...)) r))
               <span class="kr">end</span>) i ks c0 t)
     | VisF e k =&gt;
         Vis e
           (<span class="kr">fun</span>
              <span class="nv">r</span> : {i0
                  : fin
                      (length
                        (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                  k_rsp U
                    ((ks +‚ñ∂ u_rsp U e)%ctx
                     .[ i0])} =&gt;
            (<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks0 : list (kon U))
               (c : ogs_conf (itree U X) ks0)
               (x : itree U X i) :
                 itree (ogs U) 
                   (X ‚àò fst) 
                   (i, ks0) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t =&gt;
                   Tau (_ogs_emb i ks0 c t)
               | VisF e0 k0 =&gt;
                   Vis e0
                     (<span class="kr">fun</span>
                        <span class="nv">r0</span> : 
                        {i0
                        : 
                        fin 
                        (length ...%ctx) &amp;
                        k_rsp U
                        (...%ctx .[ i0])} =&gt;
                      _ogs_emb
                        (k_nxt U (projT2 r0))
                        (ks0 +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks0
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> ... ... =&gt;
                        k0 ...))
                        (uncurry2&#39;
                        (d_get 
                        (...)%ctx 
                        (...)) r0))
               <span class="kr">end</span>) (k_nxt U (projT2 r))
              (ks +‚ñ∂ u_rsp U e)%ctx
              (d_concat ks 
                 (u_rsp U e) c0
                 (<span class="kr">fun</span>
                    (<span class="nv">a0</span> : 
                     fin
                       (length (u_rsp U e)))
                    (<span class="nv">b0</span> : 
                     k_rsp U
                       ((u_rsp U e) .[ a0]))
                  =&gt; k (a0,&amp; b0)))
              (uncurry2&#39;
                 (d_get
                    (ks +‚ñ∂ u_rsp U e)%ctx
                    (d_concat ks 
                       (u_rsp U e) c0
                       (<span class="kr">fun</span>
                        (<span class="nv">a0</span> : 
                        fin 
                        (length ...))
                        (<span class="nv">b0</span> : 
                        k_rsp U 
                        (... .[ a0])) =&gt;
                        k (a0,&amp; b0)))) r))
     <span class="kr">end</span>)
  (_observe
     <span class="kr">match</span> observe t2 <span class="kr">with</span>
     | RetF x =&gt; Ret x
     | TauF t =&gt;
         Tau
           ((<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks0 : list (kon U))
               (c : ogs_conf (itree U X) ks0)
               (x : itree U X i) :
                 itree (ogs U) 
                   (X ‚àò fst) 
                   (i, ks0) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t0 =&gt;
                   Tau (_ogs_emb i ks0 c t0)
               | VisF e k =&gt;
                   Vis e
                     (<span class="kr">fun</span>
                        <span class="nv">r</span> : 
                        {i0
                        : 
                        fin
                        (length (...)%ctx) &amp;
                        k_rsp U
                        ((...)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb
                        (k_nxt U (projT2 r))
                        (ks0 +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks0
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a0</span> : ...)
                        (<span class="nv">b0</span> : ...) =&gt;
                        k (...)))
                        (uncurry2&#39;
                        (d_get
                        (ks0 +‚ñ∂ ...)%ctx
                        (d_concat ks0 ... c
                        ...)) r))
               <span class="kr">end</span>) i ks c1 t)
     | VisF e k =&gt;
         Vis e
           (<span class="kr">fun</span>
              <span class="nv">r</span> : {i0
                  : fin
                      (length
                        (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                  k_rsp U
                    ((ks +‚ñ∂ u_rsp U e)%ctx
                     .[ i0])} =&gt;
            (<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks0 : list (kon U))
               (c : ogs_conf (itree U X) ks0)
               (x : itree U X i) :
                 itree (ogs U) 
                   (X ‚àò fst) 
                   (i, ks0) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t =&gt;
                   Tau (_ogs_emb i ks0 c t)
               | VisF e0 k0 =&gt;
                   Vis e0
                     (<span class="kr">fun</span>
                        <span class="nv">r0</span> : 
                        {i0
                        : 
                        fin 
                        (length ...%ctx) &amp;
                        k_rsp U
                        (...%ctx .[ i0])} =&gt;
                      _ogs_emb
                        (k_nxt U (projT2 r0))
                        (ks0 +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks0
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> ... ... =&gt;
                        k0 ...))
                        (uncurry2&#39;
                        (d_get 
                        (...)%ctx 
                        (...)) r0))
               <span class="kr">end</span>) (k_nxt U (projT2 r))
              (ks +‚ñ∂ u_rsp U e)%ctx
              (d_concat ks 
                 (u_rsp U e) c1
                 (<span class="kr">fun</span>
                    (<span class="nv">a0</span> : 
                     fin
                       (length (u_rsp U e)))
                    (<span class="nv">b0</span> : 
                     k_rsp U
                       ((u_rsp U e) .[ a0]))
                  =&gt; k (a0,&amp; b0)))
              (uncurry2&#39;
                 (d_get
                    (ks +‚ñ∂ u_rsp U e)%ctx
                    (d_concat ks 
                       (u_rsp U e) c1
                       (<span class="kr">fun</span>
                        (<span class="nv">a0</span> : 
                        fin 
                        (length ...))
                        (<span class="nv">b0</span> : 
                        k_rsp U 
                        (... .[ a0])) =&gt;
                        k (a0,&amp; b0)))) r))
     <span class="kr">end</span>)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ot1 = _observe a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF t2 = _observe b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
  (<span class="nv">r</span> : k_rsp U (ks .[ i])),
d_get ks c0 i r ‚âà d_get ks c1 i r</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) 
  (i, ks)
  (_observe
     <span class="kr">match</span> ot1 <span class="kr">with</span>
     | RetF x =&gt; Ret x
     | TauF t =&gt;
         Tau
           ((<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks : list (kon U))
               (c : ogs_conf (itree U X) ks)
               (x : itree U X i) :
                 itree (ogs U) (X ‚àò fst) (i, ks) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t0 =&gt; Tau (_ogs_emb i ks c t0)
               | VisF e k =&gt;
                   Vis e
                     (<span class="kr">fun</span>
                        <span class="nv">r</span> : 
                        {i0
                        : 
                        fin
                        (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                        k_rsp U
                        ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb 
                        (k_nxt U (projT2 r))
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))
                        (uncurry2&#39;
                        (d_get 
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin ...)
                        (<span class="nv">b</span> : k_rsp U ...) =&gt; 
                        k (a,&amp; b)))) r))
               <span class="kr">end</span>) i ks c0 t)
     | VisF e k =&gt;
         Vis e
           (<span class="kr">fun</span>
              <span class="nv">r</span> : {i0
                  : fin (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                  k_rsp U
                    ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])} =&gt;
            (<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks : list (kon U))
               (c : ogs_conf (itree U X) ks)
               (x : itree U X i) :
                 itree (ogs U) (X ‚àò fst) (i, ks) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t =&gt; Tau (_ogs_emb i ks c t)
               | VisF e0 k0 =&gt;
                   Vis e0
                     (<span class="kr">fun</span>
                        <span class="nv">r0</span> : 
                        {i0
                        : 
                        fin
                        (length (ks +‚ñ∂ u_rsp U e0)%ctx) &amp;
                        k_rsp U
                        ((ks +‚ñ∂ u_rsp U e0)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb 
                        (k_nxt U (projT2 r0))
                        (ks +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks 
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin (length (...)))
                        (<span class="nv">b</span> : k_rsp U ((...) .[ a])) =&gt;
                        k0 (a,&amp; b)))
                        (uncurry2&#39;
                        (d_get 
                        (ks +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks 
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> (<span class="nv">a</span> : ...) (<span class="nv">b</span> : ...) =&gt;
                        k0 (...)))) r0))
               <span class="kr">end</span>) (k_nxt U (projT2 r))
              (ks +‚ñ∂ u_rsp U e)%ctx
              (d_concat ks 
                 (u_rsp U e) c0
                 (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                    (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
                  =&gt; k (a,&amp; b)))
              (uncurry2&#39;
                 (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                    (d_concat ks 
                       (u_rsp U e) c0
                       (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))) r))
     <span class="kr">end</span>)
  (_observe
     (Tau
        ((<span class="kr">cofix</span> _ogs_emb
            (i : I) (ks : list (kon U))
            (c : ogs_conf (itree U X) ks)
            (x : itree U X i) :
              itree (ogs U) (X ‚àò fst) (i, ks) :=
            <span class="kr">match</span> _observe x <span class="kr">with</span>
            | RetF x0 =&gt; Ret x0
            | TauF t =&gt; Tau (_ogs_emb i ks c t)
            | VisF e k =&gt;
                Vis e
                  (<span class="kr">fun</span>
                     <span class="nv">r</span> : 
                      {i0
                      : fin
                        (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                      k_rsp U
                        ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
                   =&gt;
                   _ogs_emb 
                     (k_nxt U (projT2 r))
                     (ks +‚ñ∂ u_rsp U e)%ctx
                     (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))
                     (uncurry2&#39;
                        (d_get 
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin (...))
                        (<span class="nv">b</span> : k_rsp U (...)) =&gt;
                        k (a,&amp; b)))) r))
            <span class="kr">end</span>) i ks c1 t2)))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk53" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk53"><span class="highlight"><span class="nb">econstructor</span>; <span class="nb">auto</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ot1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree&#39; U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CHECK</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">is_true true</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) bot3) i ot1
  (observe t2)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHeqitF</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(<span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
   (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
   (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
 a ‚âà b -&gt;
 eutt_conf c0 c1 -&gt;
 r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)) -&gt;
<span class="kr">forall</span> (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ot1 = _observe a -&gt;
observe t2 = _observe b -&gt;
(<span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
   (<span class="nv">r</span> : k_rsp U (ks .[ i])),
 d_get ks c0 i r ‚âà d_get ks c1 i r) -&gt;
eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r)
  (i, ks)
  (_observe
     <span class="kr">match</span> ot1 <span class="kr">with</span>
     | RetF x =&gt; Ret x
     | TauF t =&gt;
         Tau
           ((<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks0 : list (kon U))
               (c : ogs_conf (itree U X) ks0)
               (x : itree U X i) :
                 itree (ogs U) 
                   (X ‚àò fst) 
                   (i, ks0) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t0 =&gt;
                   Tau (_ogs_emb i ks0 c t0)
               | VisF e k =&gt;
                   Vis e
                     (<span class="kr">fun</span>
                        <span class="nv">r</span> : 
                        {i0
                        : 
                        fin
                        (length (...)%ctx) &amp;
                        k_rsp U
                        ((...)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb
                        (k_nxt U (projT2 r))
                        (ks0 +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks0
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a0</span> : ...)
                        (<span class="nv">b0</span> : ...) =&gt;
                        k (...)))
                        (uncurry2&#39;
                        (d_get
                        (ks0 +‚ñ∂ ...)%ctx
                        (d_concat ks0 ... c
                        ...)) r))
               <span class="kr">end</span>) i ks c0 t)
     | VisF e k =&gt;
         Vis e
           (<span class="kr">fun</span>
              <span class="nv">r</span> : {i0
                  : fin
                      (length
                        (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                  k_rsp U
                    ((ks +‚ñ∂ u_rsp U e)%ctx
                     .[ i0])} =&gt;
            (<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks0 : list (kon U))
               (c : ogs_conf (itree U X) ks0)
               (x : itree U X i) :
                 itree (ogs U) 
                   (X ‚àò fst) 
                   (i, ks0) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t =&gt;
                   Tau (_ogs_emb i ks0 c t)
               | VisF e0 k0 =&gt;
                   Vis e0
                     (<span class="kr">fun</span>
                        <span class="nv">r0</span> : 
                        {i0
                        : 
                        fin 
                        (length ...%ctx) &amp;
                        k_rsp U
                        (...%ctx .[ i0])} =&gt;
                      _ogs_emb
                        (k_nxt U (projT2 r0))
                        (ks0 +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks0
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> ... ... =&gt;
                        k0 ...))
                        (uncurry2&#39;
                        (d_get 
                        (...)%ctx 
                        (...)) r0))
               <span class="kr">end</span>) (k_nxt U (projT2 r))
              (ks +‚ñ∂ u_rsp U e)%ctx
              (d_concat ks 
                 (u_rsp U e) c0
                 (<span class="kr">fun</span>
                    (<span class="nv">a0</span> : 
                     fin
                       (length (u_rsp U e)))
                    (<span class="nv">b0</span> : 
                     k_rsp U
                       ((u_rsp U e) .[ a0]))
                  =&gt; k (a0,&amp; b0)))
              (uncurry2&#39;
                 (d_get
                    (ks +‚ñ∂ u_rsp U e)%ctx
                    (d_concat ks 
                       (u_rsp U e) c0
                       (<span class="kr">fun</span>
                        (<span class="nv">a0</span> : 
                        fin 
                        (length ...))
                        (<span class="nv">b0</span> : 
                        k_rsp U 
                        (... .[ a0])) =&gt;
                        k (a0,&amp; b0)))) r))
     <span class="kr">end</span>)
  (_observe
     <span class="kr">match</span> observe t2 <span class="kr">with</span>
     | RetF x =&gt; Ret x
     | TauF t =&gt;
         Tau
           ((<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks0 : list (kon U))
               (c : ogs_conf (itree U X) ks0)
               (x : itree U X i) :
                 itree (ogs U) 
                   (X ‚àò fst) 
                   (i, ks0) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t0 =&gt;
                   Tau (_ogs_emb i ks0 c t0)
               | VisF e k =&gt;
                   Vis e
                     (<span class="kr">fun</span>
                        <span class="nv">r</span> : 
                        {i0
                        : 
                        fin
                        (length (...)%ctx) &amp;
                        k_rsp U
                        ((...)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb
                        (k_nxt U (projT2 r))
                        (ks0 +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks0
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a0</span> : ...)
                        (<span class="nv">b0</span> : ...) =&gt;
                        k (...)))
                        (uncurry2&#39;
                        (d_get
                        (ks0 +‚ñ∂ ...)%ctx
                        (d_concat ks0 ... c
                        ...)) r))
               <span class="kr">end</span>) i ks c1 t)
     | VisF e k =&gt;
         Vis e
           (<span class="kr">fun</span>
              <span class="nv">r</span> : {i0
                  : fin
                      (length
                        (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                  k_rsp U
                    ((ks +‚ñ∂ u_rsp U e)%ctx
                     .[ i0])} =&gt;
            (<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks0 : list (kon U))
               (c : ogs_conf (itree U X) ks0)
               (x : itree U X i) :
                 itree (ogs U) 
                   (X ‚àò fst) 
                   (i, ks0) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t =&gt;
                   Tau (_ogs_emb i ks0 c t)
               | VisF e0 k0 =&gt;
                   Vis e0
                     (<span class="kr">fun</span>
                        <span class="nv">r0</span> : 
                        {i0
                        : 
                        fin 
                        (length ...%ctx) &amp;
                        k_rsp U
                        (...%ctx .[ i0])} =&gt;
                      _ogs_emb
                        (k_nxt U (projT2 r0))
                        (ks0 +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks0
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> ... ... =&gt;
                        k0 ...))
                        (uncurry2&#39;
                        (d_get 
                        (...)%ctx 
                        (...)) r0))
               <span class="kr">end</span>) (k_nxt U (projT2 r))
              (ks +‚ñ∂ u_rsp U e)%ctx
              (d_concat ks 
                 (u_rsp U e) c1
                 (<span class="kr">fun</span>
                    (<span class="nv">a0</span> : 
                     fin
                       (length (u_rsp U e)))
                    (<span class="nv">b0</span> : 
                     k_rsp U
                       ((u_rsp U e) .[ a0]))
                  =&gt; k (a0,&amp; b0)))
              (uncurry2&#39;
                 (d_get
                    (ks +‚ñ∂ u_rsp U e)%ctx
                    (d_concat ks 
                       (u_rsp U e) c1
                       (<span class="kr">fun</span>
                        (<span class="nv">a0</span> : 
                        fin 
                        (length ...))
                        (<span class="nv">b0</span> : 
                        k_rsp U 
                        (... .[ a0])) =&gt;
                        k (a0,&amp; b0)))) r))
     <span class="kr">end</span>)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ot1 = _observe a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF t2 = _observe b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
  (<span class="nv">r</span> : k_rsp U (ks .[ i])),
d_get ks c0 i r ‚âà d_get ks c1 i r</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) 
  (i, ks)
  (_observe
     <span class="kr">match</span> ot1 <span class="kr">with</span>
     | RetF x =&gt; Ret x
     | TauF t =&gt;
         Tau
           ((<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks : list (kon U))
               (c : ogs_conf (itree U X) ks)
               (x : itree U X i) :
                 itree (ogs U) (X ‚àò fst) (i, ks) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t0 =&gt; Tau (_ogs_emb i ks c t0)
               | VisF e k =&gt;
                   Vis e
                     (<span class="kr">fun</span>
                        <span class="nv">r</span> : 
                        {i0
                        : 
                        fin
                        (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                        k_rsp U
                        ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb 
                        (k_nxt U (projT2 r))
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))
                        (uncurry2&#39;
                        (d_get 
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin ...)
                        (<span class="nv">b</span> : k_rsp U ...) =&gt; 
                        k (a,&amp; b)))) r))
               <span class="kr">end</span>) i ks c0 t)
     | VisF e k =&gt;
         Vis e
           (<span class="kr">fun</span>
              <span class="nv">r</span> : {i0
                  : fin (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                  k_rsp U
                    ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])} =&gt;
            (<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks : list (kon U))
               (c : ogs_conf (itree U X) ks)
               (x : itree U X i) :
                 itree (ogs U) (X ‚àò fst) (i, ks) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t =&gt; Tau (_ogs_emb i ks c t)
               | VisF e0 k0 =&gt;
                   Vis e0
                     (<span class="kr">fun</span>
                        <span class="nv">r0</span> : 
                        {i0
                        : 
                        fin
                        (length (ks +‚ñ∂ u_rsp U e0)%ctx) &amp;
                        k_rsp U
                        ((ks +‚ñ∂ u_rsp U e0)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb 
                        (k_nxt U (projT2 r0))
                        (ks +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks 
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin (length (...)))
                        (<span class="nv">b</span> : k_rsp U ((...) .[ a])) =&gt;
                        k0 (a,&amp; b)))
                        (uncurry2&#39;
                        (d_get 
                        (ks +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks 
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> (<span class="nv">a</span> : ...) (<span class="nv">b</span> : ...) =&gt;
                        k0 (...)))) r0))
               <span class="kr">end</span>) (k_nxt U (projT2 r))
              (ks +‚ñ∂ u_rsp U e)%ctx
              (d_concat ks 
                 (u_rsp U e) c0
                 (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                    (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
                  =&gt; k (a,&amp; b)))
              (uncurry2&#39;
                 (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                    (d_concat ks 
                       (u_rsp U e) c0
                       (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))) r))
     <span class="kr">end</span>)
  (observe
     ((<span class="kr">cofix</span> _ogs_emb
         (i : I) (ks : list (kon U))
         (c : ogs_conf (itree U X) ks)
         (x : itree U X i) :
           itree (ogs U) (X ‚àò fst) (i, ks) :=
         <span class="kr">match</span> _observe x <span class="kr">with</span>
         | RetF x0 =&gt; Ret x0
         | TauF t =&gt; Tau (_ogs_emb i ks c t)
         | VisF e k =&gt;
             Vis e
               (<span class="kr">fun</span>
                  <span class="nv">r</span> : {i0
                      : fin
                        (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                      k_rsp U
                        ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
                =&gt;
                _ogs_emb 
                  (k_nxt U (projT2 r))
                  (ks +‚ñ∂ u_rsp U e)%ctx
                  (d_concat ks 
                     (u_rsp U e) c
                     (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                      k (a,&amp; b)))
                  (uncurry2&#39;
                     (d_get 
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin (length (...)))
                        (<span class="nv">b</span> : k_rsp U ((...) .[ a])) =&gt;
                        k (a,&amp; b)))) r))
         <span class="kr">end</span>) i ks c1 t2))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk54" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk54"><span class="highlight"><span class="nb">destruct</span> (_observe b); <span class="kp">try</span> <span class="bp">discriminate</span> Hb.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ot1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree&#39; U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CHECK</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">is_true true</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) bot3) i ot1
  (observe t2)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHeqitF</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(<span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
   (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
   (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
 a ‚âà b -&gt;
 eutt_conf c0 c1 -&gt;
 r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)) -&gt;
<span class="kr">forall</span> (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ot1 = _observe a -&gt;
observe t2 = _observe b -&gt;
(<span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
   (<span class="nv">r</span> : k_rsp U (ks .[ i])),
 d_get ks c0 i r ‚âà d_get ks c1 i r) -&gt;
eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r)
  (i, ks)
  (_observe
     <span class="kr">match</span> ot1 <span class="kr">with</span>
     | RetF x =&gt; Ret x
     | TauF t =&gt;
         Tau
           ((<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks0 : list (kon U))
               (c : ogs_conf (itree U X) ks0)
               (x : itree U X i) :
                 itree (ogs U) 
                   (X ‚àò fst) 
                   (i, ks0) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t0 =&gt;
                   Tau (_ogs_emb i ks0 c t0)
               | VisF e k =&gt;
                   Vis e
                     (<span class="kr">fun</span>
                        <span class="nv">r</span> : 
                        {i0
                        : 
                        fin
                        (length (...)%ctx) &amp;
                        k_rsp U
                        ((...)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb
                        (k_nxt U (projT2 r))
                        (ks0 +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks0
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a0</span> : ...)
                        (<span class="nv">b0</span> : ...) =&gt;
                        k (...)))
                        (uncurry2&#39;
                        (d_get
                        (ks0 +‚ñ∂ ...)%ctx
                        (d_concat ks0 ... c
                        ...)) r))
               <span class="kr">end</span>) i ks c0 t)
     | VisF e k =&gt;
         Vis e
           (<span class="kr">fun</span>
              <span class="nv">r</span> : {i0
                  : fin
                      (length
                        (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                  k_rsp U
                    ((ks +‚ñ∂ u_rsp U e)%ctx
                     .[ i0])} =&gt;
            (<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks0 : list (kon U))
               (c : ogs_conf (itree U X) ks0)
               (x : itree U X i) :
                 itree (ogs U) 
                   (X ‚àò fst) 
                   (i, ks0) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t =&gt;
                   Tau (_ogs_emb i ks0 c t)
               | VisF e0 k0 =&gt;
                   Vis e0
                     (<span class="kr">fun</span>
                        <span class="nv">r0</span> : 
                        {i0
                        : 
                        fin 
                        (length ...%ctx) &amp;
                        k_rsp U
                        (...%ctx .[ i0])} =&gt;
                      _ogs_emb
                        (k_nxt U (projT2 r0))
                        (ks0 +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks0
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> ... ... =&gt;
                        k0 ...))
                        (uncurry2&#39;
                        (d_get 
                        (...)%ctx 
                        (...)) r0))
               <span class="kr">end</span>) (k_nxt U (projT2 r))
              (ks +‚ñ∂ u_rsp U e)%ctx
              (d_concat ks 
                 (u_rsp U e) c0
                 (<span class="kr">fun</span>
                    (<span class="nv">a0</span> : 
                     fin
                       (length (u_rsp U e)))
                    (<span class="nv">b0</span> : 
                     k_rsp U
                       ((u_rsp U e) .[ a0]))
                  =&gt; k (a0,&amp; b0)))
              (uncurry2&#39;
                 (d_get
                    (ks +‚ñ∂ u_rsp U e)%ctx
                    (d_concat ks 
                       (u_rsp U e) c0
                       (<span class="kr">fun</span>
                        (<span class="nv">a0</span> : 
                        fin 
                        (length ...))
                        (<span class="nv">b0</span> : 
                        k_rsp U 
                        (... .[ a0])) =&gt;
                        k (a0,&amp; b0)))) r))
     <span class="kr">end</span>)
  (_observe
     <span class="kr">match</span> observe t2 <span class="kr">with</span>
     | RetF x =&gt; Ret x
     | TauF t =&gt;
         Tau
           ((<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks0 : list (kon U))
               (c : ogs_conf (itree U X) ks0)
               (x : itree U X i) :
                 itree (ogs U) 
                   (X ‚àò fst) 
                   (i, ks0) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t0 =&gt;
                   Tau (_ogs_emb i ks0 c t0)
               | VisF e k =&gt;
                   Vis e
                     (<span class="kr">fun</span>
                        <span class="nv">r</span> : 
                        {i0
                        : 
                        fin
                        (length (...)%ctx) &amp;
                        k_rsp U
                        ((...)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb
                        (k_nxt U (projT2 r))
                        (ks0 +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks0
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a0</span> : ...)
                        (<span class="nv">b0</span> : ...) =&gt;
                        k (...)))
                        (uncurry2&#39;
                        (d_get
                        (ks0 +‚ñ∂ ...)%ctx
                        (d_concat ks0 ... c
                        ...)) r))
               <span class="kr">end</span>) i ks c1 t)
     | VisF e k =&gt;
         Vis e
           (<span class="kr">fun</span>
              <span class="nv">r</span> : {i0
                  : fin
                      (length
                        (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                  k_rsp U
                    ((ks +‚ñ∂ u_rsp U e)%ctx
                     .[ i0])} =&gt;
            (<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks0 : list (kon U))
               (c : ogs_conf (itree U X) ks0)
               (x : itree U X i) :
                 itree (ogs U) 
                   (X ‚àò fst) 
                   (i, ks0) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t =&gt;
                   Tau (_ogs_emb i ks0 c t)
               | VisF e0 k0 =&gt;
                   Vis e0
                     (<span class="kr">fun</span>
                        <span class="nv">r0</span> : 
                        {i0
                        : 
                        fin 
                        (length ...%ctx) &amp;
                        k_rsp U
                        (...%ctx .[ i0])} =&gt;
                      _ogs_emb
                        (k_nxt U (projT2 r0))
                        (ks0 +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks0
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> ... ... =&gt;
                        k0 ...))
                        (uncurry2&#39;
                        (d_get 
                        (...)%ctx 
                        (...)) r0))
               <span class="kr">end</span>) (k_nxt U (projT2 r))
              (ks +‚ñ∂ u_rsp U e)%ctx
              (d_concat ks 
                 (u_rsp U e) c1
                 (<span class="kr">fun</span>
                    (<span class="nv">a0</span> : 
                     fin
                       (length (u_rsp U e)))
                    (<span class="nv">b0</span> : 
                     k_rsp U
                       ((u_rsp U e) .[ a0]))
                  =&gt; k (a0,&amp; b0)))
              (uncurry2&#39;
                 (d_get
                    (ks +‚ñ∂ u_rsp U e)%ctx
                    (d_concat ks 
                       (u_rsp U e) c1
                       (<span class="kr">fun</span>
                        (<span class="nv">a0</span> : 
                        fin 
                        (length ...))
                        (<span class="nv">b0</span> : 
                        k_rsp U 
                        (... .[ a0])) =&gt;
                        k (a0,&amp; b0)))) r))
     <span class="kr">end</span>)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ot1 = _observe a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF t2 = TauF t</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
  (<span class="nv">r</span> : k_rsp U (ks .[ i])),
d_get ks c0 i r ‚âà d_get ks c1 i r</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r) 
  (i, ks)
  (_observe
     <span class="kr">match</span> ot1 <span class="kr">with</span>
     | RetF x =&gt; Ret x
     | TauF t =&gt;
         Tau
           ((<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks : list (kon U))
               (c : ogs_conf (itree U X) ks)
               (x : itree U X i) :
                 itree (ogs U) (X ‚àò fst) (i, ks) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t0 =&gt; Tau (_ogs_emb i ks c t0)
               | VisF e k =&gt;
                   Vis e
                     (<span class="kr">fun</span>
                        <span class="nv">r</span> : 
                        {i0
                        : 
                        fin
                        (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                        k_rsp U
                        ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb 
                        (k_nxt U (projT2 r))
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))
                        (uncurry2&#39;
                        (d_get 
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin ...)
                        (<span class="nv">b</span> : k_rsp U ...) =&gt; 
                        k (a,&amp; b)))) r))
               <span class="kr">end</span>) i ks c0 t)
     | VisF e k =&gt;
         Vis e
           (<span class="kr">fun</span>
              <span class="nv">r</span> : {i0
                  : fin (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                  k_rsp U
                    ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])} =&gt;
            (<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks : list (kon U))
               (c : ogs_conf (itree U X) ks)
               (x : itree U X i) :
                 itree (ogs U) (X ‚àò fst) (i, ks) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t =&gt; Tau (_ogs_emb i ks c t)
               | VisF e0 k0 =&gt;
                   Vis e0
                     (<span class="kr">fun</span>
                        <span class="nv">r0</span> : 
                        {i0
                        : 
                        fin
                        (length (ks +‚ñ∂ u_rsp U e0)%ctx) &amp;
                        k_rsp U
                        ((ks +‚ñ∂ u_rsp U e0)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb 
                        (k_nxt U (projT2 r0))
                        (ks +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks 
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin (length (...)))
                        (<span class="nv">b</span> : k_rsp U ((...) .[ a])) =&gt;
                        k0 (a,&amp; b)))
                        (uncurry2&#39;
                        (d_get 
                        (ks +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks 
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> (<span class="nv">a</span> : ...) (<span class="nv">b</span> : ...) =&gt;
                        k0 (...)))) r0))
               <span class="kr">end</span>) (k_nxt U (projT2 r))
              (ks +‚ñ∂ u_rsp U e)%ctx
              (d_concat ks 
                 (u_rsp U e) c0
                 (<span class="kr">fun</span> (<span class="nv">a</span> : fin (length (u_rsp U e)))
                    (<span class="nv">b</span> : k_rsp U ((u_rsp U e) .[ a]))
                  =&gt; k (a,&amp; b)))
              (uncurry2&#39;
                 (d_get (ks +‚ñ∂ u_rsp U e)%ctx
                    (d_concat ks 
                       (u_rsp U e) c0
                       (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                        k (a,&amp; b)))) r))
     <span class="kr">end</span>)
  (observe
     ((<span class="kr">cofix</span> _ogs_emb
         (i : I) (ks : list (kon U))
         (c : ogs_conf (itree U X) ks)
         (x : itree U X i) :
           itree (ogs U) (X ‚àò fst) (i, ks) :=
         <span class="kr">match</span> _observe x <span class="kr">with</span>
         | RetF x0 =&gt; Ret x0
         | TauF t =&gt; Tau (_ogs_emb i ks c t)
         | VisF e k =&gt;
             Vis e
               (<span class="kr">fun</span>
                  <span class="nv">r</span> : {i0
                      : fin
                        (length (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                      k_rsp U
                        ((ks +‚ñ∂ u_rsp U e)%ctx .[ i0])}
                =&gt;
                _ogs_emb 
                  (k_nxt U (projT2 r))
                  (ks +‚ñ∂ u_rsp U e)%ctx
                  (d_concat ks 
                     (u_rsp U e) c
                     (<span class="kr">fun</span>
                        (<span class="nv">a</span> : fin (length (u_rsp U e)))
                        (<span class="nv">b</span> : 
                        k_rsp U 
                        ((u_rsp U e) .[ a])) =&gt;
                      k (a,&amp; b)))
                  (uncurry2&#39;
                     (d_get 
                        (ks +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks 
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a</span> : fin (length (...)))
                        (<span class="nv">b</span> : k_rsp U ((...) .[ a])) =&gt;
                        k (a,&amp; b)))) r))
         <span class="kr">end</span>) i ks c1 t2))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ogsd-v-chk55" style="display: none" type="checkbox"><label class="alectryon-input" for="ogsd-v-chk55"><span class="highlight"><span class="nb">enough</span> (Hcut : _) <span class="bp">by</span> <span class="nb">apply</span> (IHeqitF CIH ks c0 c1 a t Ha Hcut H1).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">I</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">U</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">uniform_event I I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : I * list (kon U),
itree (ogs U) (X ‚àò fst) x -&gt;
itree (ogs U) (X ‚àò fst) x -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">I</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ot1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree&#39; U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CHECK</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">is_true true</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) bot3) i ot1
  (observe t2)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHeqitF</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(<span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
   (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
   (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
 a ‚âà b -&gt;
 eutt_conf c0 c1 -&gt;
 r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)) -&gt;
<span class="kr">forall</span> (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
ot1 = _observe a -&gt;
observe t2 = _observe b -&gt;
(<span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
   (<span class="nv">r</span> : k_rsp U (ks .[ i])),
 d_get ks c0 i r ‚âà d_get ks c1 i r) -&gt;
eqitF eq·µ¢ true true id
  (upaco3 (eqit_ eq·µ¢ true true id) r)
  (i, ks)
  (_observe
     <span class="kr">match</span> ot1 <span class="kr">with</span>
     | RetF x =&gt; Ret x
     | TauF t =&gt;
         Tau
           ((<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks0 : list (kon U))
               (c : ogs_conf (itree U X) ks0)
               (x : itree U X i) :
                 itree (ogs U) 
                   (X ‚àò fst) 
                   (i, ks0) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t0 =&gt;
                   Tau (_ogs_emb i ks0 c t0)
               | VisF e k =&gt;
                   Vis e
                     (<span class="kr">fun</span>
                        <span class="nv">r</span> : 
                        {i0
                        : 
                        fin
                        (length (...)%ctx) &amp;
                        k_rsp U
                        ((...)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb
                        (k_nxt U (projT2 r))
                        (ks0 +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks0
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a0</span> : ...)
                        (<span class="nv">b0</span> : ...) =&gt;
                        k (...)))
                        (uncurry2&#39;
                        (d_get
                        (ks0 +‚ñ∂ ...)%ctx
                        (d_concat ks0 ... c
                        ...)) r))
               <span class="kr">end</span>) i ks c0 t)
     | VisF e k =&gt;
         Vis e
           (<span class="kr">fun</span>
              <span class="nv">r</span> : {i0
                  : fin
                      (length
                        (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                  k_rsp U
                    ((ks +‚ñ∂ u_rsp U e)%ctx
                     .[ i0])} =&gt;
            (<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks0 : list (kon U))
               (c : ogs_conf (itree U X) ks0)
               (x : itree U X i) :
                 itree (ogs U) 
                   (X ‚àò fst) 
                   (i, ks0) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t =&gt;
                   Tau (_ogs_emb i ks0 c t)
               | VisF e0 k0 =&gt;
                   Vis e0
                     (<span class="kr">fun</span>
                        <span class="nv">r0</span> : 
                        {i0
                        : 
                        fin 
                        (length ...%ctx) &amp;
                        k_rsp U
                        (...%ctx .[ i0])} =&gt;
                      _ogs_emb
                        (k_nxt U (projT2 r0))
                        (ks0 +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks0
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> ... ... =&gt;
                        k0 ...))
                        (uncurry2&#39;
                        (d_get 
                        (...)%ctx 
                        (...)) r0))
               <span class="kr">end</span>) (k_nxt U (projT2 r))
              (ks +‚ñ∂ u_rsp U e)%ctx
              (d_concat ks 
                 (u_rsp U e) c0
                 (<span class="kr">fun</span>
                    (<span class="nv">a0</span> : 
                     fin
                       (length (u_rsp U e)))
                    (<span class="nv">b0</span> : 
                     k_rsp U
                       ((u_rsp U e) .[ a0]))
                  =&gt; k (a0,&amp; b0)))
              (uncurry2&#39;
                 (d_get
                    (ks +‚ñ∂ u_rsp U e)%ctx
                    (d_concat ks 
                       (u_rsp U e) c0
                       (<span class="kr">fun</span>
                        (<span class="nv">a0</span> : 
                        fin 
                        (length ...))
                        (<span class="nv">b0</span> : 
                        k_rsp U 
                        (... .[ a0])) =&gt;
                        k (a0,&amp; b0)))) r))
     <span class="kr">end</span>)
  (_observe
     <span class="kr">match</span> observe t2 <span class="kr">with</span>
     | RetF x =&gt; Ret x
     | TauF t =&gt;
         Tau
           ((<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks0 : list (kon U))
               (c : ogs_conf (itree U X) ks0)
               (x : itree U X i) :
                 itree (ogs U) 
                   (X ‚àò fst) 
                   (i, ks0) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t0 =&gt;
                   Tau (_ogs_emb i ks0 c t0)
               | VisF e k =&gt;
                   Vis e
                     (<span class="kr">fun</span>
                        <span class="nv">r</span> : 
                        {i0
                        : 
                        fin
                        (length (...)%ctx) &amp;
                        k_rsp U
                        ((...)%ctx .[ i0])}
                      =&gt;
                      _ogs_emb
                        (k_nxt U (projT2 r))
                        (ks0 +‚ñ∂ u_rsp U e)%ctx
                        (d_concat ks0
                        (u_rsp U e) c
                        (<span class="kr">fun</span> 
                        (<span class="nv">a0</span> : ...)
                        (<span class="nv">b0</span> : ...) =&gt;
                        k (...)))
                        (uncurry2&#39;
                        (d_get
                        (ks0 +‚ñ∂ ...)%ctx
                        (d_concat ks0 ... c
                        ...)) r))
               <span class="kr">end</span>) i ks c1 t)
     | VisF e k =&gt;
         Vis e
           (<span class="kr">fun</span>
              <span class="nv">r</span> : {i0
                  : fin
                      (length
                        (ks +‚ñ∂ u_rsp U e)%ctx) &amp;
                  k_rsp U
                    ((ks +‚ñ∂ u_rsp U e)%ctx
                     .[ i0])} =&gt;
            (<span class="kr">cofix</span> _ogs_emb
               (i : I) (ks0 : list (kon U))
               (c : ogs_conf (itree U X) ks0)
               (x : itree U X i) :
                 itree (ogs U) 
                   (X ‚àò fst) 
                   (i, ks0) :=
               <span class="kr">match</span> _observe x <span class="kr">with</span>
               | RetF x0 =&gt; Ret x0
               | TauF t =&gt;
                   Tau (_ogs_emb i ks0 c t)
               | VisF e0 k0 =&gt;
                   Vis e0
                     (<span class="kr">fun</span>
                        <span class="nv">r0</span> : 
                        {i0
                        : 
                        fin 
                        (length ...%ctx) &amp;
                        k_rsp U
                        (...%ctx .[ i0])} =&gt;
                      _ogs_emb
                        (k_nxt U (projT2 r0))
                        (ks0 +‚ñ∂ u_rsp U e0)%ctx
                        (d_concat ks0
                        (u_rsp U e0) c
                        (<span class="kr">fun</span> ... ... =&gt;
                        k0 ...))
                        (uncurry2&#39;
                        (d_get 
                        (...)%ctx 
                        (...)) r0))
               <span class="kr">end</span>) (k_nxt U (projT2 r))
              (ks +‚ñ∂ u_rsp U e)%ctx
              (d_concat ks 
                 (u_rsp U e) c1
                 (<span class="kr">fun</span>
                    (<span class="nv">a0</span> : 
                     fin
                       (length (u_rsp U e)))
                    (<span class="nv">b0</span> : 
                     k_rsp U
                       ((u_rsp U e) .[ a0]))
                  =&gt; k (a0,&amp; b0)))
              (uncurry2&#39;
                 (d_get
                    (ks +‚ñ∂ u_rsp U e)%ctx
                    (d_concat ks 
                       (u_rsp U e) c1
                       (<span class="kr">fun</span>
                        (<span class="nv">a0</span> : 
                        fin 
                        (length ...))
                        (<span class="nv">b0</span> : 
                        k_rsp U 
                        (... .[ a0])) =&gt;
                        k (a0,&amp; b0)))) r))
     <span class="kr">end</span>)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">CIH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">ks</span> : list (kon U))
  (<span class="nv">c0</span> <span class="nv">c1</span> : ogs_conf (itree U X) ks)
  (<span class="nv">a</span> <span class="nv">b</span> : itree U X i),
a ‚âà b -&gt;
eutt_conf c0 c1 -&gt;
r (i, ks) (ogs_emb c0 a) (ogs_emb c1 b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (kon U)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c0, c1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ogs_conf (itree U X) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ot1 = _observe a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">itree U X i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">TauF t2 = TauF t</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">i</span> : fin (length ks))
  (<span class="nv">r</span> : k_rsp U (ks .[ i])),
d_get ks c0 i r ‚âà d_get ks c1 i r</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">observe t2 = _observe t</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">injection</span> Hb <span class="kr">as</span> -&gt;; <span class="nb">auto</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre>
</div>
</div></body>
</html>
